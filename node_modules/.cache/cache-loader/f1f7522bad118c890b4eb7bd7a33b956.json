{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\helpers\\metamask.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\helpers\\metamask.ts","mtime":1614852761277},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgppbXBvcnQgX3JlZ2VuZXJhdG9yUnVudGltZSBmcm9tICJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvciI7Ci8vIEB0cy1ub2NoZWNrCmltcG9ydCByZWR1Y2VycyBmcm9tICdyZWR1eC9jb3JlL3JlZHVjZXJzJzsKaW1wb3J0IHsgZ2V0U3RhdGUgfSBmcm9tICdyZWR1eC9jb3JlJzsKaW1wb3J0IGFjdGlvbnMgZnJvbSAncmVkdXgvYWN0aW9ucyc7CmltcG9ydCB7IGNhY2hlU3RvcmFnZUdldCwgY2FjaGVTdG9yYWdlU2V0LCBjb25zdGFudHMgfSBmcm9tICdoZWxwZXJzJzsKaW1wb3J0IGNvbmZpZyBmcm9tICdhcHAtY29uZmlnJzsKaW1wb3J0IHsgc2V0TWV0YW1hc2ssIHNldFByb3ZpZGVyLCBzZXREZWZhdWx0UHJvdmlkZXIsIGdldFdlYjMgYXMgZ2V0RGVmYXVsdFdlYjMgfSBmcm9tICdoZWxwZXJzL3dlYjMnOwppbXBvcnQgU3dhcEFwcCBmcm9tICdzd2FwLmFwcCc7CmltcG9ydCBXZWIzQ29ubmVjdCBmcm9tICcuLi8uLi8uLi9jb21tb24vd2ViM2Nvbm5lY3QnOwp2YXIgd2ViM2Nvbm5lY3QgPSBuZXcgV2ViM0Nvbm5lY3QoewogIHdlYjNDaGFpbklkOiBjb25maWcuYmluYW5jZSA/IHByb2Nlc3MuZW52Lk1BSU5ORVQgPyA1NiA6IDk3IC8vIDU2ID0gTWFpbm5ldCwgOTcgPSBUZXN0bmV0CiAgOiBwcm9jZXNzLmVudi5NQUlOTkVUID8gMSA6IDMsCiAgLy8gMSA9IE1haW5uZXQsIDMgPSBSb3BzdGVuCiAgd2ViM1JQQzogY29uZmlnLmJpbmFuY2UgPyBjb25maWcuYmluYW5jZV9wcm92aWRlciA6IGNvbmZpZy53ZWIzLnByb3ZpZGVyCn0pOwoKdmFyIF9vbldlYjNDaGFuZ2VkID0gZnVuY3Rpb24gX29uV2ViM0NoYW5nZWQobmV3V2ViMykgewogIHNldFByb3ZpZGVyKG5ld1dlYjMpOwogIFN3YXBBcHAuc2hhcmVkKCkuc2V0V2ViM1Byb3ZpZGVyKG5ld1dlYjMpOwoKICBfaW5pdFJlZHV4U3RhdGUoKTsKCiAgYWN0aW9ucy51c2VyLnNpZ25fdG9fdG9rZW5zKCk7CiAgYWN0aW9ucy51c2VyLmdldEJhbGFuY2VzKCk7Cn07Cgp3ZWIzY29ubmVjdC5vbignY29ubmVjdGVkJywgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgd2hpbGUgKDEpIHsKICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIC8vQAogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY29uc3RhbnRzLmxvY2FsU3RvcmFnZS5pc1dhbGxldENyZWF0ZSwgdHJ1ZSk7CiAgICAgICAgICBhY3Rpb25zLmNvcmUubWFya0NvaW5Bc1Zpc2libGUoIkVUSCIpOwoKICAgICAgICAgIF9vbldlYjNDaGFuZ2VkKHdlYjNjb25uZWN0LmdldFdlYjMoKSk7CgogICAgICAgIGNhc2UgMzoKICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgfQogICAgfQogIH0sIF9jYWxsZWUpOwp9KSkpOwp3ZWIzY29ubmVjdC5vbignZGlzY29ubmVjdCcsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgIHdoaWxlICgxKSB7CiAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHNldERlZmF1bHRQcm92aWRlcigpOwoKICAgICAgICAgIF9vbldlYjNDaGFuZ2VkKGdldERlZmF1bHRXZWIzKCkpOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICB9CiAgICB9CiAgfSwgX2NhbGxlZTIpOwp9KSkpOwp3ZWIzY29ubmVjdC5vbignYWNjb3VudENoYW5nZScsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgIHdoaWxlICgxKSB7CiAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIF9vbldlYjNDaGFuZ2VkKHdlYjNjb25uZWN0LmdldFdlYjMoKSk7CgogICAgICAgIGNhc2UgMToKICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgIH0KICAgIH0KICB9LCBfY2FsbGVlMyk7Cn0pKSk7CndlYjNjb25uZWN0Lm9uKCdjaGFpbkNoYW5nZWQnLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICB3aGlsZSAoMSkgewogICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBfb25XZWIzQ2hhbmdlZCh3ZWIzY29ubmVjdC5nZXRXZWIzKCkpOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICB9CiAgICB9CiAgfSwgX2NhbGxlZTQpOwp9KSkpOwoKdmFyIGlzRW5hYmxlZCA9IGZ1bmN0aW9uIGlzRW5hYmxlZCgpIHsKICByZXR1cm4gdHJ1ZTsKfTsKCnZhciBpc0Nvbm5lY3RlZCA9IGZ1bmN0aW9uIGlzQ29ubmVjdGVkKCkgewogIHJldHVybiB3ZWIzY29ubmVjdC5pc0Nvbm5lY3RlZCgpOwp9OwoKdmFyIGdldEFkZHJlc3MgPSBmdW5jdGlvbiBnZXRBZGRyZXNzKCkgewogIHJldHVybiBpc0Nvbm5lY3RlZCgpID8gd2ViM2Nvbm5lY3QuZ2V0QWRkcmVzcygpIDogIiI7Cn07Cgp2YXIgZ2V0V2ViMyA9IGZ1bmN0aW9uIGdldFdlYjMoKSB7CiAgcmV0dXJuIGlzQ29ubmVjdGVkKCkgPyB3ZWIzY29ubmVjdC5nZXRXZWIzKCkgOiBmYWxzZTsKfTsKCnZhciBfaW5pdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWY1ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgd2ViM2Nvbm5lY3Qub25Jbml0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBpZiAod2ViM2Nvbm5lY3QuaGFzQ2FjaGVkUHJvdmlkZXIoKSkgewogICAgICAgICAgICAgICAgdmFyIF93ZWIzID0gZmFsc2U7CgogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgX3dlYjMgPSB3ZWIzY29ubmVjdC5nZXRXZWIzKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgd2ViM2Nvbm5lY3QuY2xlYXJDYWNoZSgpOwoKICAgICAgICAgICAgICAgICAgX2luaXRSZWR1eFN0YXRlKCk7CgogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgc2V0TWV0YW1hc2soX3dlYjMpOwoKICAgICAgICAgICAgICAgIF9pbml0UmVkdXhTdGF0ZSgpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBfaW5pdFJlZHV4U3RhdGUoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTUpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIF9pbml0KCkgewogICAgcmV0dXJuIF9yZWY1LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKdmFyIGFkZFdhbGxldCA9IGZ1bmN0aW9uIGFkZFdhbGxldCgpIHsKICBfaW5pdFJlZHV4U3RhdGUoKTsKCiAgaWYgKGlzQ29ubmVjdGVkKCkpIHsKICAgIGdldEJhbGFuY2UoKTsKICB9Cn07Cgp2YXIgZ2V0QmFsYW5jZSA9IGZ1bmN0aW9uIGdldEJhbGFuY2UoKSB7CiAgY29uc29sZS5sb2coJ21ldGFtYXNrIGdldEJhbGFuY2UnKTsKCiAgdmFyIF9nZXRTdGF0ZSA9IGdldFN0YXRlKCksCiAgICAgIG1ldGFtYXNrRGF0YSA9IF9nZXRTdGF0ZS51c2VyLm1ldGFtYXNrRGF0YTsKCiAgaWYgKG1ldGFtYXNrRGF0YSkgewogICAgdmFyIGFkZHJlc3MgPSBtZXRhbWFza0RhdGEuYWRkcmVzczsKICAgIHZhciBiYWxhbmNlSW5DYWNoZSA9IGNhY2hlU3RvcmFnZUdldCgnY3VycmVuY3lCYWxhbmNlcycsICJldGhfIi5jb25jYXQoYWRkcmVzcykpOwoKICAgIGlmIChiYWxhbmNlSW5DYWNoZSAhPT0gZmFsc2UpIHsKICAgICAgcmVkdWNlcnMudXNlci5zZXRCYWxhbmNlKHsKICAgICAgICBuYW1lOiAnbWV0YW1hc2tEYXRhJywKICAgICAgICBhbW91bnQ6IGJhbGFuY2VJbkNhY2hlCiAgICAgIH0pOwogICAgICByZXR1cm4gYmFsYW5jZUluQ2FjaGU7CiAgICB9CgogICAgcmV0dXJuIHdlYjNjb25uZWN0LmdldFdlYjMoKS5ldGguZ2V0QmFsYW5jZShhZGRyZXNzKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgdmFyIGFtb3VudCA9IHdlYjNjb25uZWN0LmdldFdlYjMoKS51dGlscy5mcm9tV2VpKHJlc3VsdCk7CiAgICAgIGNhY2hlU3RvcmFnZVNldCgnY3VycmVuY3lCYWxhbmNlcycsICJldGhfIi5jb25jYXQoYWRkcmVzcyksIGFtb3VudCwgMzApOwogICAgICByZWR1Y2Vycy51c2VyLnNldEJhbGFuY2UoewogICAgICAgIG5hbWU6ICdtZXRhbWFza0RhdGEnLAogICAgICAgIGFtb3VudDogYW1vdW50CiAgICAgIH0pOwogICAgICByZXR1cm4gYW1vdW50OwogICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGUpIHsKICAgICAgY29uc29sZS5sb2coJ2ZhaWwgZ2V0IGJhbGFuY2UnKTsKICAgICAgY29uc29sZS5sb2coJ2Vycm9yJywgZSk7CiAgICAgIHJlZHVjZXJzLnVzZXIuc2V0QmFsYW5jZUVycm9yKHsKICAgICAgICBuYW1lOiAnbWV0YW1hc2tEYXRhJwogICAgICB9KTsKICAgIH0pOwogIH0KfTsKCnZhciBkaXNjb25uZWN0ID0gZnVuY3Rpb24gZGlzY29ubmVjdCgpIHsKICByZXR1cm4gbmV3IFByb21pc2UoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICB2YXIgX3JlZjYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNihyZXNvbHZlZCwgcmVqZWN0KSB7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGlmICghaXNDb25uZWN0ZWQoKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIHdlYjNjb25uZWN0LkRpc2Nvbm5lY3QoKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICByZXNvbHZlZCh0cnVlKTsgLy8gd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpCgogICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNzsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICByZXNvbHZlZCh0cnVlKTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU2KTsKICAgIH0pKTsKCiAgICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIpIHsKICAgICAgcmV0dXJuIF9yZWY2LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0oKSk7Cn07Cgp2YXIgY29ubmVjdCA9IGZ1bmN0aW9uIGNvbm5lY3Qob3B0aW9ucykgewogIHJldHVybiBuZXcgUHJvbWlzZSggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIHZhciBfcmVmNyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KHJlc29sdmVkLCByZWplY3QpIHsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgYWN0aW9ucy5tb2RhbHMub3Blbihjb25zdGFudHMubW9kYWxzLkNvbm5lY3RXYWxsZXRNb2RhbCwgX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBvcHRpb25zKSwge30sIHsKICAgICAgICAgICAgICAgIG9uUmVzb2x2ZTogcmVzb2x2ZWQsCiAgICAgICAgICAgICAgICBvblJlamVjdDogcmVqZWN0CiAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTcpOwogICAgfSkpOwoKICAgIHJldHVybiBmdW5jdGlvbiAoX3gzLCBfeDQpIHsKICAgICAgcmV0dXJuIF9yZWY3LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0oKSk7Cn07Ci8qIG1ldGFtYXNrIHdhbGxldCBsYXllciAqLwoKCnZhciBpc0NvcnJlY3ROZXR3b3JrID0gZnVuY3Rpb24gaXNDb3JyZWN0TmV0d29yaygpIHsKICByZXR1cm4gd2ViM2Nvbm5lY3QuaXNDb3JyZWN0TmV0d29yaygpOwp9OwoKdmFyIF9pbml0UmVkdXhTdGF0ZSA9IGZ1bmN0aW9uIF9pbml0UmVkdXhTdGF0ZSgpIHsKICB2YXIgX2dldFN0YXRlMiA9IGdldFN0YXRlKCksCiAgICAgIGV0aERhdGEgPSBfZ2V0U3RhdGUyLnVzZXIuZXRoRGF0YTsKCiAgaWYgKGlzQ29ubmVjdGVkKCkpIHsKICAgIHJlZHVjZXJzLnVzZXIuYWRkV2FsbGV0KHsKICAgICAgbmFtZTogJ21ldGFtYXNrRGF0YScsCiAgICAgIGRhdGE6IHsKICAgICAgICBhZGRyZXNzOiBnZXRBZGRyZXNzKCksCiAgICAgICAgYmFsYW5jZTogMCwKICAgICAgICBiYWxhbmNlRXJyb3I6IGZhbHNlLAogICAgICAgIGlzQ29ubmVjdGVkOiB0cnVlLAogICAgICAgIGlzTWV0YW1hc2s6IHRydWUsCiAgICAgICAgY3VycmVuY3k6ICJFVEgiLAogICAgICAgIGZ1bGxOYW1lOiAiRXRoZXJldW0gKCIuY29uY2F0KHdlYjNjb25uZWN0LmdldFByb3ZpZGVyVGl0bGUoKSwgIikiKSwKICAgICAgICBpbmZvQWJvdXRDdXJyZW5jeTogZXRoRGF0YS5pbmZvQWJvdXRDdXJyZW5jeSwKICAgICAgICBpc0JhbGFuY2VGZXRjaGVkOiB0cnVlLAogICAgICAgIGlzTW5lbW9uaWM6IHRydWUsCiAgICAgICAgdW5jb25maXJtZWRCYWxhbmNlOiAwCiAgICAgIH0KICAgIH0pOwogIH0gZWxzZSB7CiAgICByZWR1Y2Vycy51c2VyLmFkZFdhbGxldCh7CiAgICAgIG5hbWU6ICdtZXRhbWFza0RhdGEnLAogICAgICBkYXRhOiB7CiAgICAgICAgYWRkcmVzczogJ05vdCBjb25uZWN0ZWQnLAogICAgICAgIGJhbGFuY2U6IDAsCiAgICAgICAgYmFsYW5jZUVycm9yOiBmYWxzZSwKICAgICAgICBpc0Nvbm5lY3RlZDogZmFsc2UsCiAgICAgICAgaXNNZXRhbWFzazogdHJ1ZSwKICAgICAgICBjdXJyZW5jeTogIkVUSCIsCiAgICAgICAgZnVsbE5hbWU6ICJFdGhlcmV1bSAoZXh0ZXJuYWwgd2FsbGV0KSIsCiAgICAgICAgaW5mb0Fib3V0Q3VycmVuY3k6IGV0aERhdGEuaW5mb0Fib3V0Q3VycmVuY3ksCiAgICAgICAgaXNCYWxhbmNlRmV0Y2hlZDogdHJ1ZSwKICAgICAgICBpc01uZW1vbmljOiB0cnVlLAogICAgICAgIHVuY29uZmlybWVkQmFsYW5jZTogMAogICAgICB9CiAgICB9KTsKICB9Cn07CgppZiAod2ViM2Nvbm5lY3QuaGFzQ2FjaGVkUHJvdmlkZXIoKSkgewogIF9pbml0KCk7Cn0gZWxzZSB7CiAgX2luaXRSZWR1eFN0YXRlKCk7Cn0KCnZhciBtZXRhbWFza0FwaSA9IHsKICBjb25uZWN0OiBjb25uZWN0LAogIGlzRW5hYmxlZDogaXNFbmFibGVkLAogIGlzQ29ubmVjdGVkOiBpc0Nvbm5lY3RlZCwKICBnZXRBZGRyZXNzOiBnZXRBZGRyZXNzLAogIHdlYjNjb25uZWN0OiB3ZWIzY29ubmVjdCwKICBhZGRXYWxsZXQ6IGFkZFdhbGxldCwKICBnZXRCYWxhbmNlOiBnZXRCYWxhbmNlLAogIGdldFdlYjM6IGdldFdlYjMsCiAgZGlzY29ubmVjdDogZGlzY29ubmVjdCwKICBpc0NvcnJlY3ROZXR3b3JrOiBpc0NvcnJlY3ROZXR3b3JrCn07CndpbmRvdy5tZXRhbWFza0FwaSA9IG1ldGFtYXNrQXBpOwpleHBvcnQgZGVmYXVsdCBtZXRhbWFza0FwaTs="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/helpers/metamask.ts"],"names":["reducers","getState","actions","cacheStorageGet","cacheStorageSet","constants","config","setMetamask","setProvider","setDefaultProvider","getWeb3","getDefaultWeb3","SwapApp","Web3Connect","web3connect","web3ChainId","binance","process","env","MAINNET","web3RPC","binance_provider","web3","provider","_onWeb3Changed","newWeb3","shared","setWeb3Provider","_initReduxState","user","sign_to_tokens","getBalances","on","localStorage","setItem","isWalletCreate","core","markCoinAsVisible","isEnabled","isConnected","getAddress","_init","onInit","hasCachedProvider","_web3","err","clearCache","addWallet","getBalance","console","log","metamaskData","address","balanceInCache","setBalance","name","amount","eth","then","result","utils","fromWei","e","setBalanceError","disconnect","Promise","resolved","reject","Disconnect","connect","options","modals","open","ConnectWalletModal","onResolve","onReject","isCorrectNetwork","ethData","data","balance","balanceError","isMetamask","currency","fullName","getProviderTitle","infoAboutCurrency","isBalanceFetched","isMnemonic","unconfirmedBalance","metamaskApi","window"],"mappings":"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","sourcesContent":["// @ts-nocheck\r\nimport reducers from 'redux/core/reducers'\r\nimport { getState } from 'redux/core'\r\nimport actions from 'redux/actions'\r\nimport { cacheStorageGet, cacheStorageSet, constants } from 'helpers'\r\nimport web3 from 'helpers/web3'\r\nimport config from 'app-config'\r\nimport { setMetamask, setProvider, setDefaultProvider, getWeb3 as getDefaultWeb3 } from 'helpers/web3'\r\nimport SwapApp from 'swap.app'\r\nimport Web3Connect from '../../../common/web3connect'\r\n\r\nconst web3connect = new Web3Connect({\r\n  web3ChainId: (config.binance)\r\n    ? (process.env.MAINNET) ? 56 : 97  // 56 = Mainnet, 97 = Testnet\r\n    : (process.env.MAINNET) ? 1 : 3, // 1 = Mainnet, 3 = Ropsten\r\n  web3RPC: (config.binance)\r\n    ? config.binance_provider\r\n    : config.web3.provider,\r\n})\r\n\r\nconst _onWeb3Changed = (newWeb3) => {\r\n  setProvider(newWeb3)\r\n  SwapApp.shared().setWeb3Provider(newWeb3)\r\n  _initReduxState()\r\n  actions.user.sign_to_tokens()\r\n  actions.user.getBalances()\r\n}\r\n\r\nweb3connect.on('connected', async () => {\r\n  //@\r\n  localStorage.setItem(constants.localStorage.isWalletCreate, true)\r\n  actions.core.markCoinAsVisible(`ETH`)\r\n  _onWeb3Changed(web3connect.getWeb3())\r\n})\r\n\r\nweb3connect.on('disconnect', async () => {\r\n  setDefaultProvider()\r\n  _onWeb3Changed(getDefaultWeb3())\r\n})\r\n\r\nweb3connect.on('accountChange', async () => {\r\n  _onWeb3Changed(web3connect.getWeb3())\r\n})\r\n\r\nweb3connect.on('chainChanged', async () => {\r\n  _onWeb3Changed(web3connect.getWeb3())\r\n})\r\n\r\nconst isEnabled = () => true\r\n\r\nconst isConnected = () => web3connect.isConnected()\r\n\r\nconst getAddress = () => (isConnected()) ? web3connect.getAddress() : ``\r\n\r\nconst getWeb3 = () => (isConnected()) ? web3connect.getWeb3() : false\r\n\r\nconst _init = async () => {\r\n  web3connect.onInit(() => {\r\n    if (web3connect.hasCachedProvider()) {\r\n      let _web3 = false\r\n      try {\r\n        _web3 = web3connect.getWeb3()\r\n      } catch (err) {\r\n        web3connect.clearCache()\r\n        _initReduxState()\r\n        return\r\n      }\r\n      setMetamask(_web3)\r\n      _initReduxState()\r\n    } else {\r\n      _initReduxState()\r\n    }\r\n  })\r\n}\r\n\r\nconst addWallet = () => {\r\n  _initReduxState()\r\n  if (isConnected()) {\r\n    getBalance()\r\n  }\r\n}\r\n\r\nconst getBalance = () => {\r\n  console.log('metamask getBalance')\r\n  const { user: { metamaskData } } = getState()\r\n  if (metamaskData) {\r\n    const { address } = metamaskData\r\n\r\n    const balanceInCache = cacheStorageGet('currencyBalances', `eth_${address}`)\r\n    if (balanceInCache !== false) {\r\n      reducers.user.setBalance({\r\n        name: 'metamaskData',\r\n        amount: balanceInCache,\r\n      })\r\n      return balanceInCache\r\n    }\r\n\r\n    return web3connect.getWeb3().eth.getBalance(address)\r\n      .then(result => {\r\n        const amount = web3connect.getWeb3().utils.fromWei(result)\r\n\r\n        cacheStorageSet('currencyBalances', `eth_${address}`, amount, 30)\r\n        reducers.user.setBalance({ name: 'metamaskData', amount })\r\n        return amount\r\n      })\r\n      .catch((e) => {\r\n        console.log('fail get balance')\r\n        console.log('error', e)\r\n        reducers.user.setBalanceError({ name: 'metamaskData' })\r\n      })\r\n  }\r\n}\r\n\r\nconst disconnect = () => new Promise(async (resolved, reject) => {\r\n  if (isConnected()) {\r\n    await web3connect.Disconnect()\r\n    resolved(true)\r\n    // window.location.reload()\r\n  } else {\r\n    resolved(true)\r\n  }\r\n})\r\n\r\nconst connect = (options) => new Promise(async (resolved, reject) => {\r\n  actions.modals.open(constants.modals.ConnectWalletModal, {\r\n    ...options,\r\n    onResolve: resolved,\r\n    onReject: reject,\r\n  })\r\n})\r\n\r\n/* metamask wallet layer */\r\nconst isCorrectNetwork = () => web3connect.isCorrectNetwork()\r\n\r\n\r\nconst _initReduxState = () => {\r\n  const {\r\n    user: {\r\n      ethData,\r\n    },\r\n  } = getState()\r\n\r\n  if (isConnected()) {\r\n    reducers.user.addWallet({\r\n      name: 'metamaskData',\r\n      data: {\r\n        address: getAddress(),\r\n        balance: 0,\r\n        balanceError: false,\r\n        isConnected: true,\r\n        isMetamask: true,\r\n        currency: \"ETH\",\r\n        fullName: `Ethereum (${web3connect.getProviderTitle()})`,\r\n        infoAboutCurrency: ethData.infoAboutCurrency,\r\n        isBalanceFetched: true,\r\n        isMnemonic: true,\r\n        unconfirmedBalance: 0,\r\n      },\r\n    })\r\n  } else {\r\n    reducers.user.addWallet({\r\n      name: 'metamaskData',\r\n      data: {\r\n        address: 'Not connected',\r\n        balance: 0,\r\n        balanceError: false,\r\n        isConnected: false,\r\n        isMetamask: true,\r\n        currency: \"ETH\",\r\n        fullName: `Ethereum (external wallet)`,\r\n        infoAboutCurrency: ethData.infoAboutCurrency,\r\n        isBalanceFetched: true,\r\n        isMnemonic: true,\r\n        unconfirmedBalance: 0,\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nif (web3connect.hasCachedProvider()) {\r\n  _init()\r\n} else {\r\n  _initReduxState()\r\n}\r\n\r\nconst metamaskApi = {\r\n  connect,\r\n  isEnabled,\r\n  isConnected,\r\n  getAddress,\r\n  web3connect,\r\n  addWallet,\r\n  getBalance,\r\n  getWeb3,\r\n  disconnect,\r\n  isCorrectNetwork,\r\n}\r\n\r\nwindow.metamaskApi = metamaskApi\r\n\r\nexport default metamaskApi\r\n"]}]}