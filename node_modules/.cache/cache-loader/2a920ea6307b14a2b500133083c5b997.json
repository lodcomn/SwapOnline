{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\helpers\\ghost.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\helpers\\ghost.ts","mtime":1614850469185},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKLy8gQHRzLW5vY2hlY2sKaW1wb3J0IHsgZ2V0U3RhdGUgfSBmcm9tICdyZWR1eC9jb3JlJzsKaW1wb3J0IGFjdGlvbnMgZnJvbSAncmVkdXgvYWN0aW9ucyc7CmltcG9ydCBjb25maWcgZnJvbSAnLi9leHRlcm5hbENvbmZpZyc7CmltcG9ydCBjb25zdGFudHMgZnJvbSAnLi9jb25zdGFudHMnOwppbXBvcnQgcmVxdWVzdCBmcm9tICdjb21tb24vdXRpbHMvcmVxdWVzdCc7CmltcG9ydCBCaWdOdW1iZXIgZnJvbSAnYmlnbnVtYmVyLmpzJzsKdmFyIG5ldHdvcmtzID0gewogIG1haW5uZXQ6IHsKICAgIG1lc3NhZ2VQcmVmaXg6ICdceDE4Qml0Y29pbiBTaWduZWQgTWVzc2FnZTpcbicsCiAgICBiZWNoMzI6ICdncCcsCiAgICBiaXAzMjogewogICAgICAicHVibGljIjogMHg2OERGN0NCRCwKICAgICAgInByaXZhdGUiOiAweDhFOEVBOEVBCiAgICB9LAogICAgcHViS2V5SGFzaDogMHgyNiwKICAgIHNjcmlwdEhhc2g6IDB4NjEsCiAgICB3aWY6IDB4QTYKICB9LAogIHRlc3RuZXQ6IHsKICAgIG1lc3NhZ2VQcmVmaXg6ICdceDE4Qml0Y29pbiBTaWduZWQgTWVzc2FnZTpcbicsCiAgICBiZWNoMzI6ICd0Z2hvc3QnLAogICAgYmlwMzI6IHsKICAgICAgInB1YmxpYyI6IDB4ZTE0Mjc4MDAsCiAgICAgICJwcml2YXRlIjogMHgwNDg4OTQ3OAogICAgfSwKICAgIHB1YktleUhhc2g6IDB4NEIsCiAgICBzY3JpcHRIYXNoOiAweDg5LAogICAgd2lmOiAweDJlCiAgfQp9Owp2YXIgaGFzQWRtaW5GZWUgPSBjb25maWcgJiYgY29uZmlnLm9wdHMgJiYgY29uZmlnLm9wdHMuZmVlICYmIGNvbmZpZy5vcHRzLmZlZS5naG9zdCAmJiBjb25maWcub3B0cy5mZWUuZ2hvc3QuZmVlID8gY29uZmlnLm9wdHMuZmVlLmdob3N0IDogZmFsc2U7CnZhciBuZXR3b3JrID0gcHJvY2Vzcy5lbnYuTUFJTk5FVCA/IG5ldHdvcmtzLm1haW5uZXQgOiBuZXR3b3Jrcy50ZXN0bmV0Owp2YXIgRFVTVCA9IDU0NjsgLy8gZGVzY3JpcHRpb24gaW4gLi9idGMudHMKLy8gZ2V0Qnl0ZUNvdW50KHsnTVVMVElTSUctUDJTSDoyLTQnOjQ1fSx7J1AyUEtIJzoxfSkgTWVhbnMgIjQ1IGlucHV0cyBvZiBQMlNIIE11bHRpc2lnIGFuZCAxIG91dHB1dCBvZiBQMlBLSCIKLy8gZ2V0Qnl0ZUNvdW50KHsnUDJQS0gnOjEsJ01VTFRJU0lHLVAyU0g6Mi0zJzoyfSx7J1AyUEtIJzoyfSkgbWVhbnMgIjEgUDJQS0ggaW5wdXQgYW5kIDIgTXVsdGlzaWcgUDJTSCAoMiBvZiAzKSBpbnB1dHMgYWxvbmcgd2l0aCAyIFAyUEtIIG91dHB1dHMiCgp2YXIgZ2V0Qnl0ZUNvdW50ID0gZnVuY3Rpb24gZ2V0Qnl0ZUNvdW50KGlucHV0cywgb3V0cHV0cykgewogIHZhciB0b3RhbFdlaWdodCA9IDA7CiAgdmFyIGhhc1dpdG5lc3MgPSBmYWxzZTsKICB2YXIgaW5wdXRDb3VudCA9IDA7CiAgdmFyIG91dHB1dENvdW50ID0gMDsgLy8gYXNzdW1lcyBjb21wcmVzc2VkIHB1YmtleXMgaW4gYWxsIGNhc2VzLgoKICB2YXIgdHlwZXMgPSB7CiAgICAnaW5wdXRzJzogewogICAgICAnTVVMVElTSUctUDJTSCc6IDQ5ICogNCwKICAgICAgJ01VTFRJU0lHLVAyV1NIJzogNiArIDQxICogNCwKICAgICAgJ01VTFRJU0lHLVAyU0gtUDJXU0gnOiA2ICsgNzYgKiA0LAogICAgICAnUDJQS0gnOiAxNDggKiA0LAogICAgICAnUDJXUEtIJzogMTA4ICsgNDEgKiA0LAogICAgICAnUDJTSC1QMldQS0gnOiAxMDggKyA2NCAqIDQKICAgIH0sCiAgICAnb3V0cHV0cyc6IHsKICAgICAgJ1AyU0gnOiAzMiAqIDQsCiAgICAgICdQMlBLSCc6IDM0ICogNCwKICAgICAgJ1AyV1BLSCc6IDMxICogNCwKICAgICAgJ1AyV1NIJzogNDMgKiA0CiAgICB9CiAgfTsKCiAgdmFyIGNoZWNrVUludDUzID0gZnVuY3Rpb24gY2hlY2tVSW50NTMobikgewogICAgaWYgKG4gPCAwIHx8IG4gPiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCBuICUgMSAhPT0gMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3ZhbHVlIG91dCBvZiByYW5nZScpOwogIH07CgogIHZhciB2YXJJbnRMZW5ndGggPSBmdW5jdGlvbiB2YXJJbnRMZW5ndGgobnVtYmVyKSB7CiAgICBjaGVja1VJbnQ1MyhudW1iZXIpOwogICAgcmV0dXJuIG51bWJlciA8IDB4ZmQgPyAxIDogbnVtYmVyIDw9IDB4ZmZmZiA/IDMgOiBudW1iZXIgPD0gMHhmZmZmZmZmZiA/IDUgOiA5OwogIH07CgogIE9iamVjdC5rZXlzKGlucHV0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICBjaGVja1VJbnQ1MyhpbnB1dHNba2V5XSk7CgogICAgaWYgKGtleS5zbGljZSgwLCA4KSA9PT0gJ01VTFRJU0lHJykgewogICAgICAvLyBleC4gIk1VTFRJU0lHLVAyU0g6Mi0zIiB3b3VsZCBtZWFuIDIgb2YgMyBQMlNIIE1VTFRJU0lHCiAgICAgIHZhciBrZXlQYXJ0cyA9IGtleS5zcGxpdCgnOicpOwogICAgICBpZiAoa2V5UGFydHMubGVuZ3RoICE9PSAyKSB0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgaW5wdXQ6ICIuY29uY2F0KGtleSkpOwogICAgICB2YXIgbmV3S2V5ID0ga2V5UGFydHNbMF07CiAgICAgIHZhciBtQW5kTiA9IGtleVBhcnRzWzFdLnNwbGl0KCctJykubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIHBhcnNlSW50KGl0ZW0pOwogICAgICB9KTsKICAgICAgdG90YWxXZWlnaHQgKz0gdHlwZXMuaW5wdXRzW25ld0tleV0gKiBpbnB1dHNba2V5XTsKICAgICAgdmFyIG11bHRpcGx5ZXIgPSBuZXdLZXkgPT09ICdNVUxUSVNJRy1QMlNIJyA/IDQgOiAxOwogICAgICB0b3RhbFdlaWdodCArPSAoNzMgKiBtQW5kTlswXSArIDM0ICogbUFuZE5bMV0pICogbXVsdGlwbHllciAqIGlucHV0c1trZXldOwogICAgfSBlbHNlIHsKICAgICAgdG90YWxXZWlnaHQgKz0gdHlwZXMuaW5wdXRzW2tleV0gKiBpbnB1dHNba2V5XTsKICAgIH0KCiAgICBpbnB1dENvdW50ICs9IGlucHV0c1trZXldOwogICAgaWYgKGtleS5pbmRleE9mKCdXJykgPj0gMCkgaGFzV2l0bmVzcyA9IHRydWU7CiAgfSk7CiAgT2JqZWN0LmtleXMob3V0cHV0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICBjaGVja1VJbnQ1MyhvdXRwdXRzW2tleV0pOwogICAgdG90YWxXZWlnaHQgKz0gdHlwZXMub3V0cHV0c1trZXldICogb3V0cHV0c1trZXldOwogICAgb3V0cHV0Q291bnQgKz0gb3V0cHV0c1trZXldOwogIH0pOwogIGlmIChoYXNXaXRuZXNzKSB0b3RhbFdlaWdodCArPSAyOwogIHRvdGFsV2VpZ2h0ICs9IDggKiA0OwogIHRvdGFsV2VpZ2h0ICs9IHZhckludExlbmd0aChpbnB1dENvdW50KSAqIDQ7CiAgdG90YWxXZWlnaHQgKz0gdmFySW50TGVuZ3RoKG91dHB1dENvdW50KSAqIDQ7CiAgcmV0dXJuIE1hdGguY2VpbCh0b3RhbFdlaWdodCAvIDQpOwp9OyAvL0AKCgp2YXIgY2FsY3VsYXRlVHhTaXplID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICB2YXIgX3JlZjIsCiAgICAgICAgc3BlZWQsCiAgICAgICAgdW5zcGVudHMsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBfcmVmMiR0eE91dCwKICAgICAgICB0eE91dCwKICAgICAgICBfcmVmMiRtZXRob2QsCiAgICAgICAgbWV0aG9kLAogICAgICAgIGZpeGVkLAogICAgICAgIGRlZmF1bHRUeFNpemUsCiAgICAgICAgdHhJbiwKICAgICAgICB0eFNpemUsCiAgICAgICAgbXN1U2l6ZSwKICAgICAgICBtc3V0eFNpemUsCiAgICAgICAgbXNTaXplLAogICAgICAgIG1zdHhTaXplLAogICAgICAgIF9hcmdzID0gYXJndW1lbnRzOwoKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9yZWYyID0gX2FyZ3MubGVuZ3RoID4gMCAmJiBfYXJnc1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3NbMF0gOiB7fSwgc3BlZWQgPSBfcmVmMi5zcGVlZCwgdW5zcGVudHMgPSBfcmVmMi51bnNwZW50cywgYWRkcmVzcyA9IF9yZWYyLmFkZHJlc3MsIF9yZWYyJHR4T3V0ID0gX3JlZjIudHhPdXQsIHR4T3V0ID0gX3JlZjIkdHhPdXQgPT09IHZvaWQgMCA/IDIgOiBfcmVmMiR0eE91dCwgX3JlZjIkbWV0aG9kID0gX3JlZjIubWV0aG9kLCBtZXRob2QgPSBfcmVmMiRtZXRob2QgPT09IHZvaWQgMCA/ICdzZW5kJyA6IF9yZWYyJG1ldGhvZCwgZml4ZWQgPSBfcmVmMi5maXhlZDsKICAgICAgICAgICAgZGVmYXVsdFR4U2l6ZSA9IGNvbnN0YW50cy5kZWZhdWx0RmVlUmF0ZXMuZ2hvc3Quc2l6ZVttZXRob2RdOwoKICAgICAgICAgICAgaWYgKCFmaXhlZCkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBkZWZhdWx0VHhTaXplKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIF9jb250ZXh0LnQwID0gdW5zcGVudHM7CgogICAgICAgICAgICBpZiAoX2NvbnRleHQudDApIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7CiAgICAgICAgICAgIHJldHVybiBhY3Rpb25zLmdob3N0LmZldGNoVW5zcGVudHMoYWRkcmVzcyk7CgogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICB1bnNwZW50cyA9IF9jb250ZXh0LnQwOwogICAgICAgICAgICB0eEluID0gdW5zcGVudHMubGVuZ3RoOwogICAgICAgICAgICB0eFNpemUgPSB0eEluID4gMCA/IHR4SW4gKiAxNDYgKyB0eE91dCAqIDMzICsgKDE1ICsgdHhJbiAtIHR4T3V0KSA6IGRlZmF1bHRUeFNpemU7CgogICAgICAgICAgICBpZiAoIShtZXRob2QgPT09ICdzZW5kX211bHRpc2lnJykpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1zdVNpemUgPSBnZXRCeXRlQ291bnQoewogICAgICAgICAgICAgICdNVUxUSVNJRy1QMlNILVAyV1NIOjItMic6IDEKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICdQMlBLSCc6IGhhc0FkbWluRmVlID8gMyA6IDIKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIG1zdXR4U2l6ZSA9IHR4SW4gKiBtc3VTaXplICsgdHhPdXQgKiAzMyArICgxNSArIHR4SW4gLSB0eE91dCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIG1zdXR4U2l6ZSk7CgogICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgaWYgKCEobWV0aG9kID09PSAnc2VuZF8yZmEnKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbXNTaXplID0gZ2V0Qnl0ZUNvdW50KHsKICAgICAgICAgICAgICAnTVVMVElTSUctUDJTSC1QMldTSDoyLTMnOiAxCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAnUDJQS0gnOiBoYXNBZG1pbkZlZSA/IDMgOiAyCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBtc3R4U2l6ZSA9IHR4SW4gKiBtc1NpemUgKyB0eE91dCAqIDMzICsgKDE1ICsgdHhJbiAtIHR4T3V0KTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbXN0eFNpemUpOwoKICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHR4U2l6ZSk7CgogICAgICAgICAgY2FzZSAyMToKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBjYWxjdWxhdGVUeFNpemUoKSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKCnZhciBlc3RpbWF0ZUZlZVZhbHVlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZjMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihvcHRpb25zKSB7CiAgICB2YXIgZmVlUmF0ZSwgaW5TYXRvc2hpcywgc3BlZWQsIGFkZHJlc3MsIHR4U2l6ZSwgZml4ZWQsIG1ldGhvZCwgX2dldFN0YXRlLCBfZ2V0U3RhdGUkdXNlciwgZ2hvc3REYXRhLCBnaG9zdE11bHRpc2lnU01TRGF0YSwgZ2hvc3RNdWx0aXNpZ1VzZXJEYXRhLCB0eE91dCwgY2FsY3VsYXRlZEZlZVZhbHVlLCBDVVNUT01fU0FUT1NISSwgZmluYWxGZWVWYWx1ZTsKCiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgZmVlUmF0ZSA9IG9wdGlvbnMuZmVlUmF0ZSwgaW5TYXRvc2hpcyA9IG9wdGlvbnMuaW5TYXRvc2hpcywgc3BlZWQgPSBvcHRpb25zLnNwZWVkLCBhZGRyZXNzID0gb3B0aW9ucy5hZGRyZXNzLCB0eFNpemUgPSBvcHRpb25zLnR4U2l6ZSwgZml4ZWQgPSBvcHRpb25zLmZpeGVkLCBtZXRob2QgPSBvcHRpb25zLm1ldGhvZDsKICAgICAgICAgICAgX2dldFN0YXRlID0gZ2V0U3RhdGUoKSwgX2dldFN0YXRlJHVzZXIgPSBfZ2V0U3RhdGUudXNlciwgZ2hvc3REYXRhID0gX2dldFN0YXRlJHVzZXIuZ2hvc3REYXRhLCBnaG9zdE11bHRpc2lnU01TRGF0YSA9IF9nZXRTdGF0ZSR1c2VyLmdob3N0TXVsdGlzaWdTTVNEYXRhLCBnaG9zdE11bHRpc2lnVXNlckRhdGEgPSBfZ2V0U3RhdGUkdXNlci5naG9zdE11bHRpc2lnVXNlckRhdGE7CiAgICAgICAgICAgIHR4T3V0ID0gMjsKICAgICAgICAgICAgaWYgKGhhc0FkbWluRmVlKSB0eE91dCA9IDM7CgogICAgICAgICAgICBpZiAoIWFkZHJlc3MpIHsKICAgICAgICAgICAgICBhZGRyZXNzID0gZ2hvc3REYXRhLmFkZHJlc3M7IC8vQAoKICAgICAgICAgICAgICBpZiAobWV0aG9kID09PSAnc2VuZF8yZmEnKSBhZGRyZXNzID0gZ2hvc3RNdWx0aXNpZ1NNUzsKICAgICAgICAgICAgICBpZiAobWV0aG9kID09PSAnc2VuZF9tdWx0aXNpZycpIGFkZHJlc3MgPSBnaG9zdE11bHRpc2lnVXNlckRhdGEuYWRkcmVzczsKICAgICAgICAgICAgfSAvL0AKCgogICAgICAgICAgICBfY29udGV4dDIudDAgPSB0eFNpemU7CgogICAgICAgICAgICBpZiAoX2NvbnRleHQyLnQwKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA5OwogICAgICAgICAgICByZXR1cm4gY2FsY3VsYXRlVHhTaXplKHsKICAgICAgICAgICAgICBhZGRyZXNzOiBhZGRyZXNzLAogICAgICAgICAgICAgIHNwZWVkOiBzcGVlZCwKICAgICAgICAgICAgICBmaXhlZDogZml4ZWQsCiAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2QsCiAgICAgICAgICAgICAgdHhPdXQ6IHR4T3V0CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgdHhTaXplID0gX2NvbnRleHQyLnQwOwogICAgICAgICAgICBfY29udGV4dDIudDEgPSBmZWVSYXRlOwoKICAgICAgICAgICAgaWYgKF9jb250ZXh0Mi50MSkgewogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTU7CiAgICAgICAgICAgIHJldHVybiBlc3RpbWF0ZUZlZVJhdGUoewogICAgICAgICAgICAgIHNwZWVkOiBzcGVlZAogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICBfY29udGV4dDIudDEgPSBfY29udGV4dDIuc2VudDsKCiAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICBmZWVSYXRlID0gX2NvbnRleHQyLnQxOwogICAgICAgICAgICBjYWxjdWxhdGVkRmVlVmFsdWUgPSBCaWdOdW1iZXIubWF4aW11bShEVVNULCBuZXcgQmlnTnVtYmVyKGZlZVJhdGUpLm11bHRpcGxpZWRCeSh0eFNpemUpLmRpdigxMDI0KSAvLyBkaXZpZGUgYnkgb25lIGtpbG9ieXRlCiAgICAgICAgICAgIC5kcCgwLCBCaWdOdW1iZXIuUk9VTkRfSEFMRl9FVkVOKSk7CiAgICAgICAgICAgIENVU1RPTV9TQVRPU0hJID0gMjA7CiAgICAgICAgICAgIGNhbGN1bGF0ZWRGZWVWYWx1ZS5wbHVzKENVU1RPTV9TQVRPU0hJKTsgLy8ganVzdCB3YW50ZWQgdG8gYWRkCgogICAgICAgICAgICBmaW5hbEZlZVZhbHVlID0gaW5TYXRvc2hpcyA/IGNhbGN1bGF0ZWRGZWVWYWx1ZS50b1N0cmluZygpIDogY2FsY3VsYXRlZEZlZVZhbHVlLm11bHRpcGxpZWRCeSgxZS04KS50b1N0cmluZygpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiR2hvc3Qgd2l0aGRyYXcgZmVlIHNwZWVkKCIuY29uY2F0KHNwZWVkLCAiKSBtZXRob2QgKCIpLmNvbmNhdChtZXRob2QsICIpICIpLmNvbmNhdChmaW5hbEZlZVZhbHVlKSk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBmaW5hbEZlZVZhbHVlKTsKCiAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMik7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gZXN0aW1hdGVGZWVWYWx1ZShfeCkgewogICAgcmV0dXJuIF9yZWYzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKdmFyIGVzdGltYXRlRmVlUmF0ZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWY0ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICB2YXIgX3JlZjUsCiAgICAgICAgX3JlZjUkc3BlZWQsCiAgICAgICAgc3BlZWQsCiAgICAgICAgbGluaywKICAgICAgICBkZWZhdWx0UmF0ZSwKICAgICAgICBhcGlSZXN1bHQsCiAgICAgICAgYXBpU3BlZWRzLAogICAgICAgIGFwaVNwZWVkLAogICAgICAgIGFwaVJhdGUsCiAgICAgICAgX2FyZ3MzID0gYXJndW1lbnRzOwoKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfcmVmNSA9IF9hcmdzMy5sZW5ndGggPiAwICYmIF9hcmdzM1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MzWzBdIDoge30sIF9yZWY1JHNwZWVkID0gX3JlZjUuc3BlZWQsIHNwZWVkID0gX3JlZjUkc3BlZWQgPT09IHZvaWQgMCA/ICdmYXN0JyA6IF9yZWY1JHNwZWVkOwogICAgICAgICAgICBsaW5rID0gY29uZmlnLmZlZVJhdGVzLmdob3N0OwogICAgICAgICAgICBkZWZhdWx0UmF0ZSA9IGNvbnN0YW50cy5kZWZhdWx0RmVlUmF0ZXMuZ2hvc3QucmF0ZTsKCiAgICAgICAgICAgIGlmIChsaW5rKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgZGVmYXVsdFJhdGVbc3BlZWRdKTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gNTsKICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA4OwogICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5nZXQobGluaywgewogICAgICAgICAgICAgIGNhY2hlUmVzcG9uc2U6IDYwMDAwCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgYXBpUmVzdWx0ID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMTE7CiAgICAgICAgICAgIF9jb250ZXh0My50MCA9IF9jb250ZXh0M1siY2F0Y2giXSg1KTsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXN0aW1hdGVGZWVSYXRlOiAiLmNvbmNhdChfY29udGV4dDMudDAubWVzc2FnZSkpOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgZGVmYXVsdFJhdGVbc3BlZWRdKTsKCiAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICBhcGlTcGVlZHMgPSB7CiAgICAgICAgICAgICAgc2xvdzogJ2xvd19mZWVfcGVyX2tiJywKICAgICAgICAgICAgICBub3JtYWw6ICdtZWRpdW1fZmVlX3Blcl9rYicsCiAgICAgICAgICAgICAgZmFzdDogJ2hpZ2hfZmVlX3Blcl9rYicKICAgICAgICAgICAgfTsKICAgICAgICAgICAgYXBpU3BlZWQgPSBhcGlTcGVlZHNbc3BlZWRdIHx8IGFwaVNwZWVkcy5ub3JtYWw7CiAgICAgICAgICAgIGFwaVJhdGUgPSBuZXcgQmlnTnVtYmVyKGFwaVJlc3VsdFthcGlTcGVlZF0pOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgYXBpUmF0ZS5pc0dyZWF0ZXJUaGFuT3JFcXVhbFRvKERVU1QpID8gYXBpUmF0ZS50b1N0cmluZygpIDogZGVmYXVsdFJhdGVbc3BlZWRdKTsKCiAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMywgbnVsbCwgW1s1LCAxMV1dKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBlc3RpbWF0ZUZlZVJhdGUoKSB7CiAgICByZXR1cm4gX3JlZjQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7CgpleHBvcnQgZGVmYXVsdCB7CiAgY2FsY3VsYXRlVHhTaXplOiBjYWxjdWxhdGVUeFNpemUsCiAgZXN0aW1hdGVGZWVWYWx1ZTogZXN0aW1hdGVGZWVWYWx1ZSwKICBlc3RpbWF0ZUZlZVJhdGU6IGVzdGltYXRlRmVlUmF0ZSwKICBuZXR3b3JrOiBuZXR3b3JrLAogIG5ldHdvcmtzOiBuZXR3b3Jrcwp9Ow=="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/helpers/ghost.ts"],"names":["getState","actions","config","constants","request","BigNumber","networks","mainnet","messagePrefix","bech32","bip32","pubKeyHash","scriptHash","wif","testnet","hasAdminFee","opts","fee","ghost","network","process","env","MAINNET","DUST","getByteCount","inputs","outputs","totalWeight","hasWitness","inputCount","outputCount","types","checkUInt53","n","Number","MAX_SAFE_INTEGER","RangeError","varIntLength","number","Object","keys","forEach","key","slice","keyParts","split","length","Error","newKey","mAndN","map","item","parseInt","multiplyer","indexOf","Math","ceil","calculateTxSize","speed","unspents","address","txOut","method","fixed","defaultTxSize","defaultFeeRates","size","fetchUnspents","txIn","txSize","msuSize","msutxSize","msSize","mstxSize","estimateFeeValue","options","feeRate","inSatoshis","user","ghostData","ghostMultisigSMSData","ghostMultisigUserData","ghostMultisigSMS","estimateFeeRate","calculatedFeeValue","maximum","multipliedBy","div","dp","ROUND_HALF_EVEN","CUSTOM_SATOSHI","plus","finalFeeValue","toString","console","log","link","feeRates","defaultRate","rate","get","cacheResponse","apiResult","error","message","apiSpeeds","slow","normal","fast","apiSpeed","apiRate","isGreaterThanOrEqualTo"],"mappings":"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","sourcesContent":["// @ts-nocheck\r\nimport * as bitcoin from 'bitcoinjs-lib'\r\nimport { getState } from 'redux/core'\r\nimport actions from 'redux/actions'\r\nimport config from './externalConfig'\r\nimport constants from './constants'\r\nimport request from 'common/utils/request'\r\nimport BigNumber from 'bignumber.js'\r\n\r\n\r\nconst networks = {\r\n  mainnet: {\r\n    messagePrefix: '\\x18Bitcoin Signed Message:\\n',\r\n    bech32: 'gp',\r\n    bip32: {\r\n      public:  0x68DF7CBD,\r\n      private: 0x8E8EA8EA,\r\n    },\r\n    pubKeyHash: 0x26,\r\n    scriptHash: 0x61,\r\n    wif: 0xA6,\r\n  },\r\n  testnet: {\r\n    messagePrefix: '\\x18Bitcoin Signed Message:\\n',\r\n    bech32: 'tghost',\r\n    bip32: {\r\n      public: 0xe1427800,\r\n      private: 0x04889478,\r\n    },\r\n    pubKeyHash: 0x4B,\r\n    scriptHash: 0x89,\r\n    wif: 0x2e,\r\n  }\r\n}\r\n\r\n\r\nconst hasAdminFee = (\r\n  config\r\n    && config.opts\r\n    && config.opts.fee\r\n    && config.opts.fee.ghost\r\n    && config.opts.fee.ghost.fee\r\n) ? config.opts.fee.ghost : false\r\n\r\nconst network = process.env.MAINNET\r\n  ? networks.mainnet\r\n  : networks.testnet\r\n\r\nconst DUST = 546 // description in ./btc.ts\r\n\r\n// getByteCount({'MULTISIG-P2SH:2-4':45},{'P2PKH':1}) Means \"45 inputs of P2SH Multisig and 1 output of P2PKH\"\r\n// getByteCount({'P2PKH':1,'MULTISIG-P2SH:2-3':2},{'P2PKH':2}) means \"1 P2PKH input and 2 Multisig P2SH (2 of 3) inputs along with 2 P2PKH outputs\"\r\nconst getByteCount = (inputs, outputs) => {\r\n  let totalWeight = 0\r\n  let hasWitness = false\r\n  let inputCount = 0\r\n  let outputCount = 0\r\n  // assumes compressed pubkeys in all cases.\r\n  const types = {\r\n    'inputs': {\r\n      'MULTISIG-P2SH': 49 * 4,\r\n      'MULTISIG-P2WSH': 6 + (41 * 4),\r\n      'MULTISIG-P2SH-P2WSH': 6 + (76 * 4),\r\n      'P2PKH': 148 * 4,\r\n      'P2WPKH': 108 + (41 * 4),\r\n      'P2SH-P2WPKH': 108 + (64 * 4),\r\n    },\r\n    'outputs': {\r\n      'P2SH': 32 * 4,\r\n      'P2PKH': 34 * 4,\r\n      'P2WPKH': 31 * 4,\r\n      'P2WSH': 43 * 4,\r\n    },\r\n  }\r\n\r\n  const checkUInt53 = (n) => {\r\n    if (n < 0 || n > Number.MAX_SAFE_INTEGER || n % 1 !== 0) throw new RangeError('value out of range')\r\n  }\r\n\r\n  const varIntLength = (number) => {\r\n    checkUInt53(number)\r\n\r\n    return (\r\n      number < 0xfd ? 1\r\n        : number <= 0xffff ? 3\r\n          : number <= 0xffffffff ? 5\r\n            : 9\r\n    )\r\n  }\r\n\r\n  Object.keys(inputs).forEach((key) => {\r\n    checkUInt53(inputs[key])\r\n    if (key.slice(0, 8) === 'MULTISIG') {\r\n      // ex. \"MULTISIG-P2SH:2-3\" would mean 2 of 3 P2SH MULTISIG\r\n      const keyParts = key.split(':')\r\n      if (keyParts.length !== 2) throw new Error(`invalid input: ${key}`)\r\n      const newKey = keyParts[0]\r\n      const mAndN = keyParts[1].split('-').map((item) => parseInt(item))\r\n\r\n      totalWeight += types.inputs[newKey] * inputs[key]\r\n      const multiplyer = (newKey === 'MULTISIG-P2SH') ? 4 : 1\r\n      totalWeight += ((73 * mAndN[0]) + (34 * mAndN[1])) * multiplyer * inputs[key]\r\n    } else {\r\n      totalWeight += types.inputs[key] * inputs[key]\r\n    }\r\n    inputCount += inputs[key]\r\n    if (key.indexOf('W') >= 0) hasWitness = true\r\n  })\r\n\r\n  Object.keys(outputs).forEach((key) => {\r\n    checkUInt53(outputs[key])\r\n    totalWeight += types.outputs[key] * outputs[key]\r\n    outputCount += outputs[key]\r\n  })\r\n\r\n  if (hasWitness) totalWeight += 2\r\n\r\n  totalWeight += 8 * 4\r\n  totalWeight += varIntLength(inputCount) * 4\r\n  totalWeight += varIntLength(outputCount) * 4\r\n\r\n  return Math.ceil(totalWeight / 4)\r\n}\r\n\r\n//@\r\nconst calculateTxSize = async ({ speed, unspents, address, txOut = 2, method = 'send', fixed } = {}) => {\r\n  const defaultTxSize = constants.defaultFeeRates.ghost.size[method]\r\n\r\n  if (fixed) {\r\n    return defaultTxSize\r\n  }\r\n\r\n  unspents = unspents || await actions.ghost.fetchUnspents(address)\r\n\r\n\r\n  const txIn = unspents.length\r\n  const txSize = txIn > 0\r\n    ? txIn * 146 + txOut * 33 + (15 + txIn - txOut)\r\n    : defaultTxSize\r\n\r\n  if (method === 'send_multisig') {\r\n    const msuSize = getByteCount(\r\n      { 'MULTISIG-P2SH-P2WSH:2-2': 1 },\r\n      { 'P2PKH': (hasAdminFee) ? 3 : 2 }\r\n    )\r\n    const msutxSize = txIn * msuSize + txOut * 33 + (15 + txIn - txOut)\r\n\r\n    return msutxSize\r\n  }\r\n\r\n  if (method === 'send_2fa') {\r\n    const msSize = getByteCount(\r\n      { 'MULTISIG-P2SH-P2WSH:2-3': 1 },\r\n      { 'P2PKH': (hasAdminFee) ? 3 : 2 }\r\n    )\r\n    const mstxSize = txIn * msSize + txOut * 33 + (15 + txIn - txOut)\r\n\r\n    return mstxSize\r\n  }\r\n\r\n  return txSize\r\n}\r\n\r\ntype EstimateFeeValueOptions = {\r\n  method?: string\r\n  speed: 'fast' | 'normal' | 'slow'\r\n  feeRate?: number\r\n  inSatoshis?: boolean\r\n  address?: string\r\n  txSize?: number\r\n  fixed?: string\r\n}\r\n\r\nconst estimateFeeValue = async (options: EstimateFeeValueOptions) => {\r\n  let { feeRate, inSatoshis, speed, address, txSize, fixed, method } = options\r\n  const {\r\n    user: {\r\n      ghostData,\r\n      ghostMultisigSMSData,\r\n      ghostMultisigUserData,\r\n    },\r\n  } = getState()\r\n\r\n  let txOut = 2\r\n\r\n  if (hasAdminFee) txOut = 3\r\n\r\n  if (!address) {\r\n    address = ghostData.address\r\n    //@\r\n    if (method === 'send_2fa') address = ghostMultisigSMS\r\n    if (method === 'send_multisig') address = ghostMultisigUserData.address\r\n  }\r\n\r\n  //@\r\n  txSize = txSize || await calculateTxSize({ address, speed, fixed, method, txOut })\r\n  feeRate = feeRate || await estimateFeeRate({ speed })\r\n\r\n  const calculatedFeeValue = BigNumber.maximum(\r\n    DUST,\r\n    new BigNumber(feeRate)\r\n      .multipliedBy(txSize)\r\n      .div(1024) // divide by one kilobyte\r\n      .dp(0, BigNumber.ROUND_HALF_EVEN),\r\n  )\r\n\r\n  const CUSTOM_SATOSHI = 20\r\n  calculatedFeeValue.plus(CUSTOM_SATOSHI) // just wanted to add\r\n\r\n  const finalFeeValue = inSatoshis\r\n    ? calculatedFeeValue.toString()\r\n    : calculatedFeeValue.multipliedBy(1e-8).toString()\r\n\r\n  console.log(`Ghost withdraw fee speed(${speed}) method (${method}) ${finalFeeValue}`)\r\n  return finalFeeValue\r\n}\r\n\r\nconst estimateFeeRate = async ({ speed = 'fast' } = {}) => {\r\n  const link = config.feeRates.ghost\r\n  const defaultRate = constants.defaultFeeRates.ghost.rate\r\n\r\n  if (!link) {\r\n    return defaultRate[speed]\r\n  }\r\n\r\n  let apiResult\r\n\r\n  try {\r\n    apiResult = await request.get(link, { cacheResponse: 60000 })\r\n  } catch (err) {\r\n    console.error(`EstimateFeeRate: ${err.message}`)\r\n    return defaultRate[speed]\r\n  }\r\n\r\n  const apiSpeeds = {\r\n    slow: 'low_fee_per_kb',\r\n    normal: 'medium_fee_per_kb',\r\n    fast: 'high_fee_per_kb',\r\n  }\r\n\r\n  const apiSpeed = apiSpeeds[speed] || apiSpeeds.normal\r\n  const apiRate = new BigNumber(apiResult[apiSpeed])\r\n\r\n  return apiRate.isGreaterThanOrEqualTo(DUST)\r\n    ? apiRate.toString()\r\n    : defaultRate[speed]\r\n}\r\n\r\nexport default {\r\n  calculateTxSize,\r\n  estimateFeeValue,\r\n  estimateFeeRate,\r\n  network,\r\n  networks,\r\n}\r\n"]}]}