{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\redux\\actions\\multisigTx.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\redux\\actions\\multisigTx.ts","mtime":1614852484411},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2RlZmluZVByb3BlcnR5IjsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCi8vIEB0cy1ub2NoZWNrCmltcG9ydCB7IGFwaUxvb3BlciB9IGZyb20gJ2hlbHBlcnMnOwppbXBvcnQgYWN0aW9ucyBmcm9tICdyZWR1eC9hY3Rpb25zJzsKaW1wb3J0IHsgZ2V0U3RhdGUgfSBmcm9tICdyZWR1eC9jb3JlJzsKaW1wb3J0IHJlZHVjZXJzIGZyb20gJ3JlZHV4L2NvcmUvcmVkdWNlcnMnOwoKdmFyIGJyb2FkY2FzdCA9IGZ1bmN0aW9uIGJyb2FkY2FzdChfcmVmKSB7CiAgdmFyIHNlbmRlciA9IF9yZWYuc2VuZGVyLAogICAgICBkZXN0aW5hdGlvbiA9IF9yZWYuZGVzdGluYXRpb24sCiAgICAgIGFtb3VudCA9IF9yZWYuYW1vdW50LAogICAgICBmZWUgPSBfcmVmLmZlZSwKICAgICAgcmF3VHggPSBfcmVmLnJhd1R4LAogICAgICBpbnZvaWNlID0gX3JlZi5pbnZvaWNlOwoKICB2YXIgX2dldFN0YXRlID0gZ2V0U3RhdGUoKSwKICAgICAgYnRjRGF0YSA9IF9nZXRTdGF0ZS51c2VyLmJ0Y0RhdGE7CgogIHZhciBzZW5kZXJXYWxsZXQgPSBhY3Rpb25zLmJ0Y211bHRpc2lnLmFkZHJlc3NUb1dhbGxldChzZW5kZXIpOwoKICBpZiAoc2VuZGVyV2FsbGV0KSB7CiAgICB2YXIgcmVxdWVzdERhdGEgPSB7CiAgICAgIGFkZHJlc3M6IGJ0Y0RhdGEuYWRkcmVzcywKICAgICAgcHVia2V5OiBidGNEYXRhLnB1YmxpY0tleS50b1N0cmluZygnaGV4JyksCiAgICAgIG1haW5uZXQ6IHByb2Nlc3MuZW52Lk1BSU5ORVQgPyAnMScgOiAnMCcsCiAgICAgIHNlbmRlcjogc2VuZGVyLAogICAgICBkZXN0aW5hdGlvbjogZGVzdGluYXRpb24sCiAgICAgIGFtb3VudDogYW1vdW50LAogICAgICBmZWU6IGZlZSwKICAgICAgcmF3VHg6IHJhd1R4LAogICAgICBpbnZvaWNlOiBpbnZvaWNlLAogICAgICBrZXlzOiBzZW5kZXJXYWxsZXQucHVibGljS2V5cy5tYXAoZnVuY3Rpb24gKGtleSkgewogICAgICAgIHJldHVybiBrZXkudG9TdHJpbmcoJ2hleCcpOwogICAgICB9KQogICAgfTsKICAgIHJldHVybiBhcGlMb29wZXIucG9zdCgnbXVsdGlzaWcnLCAiL2Jyb2FkY2FzdC8iLCB7CiAgICAgIGJvZHk6IHJlcXVlc3REYXRhCiAgICB9KS50aGVuKGZ1bmN0aW9uIChfcmVmMikgewogICAgICB2YXIgdHhJZCA9IF9yZWYyLnR4SWQ7CiAgICAgIHJldHVybiB0eElkOwogICAgfSk7CiAgfQoKICBjb25zb2xlLmVycm9yKCJCdGMtTXVsdGlzaWcuIENhbnQgZGV0ZWN0IHNlbmRlciB3YWxsZXQiKTsKICByZXR1cm4gZmFsc2U7Cn07Cgp2YXIgZmV0Y2hUeCA9IGZ1bmN0aW9uIGZldGNoVHgodHhJZCkgewogIHJldHVybiBhcGlMb29wZXIuZ2V0KCdtdWx0aXNpZycsICIvdHgvIi5jb25jYXQodHhJZCkpLnRoZW4oZnVuY3Rpb24gKHR4RGF0YSkgewogICAgcmV0dXJuIHR4RGF0YTsKICB9KTsKfTsKCnZhciBjb25maXJtVHggPSBmdW5jdGlvbiBjb25maXJtVHgoYWRkcmVzcywgbXNUeElkLCBzaWduZWRUeCwgdHhJZCkgewogIHZhciBzZW5kZXJXYWxsZXQgPSBhY3Rpb25zLmJ0Y211bHRpc2lnLmFkZHJlc3NUb1dhbGxldChhZGRyZXNzKTsKCiAgaWYgKHNlbmRlcldhbGxldCkgewogICAgcmV0dXJuIGFwaUxvb3Blci5wb3N0KCdtdWx0aXNpZycsICIvY29uZmlybXR4LyIsIHsKICAgICAgYm9keTogewogICAgICAgIG1zVHhJZDogbXNUeElkLAogICAgICAgIGtleXM6IHNlbmRlcldhbGxldC5wdWJsaWNLZXlzLm1hcChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICByZXR1cm4ga2V5LnRvU3RyaW5nKCdoZXgnKTsKICAgICAgICB9KSwKICAgICAgICBzaWduZWRUeDogc2lnbmVkVHgsCiAgICAgICAgdHhJZDogdHhJZAogICAgICB9CiAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBkYXRhOwogICAgfSk7CiAgfQp9OwoKdmFyIHJlamVjdFR4ID0gZnVuY3Rpb24gcmVqZWN0VHgoYWRkcmVzcywgdHhJZCkgewogIHZhciBzZW5kZXJXYWxsZXQgPSBhY3Rpb25zLmJ0Y211bHRpc2lnLmFkZHJlc3NUb1dhbGxldChhZGRyZXNzKTsKCiAgaWYgKHNlbmRlcldhbGxldCkgewogICAgcmV0dXJuIGFwaUxvb3Blci5wb3N0KCdtdWx0aXNpZycsICIvcmVqZWN0dHgvIiwgewogICAgICBib2R5OiB7CiAgICAgICAgdHhJZDogdHhJZCwKICAgICAgICBrZXlzOiBzZW5kZXJXYWxsZXQucHVibGljS2V5cy5tYXAoZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgcmV0dXJuIGtleS50b1N0cmluZygnaGV4Jyk7CiAgICAgICAgfSkKICAgICAgfQogICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICByZXR1cm4gZGF0YTsKICAgIH0pOwogIH0KfTsKCnZhciBmZXRjaFJhd1R4ID0gZnVuY3Rpb24gZmV0Y2hSYXdUeChhZGRyZXNzLCB0eElkKSB7CiAgdmFyIHNlbmRlcldhbGxldCA9IGFjdGlvbnMuYnRjbXVsdGlzaWcuYWRkcmVzc1RvV2FsbGV0KGFkZHJlc3MpOwoKICBpZiAoc2VuZGVyV2FsbGV0KSB7CiAgICByZXR1cm4gYXBpTG9vcGVyLnBvc3QoJ211bHRpc2lnJywgIi9yYXd0eC8iLCB7CiAgICAgIGJvZHk6IHsKICAgICAgICB0eElkOiB0eElkLAogICAgICAgIGtleXM6IHNlbmRlcldhbGxldC5wdWJsaWNLZXlzLm1hcChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICByZXR1cm4ga2V5LnRvU3RyaW5nKCdoZXgnKTsKICAgICAgICB9KQogICAgICB9CiAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIHJldHVybiBkYXRhOwogICAgfSk7CiAgfQp9OwoKdmFyIGZldGNoID0gZnVuY3Rpb24gZmV0Y2goYWRkcmVzcykgewogIHZhciBfZ2V0U3RhdGUyID0gZ2V0U3RhdGUoKSwKICAgICAgYnRjRGF0YSA9IF9nZXRTdGF0ZTIudXNlci5idGNEYXRhOwoKICB2YXIgaG9sZGVyS2V5ID0gYnRjRGF0YS5wdWJsaWNLZXkudG9TdHJpbmcoJ2hleCcpOwogIHZhciBmaXJzdFBlbmRpbmcgPSBmYWxzZTsKICB2YXIgcGVuZ2luZ0NvdW50ID0gMDsKICByZXR1cm4gYXBpTG9vcGVyLnBvc3QoJ211bHRpc2lnJywgIi90eHMvIiwgewogICAgYm9keTogewogICAgICBhZGRyZXNzOiBhZGRyZXNzCiAgICB9LAogICAgcXVlcnk6ICdtdWx0aXNpZ1R4JwogIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgaWYgKHJlcyAmJiByZXMuYW5zd2VyKSB7CiAgICAgIHZhciBzZW5kZXJXYWxsZXQgPSBhY3Rpb25zLmJ0Y211bHRpc2lnLmFkZHJlc3NUb1dhbGxldChhZGRyZXNzKTsKICAgICAgdmFyIHRyYW5zYWN0aW9ucyA9IHJlcy5pdGVtcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICB2YXIgc3RhdHVzID0gaXRlbS5zdGF0dXM7CgogICAgICAgIHN3aXRjaCAoc3RhdHVzKSB7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIHN0YXR1cyA9ICdwZW5kaW5nJzsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBzdGF0dXMgPSAncmVhZHknOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIHN0YXR1cyA9ICdyZWplY3QnOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHN0YXR1cyA9ICdjYW5jZWwnOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9IC8vIEBUb0RvIC0gKGRyYWZ0KSB1c2UgYXBpIHJlcXVlc3QgZm9yIGZldGNoIHN0YXR1cyBvZiBhZGRyZXNzIGxpc3QKCgogICAgICAgIGlmIChzdGF0dXMgPT09ICdwZW5kaW5nJyAmJiBob2xkZXJLZXkgIT09IGl0ZW0uaG9sZGVyKSB7CiAgICAgICAgICAvL0AKICAgICAgICAgIGZpcnN0UGVuZGluZyA9IGZpcnN0UGVuZGluZyB8fCB7CiAgICAgICAgICAgIGFkZHJlc3M6IGFkZHJlc3MsCiAgICAgICAgICAgIGl0ZW06IGl0ZW0KICAgICAgICAgIH07CiAgICAgICAgICBwZW5naW5nQ291bnQrKzsKICAgICAgICB9CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0eXBlOiAnYnRjJywKICAgICAgICAgIGhhc2g6IGl0ZW0udW5pcWhhc2gsCiAgICAgICAgICBjYW5FZGl0OiBmYWxzZSwKICAgICAgICAgIHR4VHlwZTogJ0NPTkZJUk0nLAogICAgICAgICAgY29uZmlybVR4OiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGl0ZW0pLCB7fSwgewogICAgICAgICAgICBzdGF0dXM6IHN0YXR1cywKICAgICAgICAgICAgaXNIb2xkZXI6IGhvbGRlcktleSA9PT0gaXRlbS5ob2xkZXIKICAgICAgICAgIH0pLAogICAgICAgICAgY29uZmlybWF0aW9uczogMCwKICAgICAgICAgIHZhbHVlOiBpdGVtLmFtb3VudCwKICAgICAgICAgIGRhdGU6IGl0ZW0udXR4ICogMTAwMCwKICAgICAgICAgIGRpcmVjdGlvbjogJ291dCcKICAgICAgICB9OwogICAgICB9KTsgLy8gQFRvRG8gLSAoZHJhZnQpIHVzZSBhcGkgcmVxdWVzdCBmb3IgZmV0Y2ggc3RhdHVzIG9mIGFkZHJlc3MgbGlzdAoKICAgICAgcmVkdWNlcnMudXNlci51cGRhdGVNdWx0aXNpZ1N0YXR1cyh7CiAgICAgICAgYWRkcmVzczogYWRkcmVzcywKICAgICAgICBsYXN0OiBmaXJzdFBlbmRpbmcsCiAgICAgICAgdG90YWw6IHBlbmdpbmdDb3VudAogICAgICB9KTsKICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uczsKICAgIH0KCiAgICByZXR1cm4gW107CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGUpIHsKICAgIHJldHVybiBbXTsKICB9KTsKfTsKCnZhciBnb1RvTGFzdFdhbGxldCA9IGZ1bmN0aW9uIGdvVG9MYXN0V2FsbGV0KCkgewogIHZhciBfZ2V0U3RhdGUzID0gZ2V0U3RhdGUoKSwKICAgICAgbXVsdGlzaWdTdGF0dXMgPSBfZ2V0U3RhdGUzLnVzZXIubXVsdGlzaWdTdGF0dXM7CgogIHZhciB3YWxsZXRzV2l0aFJlcXVlc3RzID0gT2JqZWN0LmtleXMobXVsdGlzaWdTdGF0dXMpLm1hcChmdW5jdGlvbiAod2FsbGV0QWRkcmVzcykgewogICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoewogICAgICB3YWxsZXRBZGRyZXNzOiB3YWxsZXRBZGRyZXNzCiAgICB9LCBtdWx0aXNpZ1N0YXR1c1t3YWxsZXRBZGRyZXNzXSk7CiAgfSkuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICB2YXIgY291bnQgPSBpdGVtLmNvdW50LAogICAgICAgIHBlbmRpbmcgPSBpdGVtLnBlbmRpbmc7CiAgICByZXR1cm4gY291bnQ7CiAgfSk7CgogIGlmICh3YWxsZXRzV2l0aFJlcXVlc3RzLmxlbmd0aCkgewogICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSAiL2J0Yy8iLmNvbmNhdCh3YWxsZXRzV2l0aFJlcXVlc3RzWzBdLndhbGxldEFkZHJlc3MpOwogIH0KfTsKCmV4cG9ydCBkZWZhdWx0IHsKICBicm9hZGNhc3Q6IGJyb2FkY2FzdCwKICBmZXRjaDogZmV0Y2gsCiAgZmV0Y2hUeDogZmV0Y2hUeCwKICBmZXRjaFJhd1R4OiBmZXRjaFJhd1R4LAogIGNvbmZpcm1UeDogY29uZmlybVR4LAogIHJlamVjdFR4OiByZWplY3RUeCwKICBnb1RvTGFzdFdhbGxldDogZ29Ub0xhc3RXYWxsZXQKfTs="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/redux/actions/multisigTx.ts"],"names":["apiLooper","actions","getState","reducers","broadcast","sender","destination","amount","fee","rawTx","invoice","btcData","user","senderWallet","btcmultisig","addressToWallet","requestData","address","pubkey","publicKey","toString","mainnet","process","env","MAINNET","keys","publicKeys","map","key","post","body","then","txId","console","error","fetchTx","get","txData","confirmTx","msTxId","signedTx","data","rejectTx","fetchRawTx","fetch","holderKey","firstPending","pengingCount","query","res","answer","transactions","items","item","status","holder","type","hash","uniqhash","canEdit","txType","isHolder","confirmations","value","date","utx","direction","updateMultisigStatus","last","total","e","goToLastWallet","multisigStatus","walletsWithRequests","Object","walletAddress","filter","count","pending","length","window","location"],"mappings":";;;;;;AAAA;AACA,SAASA,SAAT,QAAsD,SAAtD;AAEA,OAAOC,OAAP,MAAoB,eAApB;AACA,SAASC,QAAT,QAAyB,YAAzB;AACA,OAAOC,QAAP,MAAqB,qBAArB;;AAGA,IAAMC,SAAS,GAAG,SAAZA,SAAY,OAA0D;AAAA,MAAvDC,MAAuD,QAAvDA,MAAuD;AAAA,MAA/CC,WAA+C,QAA/CA,WAA+C;AAAA,MAAlCC,MAAkC,QAAlCA,MAAkC;AAAA,MAA1BC,GAA0B,QAA1BA,GAA0B;AAAA,MAArBC,KAAqB,QAArBA,KAAqB;AAAA,MAAdC,OAAc,QAAdA,OAAc;;AAAA,kBAC5CR,QAAQ,EADoC;AAAA,MAC1DS,OAD0D,aAClEC,IADkE,CAC1DD,OAD0D;;AAG1E,MAAME,YAAY,GAAGZ,OAAO,CAACa,WAAR,CAAoBC,eAApB,CAAoCV,MAApC,CAArB;;AAEA,MAAIQ,YAAJ,EAAkB;AAChB,QAAMG,WAAW,GAAG;AAClBC,MAAAA,OAAO,EAAEN,OAAO,CAACM,OADC;AAElBC,MAAAA,MAAM,EAAEP,OAAO,CAACQ,SAAR,CAAkBC,QAAlB,CAA2B,KAA3B,CAFU;AAGlBC,MAAAA,OAAO,EAAGC,OAAO,CAACC,GAAR,CAAYC,OAAb,GAAwB,GAAxB,GAA8B,GAHrB;AAKlBnB,MAAAA,MAAM,EAANA,MALkB;AAMlBC,MAAAA,WAAW,EAAXA,WANkB;AAOlBC,MAAAA,MAAM,EAANA,MAPkB;AAQlBC,MAAAA,GAAG,EAAHA,GARkB;AASlBC,MAAAA,KAAK,EAALA,KATkB;AAUlBC,MAAAA,OAAO,EAAPA,OAVkB;AAYlBe,MAAAA,IAAI,EAAEZ,YAAY,CAACa,UAAb,CAAwBC,GAAxB,CAA4B,UAACC,GAAD;AAAA,eAASA,GAAG,CAACR,QAAJ,CAAa,KAAb,CAAT;AAAA,OAA5B;AAZY,KAApB;AAeA,WAAOpB,SAAS,CAAC6B,IAAV,CAAe,UAAf,iBAA0C;AAC/CC,MAAAA,IAAI,EAAEd;AADyC,KAA1C,EAEJe,IAFI,CAEC;AAAA,UAAGC,IAAH,SAAGA,IAAH;AAAA,aAAcA,IAAd;AAAA,KAFD,CAAP;AAGD;;AACDC,EAAAA,OAAO,CAACC,KAAR;AACA,SAAO,KAAP;AAED,CA5BD;;AA8BA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACH,IAAD;AAAA,SAAUhC,SAAS,CAChCoC,GADuB,CACnB,UADmB,gBACAJ,IADA,GAEvBD,IAFuB,CAElB,UAACM,MAAD;AAAA,WAAYA,MAAZ;AAAA,GAFkB,CAAV;AAAA,CAAhB;;AAIA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACrB,OAAD,EAAUsB,MAAV,EAAkBC,QAAlB,EAA4BR,IAA5B,EAAqC;AACrD,MAAMnB,YAAY,GAAGZ,OAAO,CAACa,WAAR,CAAoBC,eAApB,CAAoCE,OAApC,CAArB;;AAEA,MAAIJ,YAAJ,EAAkB;AAChB,WAAOb,SAAS,CAAC6B,IAAV,CAAe,UAAf,iBAA0C;AAC/CC,MAAAA,IAAI,EAAE;AACJS,QAAAA,MAAM,EAANA,MADI;AAEJd,QAAAA,IAAI,EAAEZ,YAAY,CAACa,UAAb,CAAwBC,GAAxB,CAA4B,UAACC,GAAD;AAAA,iBAASA,GAAG,CAACR,QAAJ,CAAa,KAAb,CAAT;AAAA,SAA5B,CAFF;AAGJoB,QAAAA,QAAQ,EAARA,QAHI;AAIJR,QAAAA,IAAI,EAAJA;AAJI;AADyC,KAA1C,EAOJD,IAPI,CAOC,UAACU,IAAD;AAAA,aAAUA,IAAV;AAAA,KAPD,CAAP;AAQD;AACF,CAbD;;AAeA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACzB,OAAD,EAAUe,IAAV,EAAmB;AAClC,MAAMnB,YAAY,GAAGZ,OAAO,CAACa,WAAR,CAAoBC,eAApB,CAAoCE,OAApC,CAArB;;AAEA,MAAIJ,YAAJ,EAAkB;AAChB,WAAOb,SAAS,CAAC6B,IAAV,CAAe,UAAf,gBAAyC;AAC9CC,MAAAA,IAAI,EAAE;AACJE,QAAAA,IAAI,EAAJA,IADI;AAEJP,QAAAA,IAAI,EAAEZ,YAAY,CAACa,UAAb,CAAwBC,GAAxB,CAA4B,UAACC,GAAD;AAAA,iBAASA,GAAG,CAACR,QAAJ,CAAa,KAAb,CAAT;AAAA,SAA5B;AAFF;AADwC,KAAzC,EAKJW,IALI,CAKC,UAACU,IAAD;AAAA,aAAUA,IAAV;AAAA,KALD,CAAP;AAMD;AACF,CAXD;;AAaA,IAAME,UAAU,GAAG,SAAbA,UAAa,CAAC1B,OAAD,EAAUe,IAAV,EAAmB;AACpC,MAAMnB,YAAY,GAAGZ,OAAO,CAACa,WAAR,CAAoBC,eAApB,CAAoCE,OAApC,CAArB;;AAEA,MAAIJ,YAAJ,EAAkB;AAChB,WAAOb,SAAS,CAAC6B,IAAV,CAAe,UAAf,aAAsC;AAC3CC,MAAAA,IAAI,EAAE;AACJE,QAAAA,IAAI,EAAJA,IADI;AAEJP,QAAAA,IAAI,EAAEZ,YAAY,CAACa,UAAb,CAAwBC,GAAxB,CAA4B,UAACC,GAAD;AAAA,iBAASA,GAAG,CAACR,QAAJ,CAAa,KAAb,CAAT;AAAA,SAA5B;AAFF;AADqC,KAAtC,EAKJW,IALI,CAKC,UAACU,IAAD;AAAA,aAAUA,IAAV;AAAA,KALD,CAAP;AAMD;AACF,CAXD;;AAaA,IAAMG,KAAK,GAAG,SAARA,KAAQ,CAAC3B,OAAD,EAAa;AAAA,mBACKf,QAAQ,EADb;AAAA,MACTS,OADS,cACjBC,IADiB,CACTD,OADS;;AAEzB,MAAMkC,SAAS,GAAGlC,OAAO,CAACQ,SAAR,CAAkBC,QAAlB,CAA2B,KAA3B,CAAlB;AAEA,MAAI0B,YAAY,GAAG,KAAnB;AACA,MAAIC,YAAY,GAAG,CAAnB;AAEA,SAAO/C,SAAS,CAAC6B,IAAV,CAAe,UAAf,WAAoC;AACzCC,IAAAA,IAAI,EAAE;AACJb,MAAAA,OAAO,EAAPA;AADI,KADmC;AAIzC+B,IAAAA,KAAK,EAAE;AAJkC,GAApC,EAKJjB,IALI,CAKC,UAACkB,GAAD,EAAc;AACpB,QAAIA,GAAG,IACFA,GAAG,CAACC,MADT,EAEE;AACA,UAAMrC,YAAY,GAAGZ,OAAO,CAACa,WAAR,CAAoBC,eAApB,CAAoCE,OAApC,CAArB;AAEA,UAAMkC,YAAY,GAAGF,GAAG,CAACG,KAAJ,CAAUzB,GAAV,CAAc,UAAC0B,IAAD,EAAU;AAAA,YACrCC,MADqC,GAC1BD,IAD0B,CACrCC,MADqC;;AAG3C,gBAAQA,MAAR;AACE,eAAK,CAAL;AAAQA,YAAAA,MAAM,GAAG,SAAT;AACN;;AACF,eAAK,CAAL;AAAQA,YAAAA,MAAM,GAAG,OAAT;AACN;;AACF,eAAK,CAAL;AAAQA,YAAAA,MAAM,GAAG,QAAT;AACN;;AACF,eAAK,CAAL;AAAQA,YAAAA,MAAM,GAAG,QAAT;AACN;AARJ,SAH2C,CAc3C;;;AACA,YAAIA,MAAM,KAAK,SAAX,IAAwBT,SAAS,KAAKQ,IAAI,CAACE,MAA/C,EAAuD;AACrD;AACAT,UAAAA,YAAY,GAAGA,YAAY,IAAI;AAC7B7B,YAAAA,OAAO,EAAPA,OAD6B;AAE7BoC,YAAAA,IAAI,EAAJA;AAF6B,WAA/B;AAIAN,UAAAA,YAAY;AACb;;AAED,eAAQ;AACNS,UAAAA,IAAI,EAAE,KADA;AAENC,UAAAA,IAAI,EAAEJ,IAAI,CAACK,QAFL;AAGNC,UAAAA,OAAO,EAAE,KAHH;AAINC,UAAAA,MAAM,EAAE,SAJF;AAKNtB,UAAAA,SAAS,kCACJe,IADI;AAEPC,YAAAA,MAAM,EAANA,MAFO;AAGPO,YAAAA,QAAQ,EAAGhB,SAAS,KAAKQ,IAAI,CAACE;AAHvB,YALH;AAUNO,UAAAA,aAAa,EAAE,CAVT;AAWNC,UAAAA,KAAK,EAAEV,IAAI,CAAC9C,MAXN;AAYNyD,UAAAA,IAAI,EAAEX,IAAI,CAACY,GAAL,GAAW,IAZX;AAaNC,UAAAA,SAAS,EAAE;AAbL,SAAR;AAeD,OAvCoB,CAArB,CAHA,CA4CA;;AACA/D,MAAAA,QAAQ,CAACS,IAAT,CAAcuD,oBAAd,CAAmC;AACjClD,QAAAA,OAAO,EAAPA,OADiC;AAEjCmD,QAAAA,IAAI,EAAEtB,YAF2B;AAGjCuB,QAAAA,KAAK,EAAEtB;AAH0B,OAAnC;AAKA,aAAOI,YAAP;AACD;;AAAC,WAAO,EAAP;AACH,GA5DM,WA4DE,UAACmB,CAAD;AAAA,WAAO,EAAP;AAAA,GA5DF,CAAP;AA6DD,CApED;;AAsEA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AAAA,mBAKvBrE,QAAQ,EALe;AAAA,MAGvBsE,cAHuB,cAEzB5D,IAFyB,CAGvB4D,cAHuB;;AAO3B,MAAMC,mBAAmB,GAAGC,MAAM,CAACjD,IAAP,CAAY+C,cAAZ,EAA4B7C,GAA5B,CAAgC,UAACgD,aAAD;AAAA;AAC1DA,MAAAA,aAAa,EAAbA;AAD0D,OAEvDH,cAAc,CAACG,aAAD,CAFyC;AAAA,GAAhC,EAGxBC,MAHwB,CAGjB,UAACvB,IAAD,EAAU;AAAA,QAEjBwB,KAFiB,GAIfxB,IAJe,CAEjBwB,KAFiB;AAAA,QAGjBC,OAHiB,GAIfzB,IAJe,CAGjByB,OAHiB;AAMnB,WAAOD,KAAP;AACD,GAV2B,CAA5B;;AAYA,MAAIJ,mBAAmB,CAACM,MAAxB,EAAgC;AAC9BC,IAAAA,MAAM,CAACC,QAAP,CAAgBxB,IAAhB,kBAA+BgB,mBAAmB,CAAC,CAAD,CAAnB,CAAuBE,aAAtD;AACD;AACF,CAtBD;;AAyBA,eAAe;AACbvE,EAAAA,SAAS,EAATA,SADa;AAEbwC,EAAAA,KAAK,EAALA,KAFa;AAIbT,EAAAA,OAAO,EAAPA,OAJa;AAKbQ,EAAAA,UAAU,EAAVA,UALa;AAMbL,EAAAA,SAAS,EAATA,SANa;AAObI,EAAAA,QAAQ,EAARA,QAPa;AASb6B,EAAAA,cAAc,EAAdA;AATa,CAAf","sourcesContent":["// @ts-nocheck\r\nimport { apiLooper, constants, api, redirectTo } from 'helpers'\r\nimport config from 'app-config'\r\nimport actions from 'redux/actions'\r\nimport { getState } from 'redux/core'\r\nimport reducers from 'redux/core/reducers'\r\n\r\n\r\nconst broadcast = ({ sender, destination, amount, fee, rawTx, invoice }) => {\r\n  const { user: { btcData } } = getState()\r\n\r\n  const senderWallet = actions.btcmultisig.addressToWallet(sender)\r\n\r\n  if (senderWallet) {\r\n    const requestData = {\r\n      address: btcData.address,\r\n      pubkey: btcData.publicKey.toString('hex'),\r\n      mainnet: (process.env.MAINNET) ? '1' : '0',\r\n\r\n      sender,\r\n      destination,\r\n      amount,\r\n      fee,\r\n      rawTx,\r\n      invoice,\r\n\r\n      keys: senderWallet.publicKeys.map((key) => key.toString('hex')),\r\n    }\r\n\r\n    return apiLooper.post('multisig', `/broadcast/`, {\r\n      body: requestData,\r\n    }).then(({ txId }) => txId)\r\n  }\r\n  console.error(`Btc-Multisig. Cant detect sender wallet`)\r\n  return false\r\n\r\n}\r\n\r\nconst fetchTx = (txId) => apiLooper\r\n  .get('multisig', `/tx/${txId}`)\r\n  .then((txData) => txData)\r\n\r\nconst confirmTx = (address, msTxId, signedTx, txId) => {\r\n  const senderWallet = actions.btcmultisig.addressToWallet(address)\r\n\r\n  if (senderWallet) {\r\n    return apiLooper.post('multisig', `/confirmtx/`, {\r\n      body: {\r\n        msTxId,\r\n        keys: senderWallet.publicKeys.map((key) => key.toString('hex')),\r\n        signedTx,\r\n        txId,\r\n      },\r\n    }).then((data) => data)\r\n  }\r\n}\r\n\r\nconst rejectTx = (address, txId) => {\r\n  const senderWallet = actions.btcmultisig.addressToWallet(address)\r\n\r\n  if (senderWallet) {\r\n    return apiLooper.post('multisig', `/rejecttx/`, {\r\n      body: {\r\n        txId,\r\n        keys: senderWallet.publicKeys.map((key) => key.toString('hex')),\r\n      },\r\n    }).then((data) => data)\r\n  }\r\n}\r\n\r\nconst fetchRawTx = (address, txId) => {\r\n  const senderWallet = actions.btcmultisig.addressToWallet(address)\r\n\r\n  if (senderWallet) {\r\n    return apiLooper.post('multisig', `/rawtx/`, {\r\n      body: {\r\n        txId,\r\n        keys: senderWallet.publicKeys.map((key) => key.toString('hex')),\r\n      },\r\n    }).then((data) => data)\r\n  }\r\n}\r\n\r\nconst fetch = (address) => {\r\n  const { user: { btcData } } = getState()\r\n  const holderKey = btcData.publicKey.toString('hex')\r\n\r\n  let firstPending = false\r\n  let pengingCount = 0\r\n\r\n  return apiLooper.post('multisig', `/txs/`, {\r\n    body: {\r\n      address,\r\n    },\r\n    query: 'multisigTx',\r\n  }).then((res: any) => {\r\n    if (res\r\n      && res.answer\r\n    ) {\r\n      const senderWallet = actions.btcmultisig.addressToWallet(address)\r\n\r\n      const transactions = res.items.map((item) => {\r\n        let { status } = item\r\n\r\n        switch (status) {\r\n          case 1: status = 'pending'\r\n            break\r\n          case 2: status = 'ready'\r\n            break\r\n          case 3: status = 'reject'\r\n            break\r\n          case 4: status = 'cancel'\r\n            break\r\n        }\r\n\r\n        // @ToDo - (draft) use api request for fetch status of address list\r\n        if (status === 'pending' && holderKey !== item.holder) {\r\n          //@\r\n          firstPending = firstPending || {\r\n            address,\r\n            item,\r\n          }\r\n          pengingCount++\r\n        }\r\n\r\n        return ({\r\n          type: 'btc',\r\n          hash: item.uniqhash,\r\n          canEdit: false,\r\n          txType: 'CONFIRM',\r\n          confirmTx: {\r\n            ...item,\r\n            status,\r\n            isHolder: (holderKey === item.holder),\r\n          },\r\n          confirmations: 0,\r\n          value: item.amount,\r\n          date: item.utx * 1000,\r\n          direction: 'out',\r\n        })\r\n      })\r\n\r\n      // @ToDo - (draft) use api request for fetch status of address list\r\n      reducers.user.updateMultisigStatus({\r\n        address,\r\n        last: firstPending,\r\n        total: pengingCount,\r\n      })\r\n      return transactions\r\n    } return []\r\n  }).catch((e) => [])\r\n}\r\n\r\nconst goToLastWallet = () => {\r\n  const {\r\n    user: {\r\n      multisigStatus,\r\n    },\r\n  } = getState()\r\n\r\n  const walletsWithRequests = Object.keys(multisigStatus).map((walletAddress) => ({\r\n    walletAddress,\r\n    ...multisigStatus[walletAddress],\r\n  })).filter((item) => {\r\n    const {\r\n      count,\r\n      pending,\r\n    } = item\r\n\r\n    return count\r\n  })\r\n\r\n  if (walletsWithRequests.length) {\r\n    window.location.hash = `/btc/${walletsWithRequests[0].walletAddress}`\r\n  }\r\n}\r\n\r\n\r\nexport default {\r\n  broadcast,\r\n  fetch,\r\n\r\n  fetchTx,\r\n  fetchRawTx,\r\n  confirmTx,\r\n  rejectTx,\r\n\r\n  goToLastWallet,\r\n}\r\n"]}]}