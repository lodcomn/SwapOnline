{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\common\\messaging\\pubsubRoom\\connection.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\common\\messaging\\pubsubRoom\\connection.ts","mtime":1614842913716},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyI7CmltcG9ydCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZiI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfYXN5bmNJdGVyYXRvciBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jSXRlcmF0b3IiOwoKdmFyIF9TeW1ib2wkYXN5bmNJdGVyYXRvcjsKCmZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG8sIGFsbG93QXJyYXlMaWtlKSB7IHZhciBpdDsgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICJ1bmRlZmluZWQiIHx8IG9bU3ltYm9sLml0ZXJhdG9yXSA9PSBudWxsKSB7IGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSB7IGlmIChpdCkgbyA9IGl0OyB2YXIgaSA9IDA7IHZhciBGID0gZnVuY3Rpb24gRigpIHt9OyByZXR1cm4geyBzOiBGLCBuOiBmdW5jdGlvbiBuKCkgeyBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHsgZG9uZTogdHJ1ZSB9OyByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IG9baSsrXSB9OyB9LCBlOiBmdW5jdGlvbiBlKF9lKSB7IHRocm93IF9lOyB9LCBmOiBGIH07IH0gdGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGl0ZXJhdGUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOyB9IHZhciBub3JtYWxDb21wbGV0aW9uID0gdHJ1ZSwgZGlkRXJyID0gZmFsc2UsIGVycjsgcmV0dXJuIHsgczogZnVuY3Rpb24gcygpIHsgaXQgPSBvW1N5bWJvbC5pdGVyYXRvcl0oKTsgfSwgbjogZnVuY3Rpb24gbigpIHsgdmFyIHN0ZXAgPSBpdC5uZXh0KCk7IG5vcm1hbENvbXBsZXRpb24gPSBzdGVwLmRvbmU7IHJldHVybiBzdGVwOyB9LCBlOiBmdW5jdGlvbiBlKF9lMikgeyBkaWRFcnIgPSB0cnVlOyBlcnIgPSBfZTI7IH0sIGY6IGZ1bmN0aW9uIGYoKSB7IHRyeSB7IGlmICghbm9ybWFsQ29tcGxldGlvbiAmJiBpdFsicmV0dXJuIl0gIT0gbnVsbCkgaXRbInJldHVybiJdKCk7IH0gZmluYWxseSB7IGlmIChkaWRFcnIpIHRocm93IGVycjsgfSB9IH07IH0KCmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHsgaWYgKCFvKSByZXR1cm47IGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB2YXIgbiA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKS5zbGljZSg4LCAtMSk7IGlmIChuID09PSAiT2JqZWN0IiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lOyBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOyBpZiAobiA9PT0gIkFyZ3VtZW50cyIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOyB9CgpmdW5jdGlvbiBfYXJyYXlMaWtlVG9BcnJheShhcnIsIGxlbikgeyBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBuZXcgQXJyYXkobGVuKTsgaSA8IGxlbjsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0KCmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKCmZ1bmN0aW9uIF9jcmVhdGVTdXBlcihEZXJpdmVkKSB7IHZhciBoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0ID0gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpOyByZXR1cm4gZnVuY3Rpb24gX2NyZWF0ZVN1cGVySW50ZXJuYWwoKSB7IHZhciBTdXBlciA9IF9nZXRQcm90b3R5cGVPZihEZXJpdmVkKSwgcmVzdWx0OyBpZiAoaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCkgeyB2YXIgTmV3VGFyZ2V0ID0gX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCByZXN1bHQpOyB9OyB9CgpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQoKaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnZXZlbnRzJzsKaW1wb3J0IHBpcGUgZnJvbSAnaXQtcGlwZSc7CmltcG9ydCB7IFBST1RPQ09MIH0gZnJvbSAnLi9wcm90b2NvbCc7CmltcG9ydCBlbmNvZGluZyBmcm9tICcuL2VuY29kaW5nJzsKCnZhciBDb25uZWN0aW9uID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRXZlbnRFbWl0dGVyKSB7CiAgX2luaGVyaXRzKENvbm5lY3Rpb24sIF9FdmVudEVtaXR0ZXIpOwoKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKENvbm5lY3Rpb24pOwoKICBmdW5jdGlvbiBDb25uZWN0aW9uKHJlbW90ZUlkLCBsaWJwMnAsIHJvb20pIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29ubmVjdGlvbik7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfcmVtb3RlSWQiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9saWJwMnAiLCB2b2lkIDApOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIl9yb29tIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJfY29ubmVjdGlvbiIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiX2Nvbm5lY3RpbmciLCB2b2lkIDApOwoKICAgIF90aGlzLl9yZW1vdGVJZCA9IHJlbW90ZUlkOwogICAgX3RoaXMuX2xpYnAycCA9IGxpYnAycDsKICAgIF90aGlzLl9yb29tID0gcm9vbTsKICAgIF90aGlzLl9jb25uZWN0aW9uID0gbnVsbDsKICAgIF90aGlzLl9jb25uZWN0aW5nID0gZmFsc2U7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQ29ubmVjdGlvbiwgW3sKICAgIGtleTogInB1c2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIHB1c2gobWVzc2FnZSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmICh0aGlzLl9jb25uZWN0aW9uKSB7CiAgICAgICAgdGhpcy5fY29ubmVjdGlvbi5wdXNoKGVuY29kaW5nKG1lc3NhZ2UpKTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLm9uY2UoJ2Nvbm5lY3QnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMyLnB1c2gobWVzc2FnZSk7CiAgICAgIH0pOwoKICAgICAgaWYgKCF0aGlzLl9jb25uZWN0aW5nKSB7CiAgICAgICAgdGhpcy5fY29ubmVjdCgpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic3RvcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcCgpIHsKICAgICAgaWYgKHRoaXMuX2Nvbm5lY3Rpb24pIHsKICAgICAgICB0aGlzLl9jb25uZWN0aW9uLmVuZCgpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiX2Nvbm5lY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9jb25uZWN0MiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgICB2YXIgcGVlckluZm8sIGRpYWwsIHN0cmVhbTsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoaXMuX2Nvbm5lY3RpbmcgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0Nvbm5lY3RlZFRvUmVtb3RlKCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2Rpc2Nvbm5lY3QnKTsKICAgICAgICAgICAgICAgIHRoaXMuX2Nvbm5lY3RpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcGVlckluZm8gPSB0aGlzLl9saWJwMnAucGVlclN0b3JlLmdldCh0aGlzLl9yZW1vdGVJZCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGlicDJwLmRpYWxQcm90b2NvbChwZWVySW5mby5pZCwgUFJPVE9DT0wpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBkaWFsID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICBzdHJlYW0gPSBkaWFsLnN0cmVhbTsKICAgICAgICAgICAgICAgIHRoaXMuX2Nvbm5lY3Rpb24gPSBuZXcgRmlGb01lc3NhZ2VRdWV1ZSgpOwogICAgICAgICAgICAgICAgcGlwZSh0aGlzLl9jb25uZWN0aW9uLCBzdHJlYW0sIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShzb3VyY2UpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiwgX2RpZEl0ZXJhdG9yRXJyb3IsIF9pdGVyYXRvckVycm9yLCBfaXRlcmF0b3IsIF9zdGVwLCBfdmFsdWUsIG1lc3NhZ2U7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMuX2Nvbm5lY3RpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMuZW1pdCgnY29ubmVjdCcsIF90aGlzMy5fY29ubmVjdGlvbik7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IgPSBfYXN5bmNJdGVyYXRvcihzb3VyY2UpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfaXRlcmF0b3IubmV4dCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3RlcCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gX3N0ZXAuZG9uZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfc3RlcC52YWx1ZTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF92YWx1ZSA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE5OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gX3ZhbHVlOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy5lbWl0KCdtZXNzYWdlJywgbWVzc2FnZSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oNCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IF9jb250ZXh0LnQwOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI1OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI2OwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvclsicmV0dXJuIl0gIT0gbnVsbCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2l0ZXJhdG9yWyJyZXR1cm4iXSgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDMwOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghX2RpZEl0ZXJhdG9yRXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5maW5pc2goMzApOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmZpbmlzaCgyNSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzQsIDIxLCAyNSwgMzVdLCBbMjYsLCAzMCwgMzRdXSk7CiAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSgpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMzLmVtaXQoJ2Rpc2Nvbm5lY3QnKTsKICAgICAgICAgICAgICAgIH0sIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBfcmVmMiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKGVycikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5fY29ubmVjdCgpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSA1OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyWyJjYXRjaCJdKDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZhaWwgcmVjb25uZWN0Jyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMiwgbnVsbCwgW1swLCA1XV0pOwogICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94MikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSgpKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIF9jb25uZWN0KCkgewogICAgICAgIHJldHVybiBfY29ubmVjdDIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9jb25uZWN0OwogICAgfSgpCiAgfSwgewogICAga2V5OiAiX2lzQ29ubmVjdGVkVG9SZW1vdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9pc0Nvbm5lY3RlZFRvUmVtb3RlKCkgewogICAgICB2YXIgX2l0ZXJhdG9yMiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuX2xpYnAycC5jb25uZWN0aW9ucy5rZXlzKCkpLAogICAgICAgICAgX3N0ZXAyOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjIucygpOyAhKF9zdGVwMiA9IF9pdGVyYXRvcjIubigpKS5kb25lOykgewogICAgICAgICAgdmFyIHBlZXJJZCA9IF9zdGVwMi52YWx1ZTsKCiAgICAgICAgICBpZiAocGVlcklkID09PSB0aGlzLl9yZW1vdGVJZC5faWRCNThTdHJpbmcpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIENvbm5lY3Rpb247Cn0oRXZlbnRFbWl0dGVyKTsKCmV4cG9ydCB7IENvbm5lY3Rpb24gYXMgZGVmYXVsdCB9OwpfU3ltYm9sJGFzeW5jSXRlcmF0b3IgPSBTeW1ib2wuYXN5bmNJdGVyYXRvcjsKCnZhciBGaUZvTWVzc2FnZVF1ZXVlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBGaUZvTWVzc2FnZVF1ZXVlKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZpRm9NZXNzYWdlUXVldWUpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiX3F1ZXVlIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIl9lbmRlZCIsIHZvaWQgMCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJfcmVzb2x2ZSIsIHZvaWQgMCk7CgogICAgdGhpcy5fcXVldWUgPSBbXTsKICB9CgogIF9jcmVhdGVDbGFzcyhGaUZvTWVzc2FnZVF1ZXVlLCBbewogICAga2V5OiBfU3ltYm9sJGFzeW5jSXRlcmF0b3IsCiAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInB1c2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIHB1c2gobWVzc2FnZSkgewogICAgICBpZiAodGhpcy5fZW5kZWQpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01lc3NhZ2UgcXVldWUgZW5kZWQnKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuX3Jlc29sdmUpIHsKICAgICAgICByZXR1cm4gdGhpcy5fcmVzb2x2ZSh7CiAgICAgICAgICBkb25lOiBmYWxzZSwKICAgICAgICAgIHZhbHVlOiBtZXNzYWdlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMuX3F1ZXVlLnB1c2gobWVzc2FnZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBlbmQoKSB7CiAgICAgIHRoaXMuX2VuZGVkID0gdHJ1ZTsKCiAgICAgIGlmICh0aGlzLl9yZXNvbHZlKSB7CiAgICAgICAgdGhpcy5fcmVzb2x2ZSh7CiAgICAgICAgICBkb25lOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJuZXh0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBuZXh0KCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLl9lbmRlZCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBkb25lOiB0cnVlCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuX3F1ZXVlLmxlbmd0aCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBkb25lOiBmYWxzZSwKICAgICAgICAgIHZhbHVlOiB0aGlzLl9xdWV1ZS5zaGlmdCgpCiAgICAgICAgfTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgX3RoaXM0Ll9yZXNvbHZlID0gcmVzb2x2ZTsKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gRmlGb01lc3NhZ2VRdWV1ZTsKfSgpOw=="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/common/messaging/pubsubRoom/connection.ts"],"names":["EventEmitter","pipe","PROTOCOL","encoding","Connection","remoteId","libp2p","room","_remoteId","_libp2p","_room","_connection","_connecting","message","push","once","_connect","end","_isConnectedToRemote","emit","peerInfo","peerStore","get","dialProtocol","id","dial","stream","FiFoMessageQueue","source","then","err","console","log","connections","keys","peerId","_idB58String","Symbol","asyncIterator","_queue","_ended","Error","_resolve","done","value","length","shift","Promise","resolve"],"mappings":"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","sourcesContent":["'use strict'\r\n\r\nimport { EventEmitter } from 'events'\r\nimport pipe from 'it-pipe'\r\n\r\n\r\nimport { PROTOCOL } from './protocol'\r\nimport encoding from './encoding'\r\n\r\nimport debug from 'debug'\r\n\r\n\r\nexport default class Connection extends EventEmitter {\r\n\r\n  _remoteId: any\r\n  _libp2p: any\r\n  _room: any\r\n  _connection: any\r\n  _connecting: any\r\n\r\n  constructor (remoteId, libp2p, room) {\r\n    super()\r\n    this._remoteId = remoteId\r\n    this._libp2p = libp2p\r\n    this._room = room\r\n    this._connection = null\r\n    this._connecting = false\r\n  }\r\n\r\n  push(message) {\r\n    if (this._connection) {\r\n      this._connection.push(encoding(message))\r\n\r\n      return\r\n    }\r\n\r\n    this.once('connect', () => {\r\n      this.push(message)\r\n    })\r\n\r\n    if (!this._connecting) {\r\n      this._connect()\r\n    }\r\n  }\r\n\r\n  stop() {\r\n    if (this._connection) {\r\n      this._connection.end()\r\n    }\r\n  }\r\n\r\n  async _connect() {\r\n    this._connecting = true\r\n\r\n    if (!this._isConnectedToRemote()) {\r\n      this.emit('disconnect')\r\n      this._connecting = false\r\n      return // early\r\n    }\r\n\r\n    const peerInfo = this._libp2p.peerStore.get(this._remoteId)\r\n\r\n    const dial = await this._libp2p.dialProtocol(peerInfo.id, PROTOCOL)\r\n\r\n    const { stream } = dial\r\n\r\n    this._connection = new FiFoMessageQueue()\r\n\r\n    pipe(this._connection, stream, async (source) => {\r\n      this._connecting = false\r\n      this.emit('connect', this._connection)\r\n\r\n      for await (const message of source) {\r\n        this.emit('message', message)\r\n      }\r\n    })\r\n      .then(() => {\r\n        this.emit('disconnect')\r\n      }, async (err) => {\r\n        try {\r\n          await this._connect()\r\n        } catch (e) {\r\n          console.log('Fail reconnect')\r\n        }\r\n      })\r\n  }\r\n\r\n  _isConnectedToRemote() {\r\n    for (const peerId of this._libp2p.connections.keys()) {\r\n      if (peerId === this._remoteId._idB58String) {\r\n        return true\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nclass FiFoMessageQueue {\r\n\r\n  _queue: any[]\r\n  _ended: boolean\r\n  _resolve: any\r\n\r\n  constructor () {\r\n    this._queue = []\r\n  }\r\n\r\n  [Symbol.asyncIterator] () {\r\n    return this\r\n  }\r\n\r\n  push(message) {\r\n    if (this._ended) {\r\n      throw new Error('Message queue ended')\r\n    }\r\n\r\n    if (this._resolve) {\r\n      return this._resolve({\r\n        done: false,\r\n        value: message\r\n      })\r\n    }\r\n\r\n    this._queue.push(message)\r\n  }\r\n\r\n  end() {\r\n    this._ended = true\r\n    if (this._resolve) {\r\n      this._resolve({\r\n        done: true\r\n      })\r\n    }\r\n  }\r\n\r\n  next() {\r\n    if (this._ended) {\r\n      return {\r\n        done: true\r\n      }\r\n    }\r\n\r\n    if (this._queue.length) {\r\n      return {\r\n        done: false,\r\n        value: this._queue.shift()\r\n      }\r\n    }\r\n\r\n    return new Promise((resolve) => {\r\n      this._resolve = resolve\r\n    })\r\n  }\r\n}\r\n"]}]}