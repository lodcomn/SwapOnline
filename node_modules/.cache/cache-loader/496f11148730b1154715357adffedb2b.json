{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\redux\\middleware\\selectiveSaver.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\redux\\middleware\\selectiveSaver.ts","mtime":1614852030449},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCi8vIEB0cy1ub2NoZWNrCmltcG9ydCBzdHJpbmdpZnkgZnJvbSAnanNvbi1zdHJpbmdpZnktc2FmZSc7CnZhciB0b1NhdmVTdGF0ZXMgPSBbJ3JlbWVtYmVyZWRTd2FwcycsICd1c2VyJywgJ3NpZ25VcCddOwoKdmFyIGNsZWFuUmVkdXhTdG9yZSA9IGZ1bmN0aW9uIGNsZWFuUmVkdXhTdG9yZShyZWR1eFN0b3JlKSB7CiAgcmV0dXJuIE9iamVjdC5rZXlzKHJlZHV4U3RvcmUpLnJlZHVjZShmdW5jdGlvbiAocmVzdWx0LCBrZXkpIHsKICAgIHJldHVybiB0b1NhdmVTdGF0ZXMuaW5jbHVkZXMoa2V5KSA/IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgcmVzdWx0KSwge30sIF9kZWZpbmVQcm9wZXJ0eSh7fSwga2V5LCByZWR1eFN0b3JlW2tleV0pKSA6IHJlc3VsdDsKICB9LCB7fSk7Cn07Cgp2YXIgc2VsZWN0aXZlU2F2ZXIgPSBmdW5jdGlvbiBzZWxlY3RpdmVTYXZlcihzdG9yZSkgewogIHJldHVybiBmdW5jdGlvbiAobmV4dCkgewogICAgcmV0dXJuIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShhY3Rpb24pIHsKICAgICAgICB2YXIgc3RhdGVOYW1lLCBkYXRhLCByZWR1eFN0b3JlOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBuZXh0KGFjdGlvbik7CiAgICAgICAgICAgICAgICBzdGF0ZU5hbWUgPSBhY3Rpb24udHlwZS5zcGxpdCgnLicpWzBdOwoKICAgICAgICAgICAgICAgIGlmICh0b1NhdmVTdGF0ZXMuaW5jbHVkZXMoc3RhdGVOYW1lKSkgewogICAgICAgICAgICAgICAgICBkYXRhID0gc3RvcmUuZ2V0U3RhdGUoKVtzdGF0ZU5hbWVdOwogICAgICAgICAgICAgICAgICByZWR1eFN0b3JlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JlZHV4LXN0b3JlJyk7CgogICAgICAgICAgICAgICAgICBpZiAocmVkdXhTdG9yZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIC8vQAogICAgICAgICAgICAgICAgICAgIHJlZHV4U3RvcmUgPSBfZGVmaW5lUHJvcGVydHkoe30sIHN0YXRlTmFtZSwgZGF0YSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy9ACiAgICAgICAgICAgICAgICAgICAgcmVkdXhTdG9yZSA9IGNsZWFuUmVkdXhTdG9yZShKU09OLnBhcnNlKHJlZHV4U3RvcmUpKTsgLy9ACgogICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZU5hbWUgaW4gcmVkdXhTdG9yZSkgewogICAgICAgICAgICAgICAgICAgICAgLy9ACiAgICAgICAgICAgICAgICAgICAgICByZWR1eFN0b3JlW3N0YXRlTmFtZV0gPSBkYXRhOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICByZWR1eFN0b3JlID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCByZWR1eFN0b3JlKSwge30sIF9kZWZpbmVQcm9wZXJ0eSh7fSwgc3RhdGVOYW1lLCBkYXRhKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncmVkdXgtc3RvcmUnLCBzdHJpbmdpZnkocmVkdXhTdG9yZSwgbnVsbCwgMikpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9KCk7CiAgfTsKfTsKCmV4cG9ydCB7IHNlbGVjdGl2ZVNhdmVyIH07"},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/redux/middleware/selectiveSaver.ts"],"names":["stringify","toSaveStates","cleanReduxStore","reduxStore","Object","keys","reduce","result","key","includes","selectiveSaver","store","next","action","stateName","type","split","data","getState","localStorage","getItem","JSON","parse","setItem"],"mappings":";;;;;;;;AAAA;AACA,OAAOA,SAAP,MAAsB,qBAAtB;AAGA,IAAMC,YAAY,GAAG,CACnB,iBADmB,EAEnB,MAFmB,EAGnB,QAHmB,CAArB;;AAMA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,UAAD;AAAA,SACtBC,MAAM,CAACC,IAAP,CAAYF,UAAZ,EACGG,MADH,CACU,UAACC,MAAD,EAASC,GAAT;AAAA,WACNP,YAAY,CAACQ,QAAb,CAAsBD,GAAtB,oCAEOD,MAFP,2BAGKC,GAHL,EAGWL,UAAU,CAACK,GAAD,CAHrB,KAKID,MANE;AAAA,GADV,EAQE,EARF,CADsB;AAAA,CAAxB;;AAWA,IAAMG,cAAc,GAAG,SAAjBA,cAAiB,CAAAC,KAAK;AAAA,SAAI,UAAAC,IAAI;AAAA;AAAA,0EAAI,iBAAMC,MAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACtCD,gBAAAA,IAAI,CAACC,MAAD,CAAJ;AAEMC,gBAAAA,SAHgC,GAGpBD,MAAM,CAACE,IAAP,CAAYC,KAAZ,CAAkB,GAAlB,EAAuB,CAAvB,CAHoB;;AAKtC,oBAAIf,YAAY,CAACQ,QAAb,CAAsBK,SAAtB,CAAJ,EAAsC;AAC9BG,kBAAAA,IAD8B,GACvBN,KAAK,CAACO,QAAN,GAAiBJ,SAAjB,CADuB;AAEhCX,kBAAAA,UAFgC,GAEnBgB,YAAY,CAACC,OAAb,CAAqB,aAArB,CAFmB;;AAIpC,sBAAIjB,UAAU,KAAK,IAAnB,EAAyB;AACvB;AACAA,oBAAAA,UAAU,uBAAMW,SAAN,EAAkBG,IAAlB,CAAV;AACD,mBAHD,MAGO;AACL;AACAd,oBAAAA,UAAU,GAAGD,eAAe,CAACmB,IAAI,CAACC,KAAL,CAAWnB,UAAX,CAAD,CAA5B,CAFK,CAGL;;AACA,wBAAIW,SAAS,IAAIX,UAAjB,EAA6B;AAC3B;AACAA,sBAAAA,UAAU,CAACW,SAAD,CAAV,GAAwBG,IAAxB;AACD,qBAHD,MAGO;AACLd,sBAAAA,UAAU,mCAELA,UAFK,2BAGPW,SAHO,EAGKG,IAHL,EAAV;AAKD;AACF;;AACDE,kBAAAA,YAAY,CAACI,OAAb,CAAqB,aAArB,EAAoCvB,SAAS,CAACG,UAAD,EAAa,IAAb,EAAmB,CAAnB,CAA7C;AACD;;AA5BqC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAJ;;AAAA;AAAA;AAAA;AAAA;AAAA,GAAR;AAAA,CAA5B;;AA+BA,SACEO,cADF","sourcesContent":["// @ts-nocheck\r\nimport stringify from 'json-stringify-safe'\r\n\r\n\r\nconst toSaveStates = [\r\n  'rememberedSwaps',\r\n  'user',\r\n  'signUp',\r\n]\r\n\r\nconst cleanReduxStore = (reduxStore) =>\r\n  Object.keys(reduxStore)\r\n    .reduce((result, key) =>\r\n      toSaveStates.includes(key)\r\n        ? {\r\n          ...result,\r\n          [key]: reduxStore[key],\r\n        }\r\n        : result,\r\n    {})\r\n\r\nconst selectiveSaver = store => next => async action => {\r\n  next(action)\r\n\r\n  const stateName = action.type.split('.')[0]\r\n\r\n  if (toSaveStates.includes(stateName)) {\r\n    const data = store.getState()[stateName]\r\n    let reduxStore = localStorage.getItem('redux-store')\r\n\r\n    if (reduxStore === null) {\r\n      //@\r\n      reduxStore = { [stateName]: data }\r\n    } else {\r\n      //@\r\n      reduxStore = cleanReduxStore(JSON.parse(reduxStore))\r\n      //@\r\n      if (stateName in reduxStore) {\r\n        //@\r\n        reduxStore[stateName] = data\r\n      } else {\r\n        reduxStore = {\r\n          //@\r\n          ...reduxStore,\r\n          [stateName]: data,\r\n        }\r\n      }\r\n    }\r\n    localStorage.setItem('redux-store', stringify(reduxStore, null, 2))\r\n  }\r\n}\r\n\r\nexport {\r\n  selectiveSaver,\r\n}\r\n"]}]}