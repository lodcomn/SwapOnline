{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\helpers\\next.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\helpers\\next.ts","mtime":1614852315833},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKLy8gQHRzLW5vY2hlY2sKaW1wb3J0IHsgZ2V0U3RhdGUgfSBmcm9tICdyZWR1eC9jb3JlJzsKaW1wb3J0IGFjdGlvbnMgZnJvbSAncmVkdXgvYWN0aW9ucyc7CmltcG9ydCBjb25maWcgZnJvbSAnLi9leHRlcm5hbENvbmZpZyc7CmltcG9ydCBjb25zdGFudHMgZnJvbSAnLi9jb25zdGFudHMnOwppbXBvcnQgcmVxdWVzdCBmcm9tICdjb21tb24vdXRpbHMvcmVxdWVzdCc7CmltcG9ydCBCaWdOdW1iZXIgZnJvbSAnYmlnbnVtYmVyLmpzJzsKdmFyIG5ldHdvcmtzID0gewogIG1haW5uZXQ6IHsKICAgIG1lc3NhZ2VQcmVmaXg6ICdOZXh0Y29pbiBTaWduZWQgTWVzc2FnZTpcbicsCiAgICBiaXAzMjogewogICAgICAicHVibGljIjogMHgwNDg4QjIxRSwKICAgICAgInByaXZhdGUiOiAweDA0ODhBREU0CiAgICB9LAogICAgcHViS2V5SGFzaDogNzUsCiAgICBzY3JpcHRIYXNoOiA1LAogICAgd2lmOiAxMjgKICB9CiAgLyp0ZXN0bmV0OiB7DQogICAgbWVzc2FnZVByZWZpeDogJ1x4MThCaXRjb2luIFNpZ25lZCBNZXNzYWdlOlxuJywNCiAgICBiaXAzMjogew0KICAgICAgcHVibGljOiAweGUxNDI3ODAwLA0KICAgICAgcHJpdmF0ZTogMHgwNDg4OTQ3OCwNCiAgICB9LA0KICAgIHB1YktleUhhc2g6IDB4NEIsDQogICAgc2NyaXB0SGFzaDogMHg4OSwNCiAgICB3aWY6IDB4MmUsDQogIH0qLwoKfTsKdmFyIGhhc0FkbWluRmVlID0gY29uZmlnICYmIGNvbmZpZy5vcHRzICYmIGNvbmZpZy5vcHRzLmZlZSAmJiBjb25maWcub3B0cy5mZWUubmV4dCAmJiBjb25maWcub3B0cy5mZWUubmV4dC5mZWUgPyBjb25maWcub3B0cy5mZWUubmV4dCA6IGZhbHNlOwovKmNvbnN0IG5ldHdvcmsgPSBwcm9jZXNzLmVudi5NQUlOTkVUDQogID8gbmV0d29ya3MubWFpbm5ldA0KICA6IG5ldHdvcmtzLnRlc3RuZXQqLwoKdmFyIG5ldHdvcmsgPSBuZXR3b3Jrcy5tYWlubmV0Owp2YXIgRFVTVCA9IDU0NjsgLy8gZGVzY3JpcHRpb24gaW4gLi9idGMudHMKLy8gZ2V0Qnl0ZUNvdW50KHsnTVVMVElTSUctUDJTSDoyLTQnOjQ1fSx7J1AyUEtIJzoxfSkgTWVhbnMgIjQ1IGlucHV0cyBvZiBQMlNIIE11bHRpc2lnIGFuZCAxIG91dHB1dCBvZiBQMlBLSCIKLy8gZ2V0Qnl0ZUNvdW50KHsnUDJQS0gnOjEsJ01VTFRJU0lHLVAyU0g6Mi0zJzoyfSx7J1AyUEtIJzoyfSkgbWVhbnMgIjEgUDJQS0ggaW5wdXQgYW5kIDIgTXVsdGlzaWcgUDJTSCAoMiBvZiAzKSBpbnB1dHMgYWxvbmcgd2l0aCAyIFAyUEtIIG91dHB1dHMiCgp2YXIgZ2V0Qnl0ZUNvdW50ID0gZnVuY3Rpb24gZ2V0Qnl0ZUNvdW50KGlucHV0cywgb3V0cHV0cykgewogIHZhciB0b3RhbFdlaWdodCA9IDA7CiAgdmFyIGhhc1dpdG5lc3MgPSBmYWxzZTsKICB2YXIgaW5wdXRDb3VudCA9IDA7CiAgdmFyIG91dHB1dENvdW50ID0gMDsgLy8gYXNzdW1lcyBjb21wcmVzc2VkIHB1YmtleXMgaW4gYWxsIGNhc2VzLgoKICB2YXIgdHlwZXMgPSB7CiAgICAnaW5wdXRzJzogewogICAgICAnTVVMVElTSUctUDJTSCc6IDQ5ICogNCwKICAgICAgJ01VTFRJU0lHLVAyV1NIJzogNiArIDQxICogNCwKICAgICAgJ01VTFRJU0lHLVAyU0gtUDJXU0gnOiA2ICsgNzYgKiA0LAogICAgICAnUDJQS0gnOiAxNDggKiA0LAogICAgICAnUDJXUEtIJzogMTA4ICsgNDEgKiA0LAogICAgICAnUDJTSC1QMldQS0gnOiAxMDggKyA2NCAqIDQKICAgIH0sCiAgICAnb3V0cHV0cyc6IHsKICAgICAgJ1AyU0gnOiAzMiAqIDQsCiAgICAgICdQMlBLSCc6IDM0ICogNCwKICAgICAgJ1AyV1BLSCc6IDMxICogNCwKICAgICAgJ1AyV1NIJzogNDMgKiA0CiAgICB9CiAgfTsKCiAgdmFyIGNoZWNrVUludDUzID0gZnVuY3Rpb24gY2hlY2tVSW50NTMobikgewogICAgaWYgKG4gPCAwIHx8IG4gPiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCBuICUgMSAhPT0gMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3ZhbHVlIG91dCBvZiByYW5nZScpOwogIH07CgogIHZhciB2YXJJbnRMZW5ndGggPSBmdW5jdGlvbiB2YXJJbnRMZW5ndGgobnVtYmVyKSB7CiAgICBjaGVja1VJbnQ1MyhudW1iZXIpOwogICAgcmV0dXJuIG51bWJlciA8IDB4ZmQgPyAxIDogbnVtYmVyIDw9IDB4ZmZmZiA/IDMgOiBudW1iZXIgPD0gMHhmZmZmZmZmZiA/IDUgOiA5OwogIH07CgogIE9iamVjdC5rZXlzKGlucHV0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICBjaGVja1VJbnQ1MyhpbnB1dHNba2V5XSk7CgogICAgaWYgKGtleS5zbGljZSgwLCA4KSA9PT0gJ01VTFRJU0lHJykgewogICAgICAvLyBleC4gIk1VTFRJU0lHLVAyU0g6Mi0zIiB3b3VsZCBtZWFuIDIgb2YgMyBQMlNIIE1VTFRJU0lHCiAgICAgIHZhciBrZXlQYXJ0cyA9IGtleS5zcGxpdCgnOicpOwogICAgICBpZiAoa2V5UGFydHMubGVuZ3RoICE9PSAyKSB0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgaW5wdXQ6ICIuY29uY2F0KGtleSkpOwogICAgICB2YXIgbmV3S2V5ID0ga2V5UGFydHNbMF07CiAgICAgIHZhciBtQW5kTiA9IGtleVBhcnRzWzFdLnNwbGl0KCctJykubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIHBhcnNlSW50KGl0ZW0pOwogICAgICB9KTsKICAgICAgdG90YWxXZWlnaHQgKz0gdHlwZXMuaW5wdXRzW25ld0tleV0gKiBpbnB1dHNba2V5XTsKICAgICAgdmFyIG11bHRpcGx5ZXIgPSBuZXdLZXkgPT09ICdNVUxUSVNJRy1QMlNIJyA/IDQgOiAxOwogICAgICB0b3RhbFdlaWdodCArPSAoNzMgKiBtQW5kTlswXSArIDM0ICogbUFuZE5bMV0pICogbXVsdGlwbHllciAqIGlucHV0c1trZXldOwogICAgfSBlbHNlIHsKICAgICAgdG90YWxXZWlnaHQgKz0gdHlwZXMuaW5wdXRzW2tleV0gKiBpbnB1dHNba2V5XTsKICAgIH0KCiAgICBpbnB1dENvdW50ICs9IGlucHV0c1trZXldOwogICAgaWYgKGtleS5pbmRleE9mKCdXJykgPj0gMCkgaGFzV2l0bmVzcyA9IHRydWU7CiAgfSk7CiAgT2JqZWN0LmtleXMob3V0cHV0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICBjaGVja1VJbnQ1MyhvdXRwdXRzW2tleV0pOwogICAgdG90YWxXZWlnaHQgKz0gdHlwZXMub3V0cHV0c1trZXldICogb3V0cHV0c1trZXldOwogICAgb3V0cHV0Q291bnQgKz0gb3V0cHV0c1trZXldOwogIH0pOwogIGlmIChoYXNXaXRuZXNzKSB0b3RhbFdlaWdodCArPSAyOwogIHRvdGFsV2VpZ2h0ICs9IDggKiA0OwogIHRvdGFsV2VpZ2h0ICs9IHZhckludExlbmd0aChpbnB1dENvdW50KSAqIDQ7CiAgdG90YWxXZWlnaHQgKz0gdmFySW50TGVuZ3RoKG91dHB1dENvdW50KSAqIDQ7CiAgcmV0dXJuIE1hdGguY2VpbCh0b3RhbFdlaWdodCAvIDQpOwp9OyAvL0AKCgp2YXIgY2FsY3VsYXRlVHhTaXplID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICB2YXIgX3JlZjIsCiAgICAgICAgc3BlZWQsCiAgICAgICAgdW5zcGVudHMsCiAgICAgICAgYWRkcmVzcywKICAgICAgICBfcmVmMiR0eE91dCwKICAgICAgICB0eE91dCwKICAgICAgICBfcmVmMiRtZXRob2QsCiAgICAgICAgbWV0aG9kLAogICAgICAgIGZpeGVkLAogICAgICAgIGRlZmF1bHRUeFNpemUsCiAgICAgICAgdHhJbiwKICAgICAgICB0eFNpemUsCiAgICAgICAgbXN1U2l6ZSwKICAgICAgICBtc3V0eFNpemUsCiAgICAgICAgbXNTaXplLAogICAgICAgIG1zdHhTaXplLAogICAgICAgIF9hcmdzID0gYXJndW1lbnRzOwoKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9yZWYyID0gX2FyZ3MubGVuZ3RoID4gMCAmJiBfYXJnc1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3NbMF0gOiB7fSwgc3BlZWQgPSBfcmVmMi5zcGVlZCwgdW5zcGVudHMgPSBfcmVmMi51bnNwZW50cywgYWRkcmVzcyA9IF9yZWYyLmFkZHJlc3MsIF9yZWYyJHR4T3V0ID0gX3JlZjIudHhPdXQsIHR4T3V0ID0gX3JlZjIkdHhPdXQgPT09IHZvaWQgMCA/IDIgOiBfcmVmMiR0eE91dCwgX3JlZjIkbWV0aG9kID0gX3JlZjIubWV0aG9kLCBtZXRob2QgPSBfcmVmMiRtZXRob2QgPT09IHZvaWQgMCA/ICdzZW5kJyA6IF9yZWYyJG1ldGhvZCwgZml4ZWQgPSBfcmVmMi5maXhlZDsKICAgICAgICAgICAgZGVmYXVsdFR4U2l6ZSA9IGNvbnN0YW50cy5kZWZhdWx0RmVlUmF0ZXMubmV4dC5zaXplW21ldGhvZF07CgogICAgICAgICAgICBpZiAoIWZpeGVkKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGRlZmF1bHRUeFNpemUpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgX2NvbnRleHQudDAgPSB1bnNwZW50czsKCiAgICAgICAgICAgIGlmIChfY29udGV4dC50MCkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnMubmV4dC5mZXRjaFVuc3BlbnRzKGFkZHJlc3MpOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgdW5zcGVudHMgPSBfY29udGV4dC50MDsKICAgICAgICAgICAgdHhJbiA9IHVuc3BlbnRzLmxlbmd0aDsKICAgICAgICAgICAgdHhTaXplID0gdHhJbiA+IDAgPyB0eEluICogMTQ2ICsgdHhPdXQgKiAzMyArICgxNSArIHR4SW4gLSB0eE91dCkgOiBkZWZhdWx0VHhTaXplOwoKICAgICAgICAgICAgaWYgKCEobWV0aG9kID09PSAnc2VuZF9tdWx0aXNpZycpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBtc3VTaXplID0gZ2V0Qnl0ZUNvdW50KHsKICAgICAgICAgICAgICAnTVVMVElTSUctUDJTSC1QMldTSDoyLTInOiAxCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAnUDJQS0gnOiBoYXNBZG1pbkZlZSA/IDMgOiAyCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBtc3V0eFNpemUgPSB0eEluICogbXN1U2l6ZSArIHR4T3V0ICogMzMgKyAoMTUgKyB0eEluIC0gdHhPdXQpOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBtc3V0eFNpemUpOwoKICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgIGlmICghKG1ldGhvZCA9PT0gJ3NlbmRfMmZhJykpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1zU2l6ZSA9IGdldEJ5dGVDb3VudCh7CiAgICAgICAgICAgICAgJ01VTFRJU0lHLVAyU0gtUDJXU0g6Mi0zJzogMQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgJ1AyUEtIJzogaGFzQWRtaW5GZWUgPyAzIDogMgogICAgICAgICAgICB9KTsKICAgICAgICAgICAgbXN0eFNpemUgPSB0eEluICogbXNTaXplICsgdHhPdXQgKiAzMyArICgxNSArIHR4SW4gLSB0eE91dCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIG1zdHhTaXplKTsKCiAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCB0eFNpemUpOwoKICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gY2FsY3VsYXRlVHhTaXplKCkgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7Cgp2YXIgZXN0aW1hdGVGZWVWYWx1ZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIob3B0aW9ucykgewogICAgdmFyIGZlZVJhdGUsIGluU2F0b3NoaXMsIHNwZWVkLCBhZGRyZXNzLCB0eFNpemUsIGZpeGVkLCBtZXRob2QsIF9nZXRTdGF0ZSwgX2dldFN0YXRlJHVzZXIsIG5leHREYXRhLCBuZXh0TXVsdGlzaWdTTVNEYXRhLCBuZXh0TXVsdGlzaWdVc2VyRGF0YSwgdHhPdXQsIGNhbGN1bGF0ZWRGZWVWYWx1ZSwgQ1VTVE9NX1NBVE9TSEksIGZpbmFsRmVlVmFsdWU7CgogICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGZlZVJhdGUgPSBvcHRpb25zLmZlZVJhdGUsIGluU2F0b3NoaXMgPSBvcHRpb25zLmluU2F0b3NoaXMsIHNwZWVkID0gb3B0aW9ucy5zcGVlZCwgYWRkcmVzcyA9IG9wdGlvbnMuYWRkcmVzcywgdHhTaXplID0gb3B0aW9ucy50eFNpemUsIGZpeGVkID0gb3B0aW9ucy5maXhlZCwgbWV0aG9kID0gb3B0aW9ucy5tZXRob2Q7CiAgICAgICAgICAgIF9nZXRTdGF0ZSA9IGdldFN0YXRlKCksIF9nZXRTdGF0ZSR1c2VyID0gX2dldFN0YXRlLnVzZXIsIG5leHREYXRhID0gX2dldFN0YXRlJHVzZXIubmV4dERhdGEsIG5leHRNdWx0aXNpZ1NNU0RhdGEgPSBfZ2V0U3RhdGUkdXNlci5uZXh0TXVsdGlzaWdTTVNEYXRhLCBuZXh0TXVsdGlzaWdVc2VyRGF0YSA9IF9nZXRTdGF0ZSR1c2VyLm5leHRNdWx0aXNpZ1VzZXJEYXRhOwogICAgICAgICAgICB0eE91dCA9IDI7CiAgICAgICAgICAgIGlmIChoYXNBZG1pbkZlZSkgdHhPdXQgPSAzOwoKICAgICAgICAgICAgaWYgKCFhZGRyZXNzKSB7CiAgICAgICAgICAgICAgYWRkcmVzcyA9IG5leHREYXRhLmFkZHJlc3M7IC8vQAoKICAgICAgICAgICAgICBpZiAobWV0aG9kID09PSAnc2VuZF8yZmEnKSBhZGRyZXNzID0gbmV4dE11bHRpc2lnU01TOwogICAgICAgICAgICAgIGlmIChtZXRob2QgPT09ICdzZW5kX211bHRpc2lnJykgYWRkcmVzcyA9IG5leHRNdWx0aXNpZ1VzZXJEYXRhLmFkZHJlc3M7CiAgICAgICAgICAgIH0gLy9ACgoKICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gdHhTaXplOwoKICAgICAgICAgICAgaWYgKF9jb250ZXh0Mi50MCkgewogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gOTsKICAgICAgICAgICAgcmV0dXJuIGNhbGN1bGF0ZVR4U2l6ZSh7CiAgICAgICAgICAgICAgYWRkcmVzczogYWRkcmVzcywKICAgICAgICAgICAgICBzcGVlZDogc3BlZWQsCiAgICAgICAgICAgICAgZml4ZWQ6IGZpeGVkLAogICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kLAogICAgICAgICAgICAgIHR4T3V0OiB0eE91dAogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIHR4U2l6ZSA9IF9jb250ZXh0Mi50MDsKICAgICAgICAgICAgX2NvbnRleHQyLnQxID0gZmVlUmF0ZTsKCiAgICAgICAgICAgIGlmIChfY29udGV4dDIudDEpIHsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE2OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE1OwogICAgICAgICAgICByZXR1cm4gZXN0aW1hdGVGZWVSYXRlKHsKICAgICAgICAgICAgICBzcGVlZDogc3BlZWQKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgX2NvbnRleHQyLnQxID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgZmVlUmF0ZSA9IF9jb250ZXh0Mi50MTsKICAgICAgICAgICAgY2FsY3VsYXRlZEZlZVZhbHVlID0gQmlnTnVtYmVyLm1heGltdW0oRFVTVCwgbmV3IEJpZ051bWJlcihmZWVSYXRlKS5tdWx0aXBsaWVkQnkodHhTaXplKS5kaXYoMTAyNCkgLy8gZGl2aWRlIGJ5IG9uZSBraWxvYnl0ZQogICAgICAgICAgICAuZHAoMCwgQmlnTnVtYmVyLlJPVU5EX0hBTEZfRVZFTikpOwogICAgICAgICAgICBDVVNUT01fU0FUT1NISSA9IDIwOwogICAgICAgICAgICBjYWxjdWxhdGVkRmVlVmFsdWUucGx1cyhDVVNUT01fU0FUT1NISSk7IC8vIGp1c3Qgd2FudGVkIHRvIGFkZAoKICAgICAgICAgICAgZmluYWxGZWVWYWx1ZSA9IGluU2F0b3NoaXMgPyBjYWxjdWxhdGVkRmVlVmFsdWUudG9TdHJpbmcoKSA6IGNhbGN1bGF0ZWRGZWVWYWx1ZS5tdWx0aXBsaWVkQnkoMWUtOCkudG9TdHJpbmcoKTsKICAgICAgICAgICAgY29uc29sZS5sb2coIk5leHQgd2l0aGRyYXcgZmVlIHNwZWVkKCIuY29uY2F0KHNwZWVkLCAiKSBtZXRob2QgKCIpLmNvbmNhdChtZXRob2QsICIpICIpLmNvbmNhdChmaW5hbEZlZVZhbHVlKSk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBmaW5hbEZlZVZhbHVlKTsKCiAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMik7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gZXN0aW1hdGVGZWVWYWx1ZShfeCkgewogICAgcmV0dXJuIF9yZWYzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKdmFyIGVzdGltYXRlRmVlUmF0ZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWY0ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICB2YXIgX3JlZjUsCiAgICAgICAgX3JlZjUkc3BlZWQsCiAgICAgICAgc3BlZWQsCiAgICAgICAgbGluaywKICAgICAgICBkZWZhdWx0UmF0ZSwKICAgICAgICBhcGlSZXN1bHQsCiAgICAgICAgYXBpU3BlZWRzLAogICAgICAgIGFwaVNwZWVkLAogICAgICAgIGFwaVJhdGUsCiAgICAgICAgX2FyZ3MzID0gYXJndW1lbnRzOwoKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfcmVmNSA9IF9hcmdzMy5sZW5ndGggPiAwICYmIF9hcmdzM1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MzWzBdIDoge30sIF9yZWY1JHNwZWVkID0gX3JlZjUuc3BlZWQsIHNwZWVkID0gX3JlZjUkc3BlZWQgPT09IHZvaWQgMCA/ICdmYXN0JyA6IF9yZWY1JHNwZWVkOwogICAgICAgICAgICBsaW5rID0gY29uZmlnLmZlZVJhdGVzLm5leHQ7CiAgICAgICAgICAgIGRlZmF1bHRSYXRlID0gY29uc3RhbnRzLmRlZmF1bHRGZWVSYXRlcy5uZXh0LnJhdGU7CgogICAgICAgICAgICBpZiAobGluaykgewogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIGRlZmF1bHRSYXRlW3NwZWVkXSk7CgogICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDU7CiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZ2V0KGxpbmssIHsKICAgICAgICAgICAgICBjYWNoZVJlc3BvbnNlOiA2MDAwMAogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIGFwaVJlc3VsdCA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE1OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDExOwogICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oNSk7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVzdGltYXRlRmVlUmF0ZTogIi5jb25jYXQoX2NvbnRleHQzLnQwLm1lc3NhZ2UpKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIGRlZmF1bHRSYXRlW3NwZWVkXSk7CgogICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgYXBpU3BlZWRzID0gewogICAgICAgICAgICAgIHNsb3c6ICdsb3dfZmVlX3Blcl9rYicsCiAgICAgICAgICAgICAgbm9ybWFsOiAnbWVkaXVtX2ZlZV9wZXJfa2InLAogICAgICAgICAgICAgIGZhc3Q6ICdoaWdoX2ZlZV9wZXJfa2InCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGFwaVNwZWVkID0gYXBpU3BlZWRzW3NwZWVkXSB8fCBhcGlTcGVlZHMubm9ybWFsOwogICAgICAgICAgICBhcGlSYXRlID0gbmV3IEJpZ051bWJlcihhcGlSZXN1bHRbYXBpU3BlZWRdKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIGFwaVJhdGUuaXNHcmVhdGVyVGhhbk9yRXF1YWxUbyhEVVNUKSA/IGFwaVJhdGUudG9TdHJpbmcoKSA6IGRlZmF1bHRSYXRlW3NwZWVkXSk7CgogICAgICAgICAgY2FzZSAxOToKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTMsIG51bGwsIFtbNSwgMTFdXSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gZXN0aW1hdGVGZWVSYXRlKCkgewogICAgcmV0dXJuIF9yZWY0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKZXhwb3J0IGRlZmF1bHQgewogIGNhbGN1bGF0ZVR4U2l6ZTogY2FsY3VsYXRlVHhTaXplLAogIGVzdGltYXRlRmVlVmFsdWU6IGVzdGltYXRlRmVlVmFsdWUsCiAgZXN0aW1hdGVGZWVSYXRlOiBlc3RpbWF0ZUZlZVJhdGUsCiAgbmV0d29yazogbmV0d29yaywKICBuZXR3b3JrczogbmV0d29ya3MKfTs="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/helpers/next.ts"],"names":["getState","actions","config","constants","request","BigNumber","networks","mainnet","messagePrefix","bip32","pubKeyHash","scriptHash","wif","hasAdminFee","opts","fee","next","network","DUST","getByteCount","inputs","outputs","totalWeight","hasWitness","inputCount","outputCount","types","checkUInt53","n","Number","MAX_SAFE_INTEGER","RangeError","varIntLength","number","Object","keys","forEach","key","slice","keyParts","split","length","Error","newKey","mAndN","map","item","parseInt","multiplyer","indexOf","Math","ceil","calculateTxSize","speed","unspents","address","txOut","method","fixed","defaultTxSize","defaultFeeRates","size","fetchUnspents","txIn","txSize","msuSize","msutxSize","msSize","mstxSize","estimateFeeValue","options","feeRate","inSatoshis","user","nextData","nextMultisigSMSData","nextMultisigUserData","nextMultisigSMS","estimateFeeRate","calculatedFeeValue","maximum","multipliedBy","div","dp","ROUND_HALF_EVEN","CUSTOM_SATOSHI","plus","finalFeeValue","toString","console","log","link","feeRates","defaultRate","rate","get","cacheResponse","apiResult","error","message","apiSpeeds","slow","normal","fast","apiSpeed","apiRate","isGreaterThanOrEqualTo"],"mappings":"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","sourcesContent":["// @ts-nocheck\r\nimport * as bitcoin from 'bitcoinjs-lib'\r\nimport { getState } from 'redux/core'\r\nimport actions from 'redux/actions'\r\nimport config from './externalConfig'\r\nimport constants from './constants'\r\nimport request from 'common/utils/request'\r\nimport BigNumber from 'bignumber.js'\r\n\r\n\r\nconst networks = {\r\n  mainnet: {\r\n    messagePrefix: 'Nextcoin Signed Message:\\n',\r\n    bip32: {\r\n      public:  0x0488B21E,\r\n      private: 0x0488ADE4,\r\n    },\r\n    pubKeyHash: 75,\r\n    scriptHash: 5,\r\n    wif: 128,\r\n  },\r\n  /*testnet: {\r\n    messagePrefix: '\\x18Bitcoin Signed Message:\\n',\r\n    bip32: {\r\n      public: 0xe1427800,\r\n      private: 0x04889478,\r\n    },\r\n    pubKeyHash: 0x4B,\r\n    scriptHash: 0x89,\r\n    wif: 0x2e,\r\n  }*/\r\n}\r\n\r\n\r\nconst hasAdminFee = (\r\n  config\r\n    && config.opts\r\n    && config.opts.fee\r\n    && config.opts.fee.next\r\n    && config.opts.fee.next.fee\r\n) ? config.opts.fee.next : false\r\n\r\n/*const network = process.env.MAINNET\r\n  ? networks.mainnet\r\n  : networks.testnet*/\r\nconst network = networks.mainnet\r\n\r\nconst DUST = 546 // description in ./btc.ts\r\n\r\n// getByteCount({'MULTISIG-P2SH:2-4':45},{'P2PKH':1}) Means \"45 inputs of P2SH Multisig and 1 output of P2PKH\"\r\n// getByteCount({'P2PKH':1,'MULTISIG-P2SH:2-3':2},{'P2PKH':2}) means \"1 P2PKH input and 2 Multisig P2SH (2 of 3) inputs along with 2 P2PKH outputs\"\r\nconst getByteCount = (inputs, outputs) => {\r\n  let totalWeight = 0\r\n  let hasWitness = false\r\n  let inputCount = 0\r\n  let outputCount = 0\r\n  // assumes compressed pubkeys in all cases.\r\n  const types = {\r\n    'inputs': {\r\n      'MULTISIG-P2SH': 49 * 4,\r\n      'MULTISIG-P2WSH': 6 + (41 * 4),\r\n      'MULTISIG-P2SH-P2WSH': 6 + (76 * 4),\r\n      'P2PKH': 148 * 4,\r\n      'P2WPKH': 108 + (41 * 4),\r\n      'P2SH-P2WPKH': 108 + (64 * 4),\r\n    },\r\n    'outputs': {\r\n      'P2SH': 32 * 4,\r\n      'P2PKH': 34 * 4,\r\n      'P2WPKH': 31 * 4,\r\n      'P2WSH': 43 * 4,\r\n    },\r\n  }\r\n\r\n  const checkUInt53 = (n) => {\r\n    if (n < 0 || n > Number.MAX_SAFE_INTEGER || n % 1 !== 0) throw new RangeError('value out of range')\r\n  }\r\n\r\n  const varIntLength = (number) => {\r\n    checkUInt53(number)\r\n\r\n    return (\r\n      number < 0xfd ? 1\r\n        : number <= 0xffff ? 3\r\n          : number <= 0xffffffff ? 5\r\n            : 9\r\n    )\r\n  }\r\n\r\n  Object.keys(inputs).forEach((key) => {\r\n    checkUInt53(inputs[key])\r\n    if (key.slice(0, 8) === 'MULTISIG') {\r\n      // ex. \"MULTISIG-P2SH:2-3\" would mean 2 of 3 P2SH MULTISIG\r\n      const keyParts = key.split(':')\r\n      if (keyParts.length !== 2) throw new Error(`invalid input: ${key}`)\r\n      const newKey = keyParts[0]\r\n      const mAndN = keyParts[1].split('-').map((item) => parseInt(item))\r\n\r\n      totalWeight += types.inputs[newKey] * inputs[key]\r\n      const multiplyer = (newKey === 'MULTISIG-P2SH') ? 4 : 1\r\n      totalWeight += ((73 * mAndN[0]) + (34 * mAndN[1])) * multiplyer * inputs[key]\r\n    } else {\r\n      totalWeight += types.inputs[key] * inputs[key]\r\n    }\r\n    inputCount += inputs[key]\r\n    if (key.indexOf('W') >= 0) hasWitness = true\r\n  })\r\n\r\n  Object.keys(outputs).forEach((key) => {\r\n    checkUInt53(outputs[key])\r\n    totalWeight += types.outputs[key] * outputs[key]\r\n    outputCount += outputs[key]\r\n  })\r\n\r\n  if (hasWitness) totalWeight += 2\r\n\r\n  totalWeight += 8 * 4\r\n  totalWeight += varIntLength(inputCount) * 4\r\n  totalWeight += varIntLength(outputCount) * 4\r\n\r\n  return Math.ceil(totalWeight / 4)\r\n}\r\n\r\n//@\r\nconst calculateTxSize = async ({ speed, unspents, address, txOut = 2, method = 'send', fixed } = {}) => {\r\n  const defaultTxSize = constants.defaultFeeRates.next.size[method]\r\n\r\n  if (fixed) {\r\n    return defaultTxSize\r\n  }\r\n\r\n  unspents = unspents || await actions.next.fetchUnspents(address)\r\n\r\n\r\n  const txIn = unspents.length\r\n  const txSize = txIn > 0\r\n    ? txIn * 146 + txOut * 33 + (15 + txIn - txOut)\r\n    : defaultTxSize\r\n\r\n  if (method === 'send_multisig') {\r\n    const msuSize = getByteCount(\r\n      { 'MULTISIG-P2SH-P2WSH:2-2': 1 },\r\n      { 'P2PKH': (hasAdminFee) ? 3 : 2 }\r\n    )\r\n    const msutxSize = txIn * msuSize + txOut * 33 + (15 + txIn - txOut)\r\n\r\n    return msutxSize\r\n  }\r\n\r\n  if (method === 'send_2fa') {\r\n    const msSize = getByteCount(\r\n      { 'MULTISIG-P2SH-P2WSH:2-3': 1 },\r\n      { 'P2PKH': (hasAdminFee) ? 3 : 2 }\r\n    )\r\n    const mstxSize = txIn * msSize + txOut * 33 + (15 + txIn - txOut)\r\n\r\n    return mstxSize\r\n  }\r\n\r\n  return txSize\r\n}\r\n\r\ntype EstimateFeeValueOptions = {\r\n  method?: string\r\n  speed: 'fast' | 'normal' | 'slow'\r\n  feeRate?: number\r\n  inSatoshis?: boolean\r\n  address?: string\r\n  txSize?: number\r\n  fixed?: string\r\n}\r\n\r\nconst estimateFeeValue = async (options: EstimateFeeValueOptions) => {\r\n  let { feeRate, inSatoshis, speed, address, txSize, fixed, method } = options\r\n  const {\r\n    user: {\r\n      nextData,\r\n      nextMultisigSMSData,\r\n      nextMultisigUserData,\r\n    },\r\n  } = getState()\r\n\r\n  let txOut = 2\r\n\r\n  if (hasAdminFee) txOut = 3\r\n\r\n  if (!address) {\r\n    address = nextData.address\r\n    //@\r\n    if (method === 'send_2fa') address = nextMultisigSMS\r\n    if (method === 'send_multisig') address = nextMultisigUserData.address\r\n  }\r\n\r\n  //@\r\n  txSize = txSize || await calculateTxSize({ address, speed, fixed, method, txOut })\r\n  feeRate = feeRate || await estimateFeeRate({ speed })\r\n\r\n  const calculatedFeeValue = BigNumber.maximum(\r\n    DUST,\r\n    new BigNumber(feeRate)\r\n      .multipliedBy(txSize)\r\n      .div(1024) // divide by one kilobyte\r\n      .dp(0, BigNumber.ROUND_HALF_EVEN),\r\n  )\r\n\r\n  const CUSTOM_SATOSHI = 20\r\n  calculatedFeeValue.plus(CUSTOM_SATOSHI) // just wanted to add\r\n\r\n  const finalFeeValue = inSatoshis\r\n    ? calculatedFeeValue.toString()\r\n    : calculatedFeeValue.multipliedBy(1e-8).toString()\r\n\r\n  console.log(`Next withdraw fee speed(${speed}) method (${method}) ${finalFeeValue}`)\r\n  return finalFeeValue\r\n}\r\n\r\nconst estimateFeeRate = async ({ speed = 'fast' } = {}) => {\r\n  const link = config.feeRates.next\r\n  const defaultRate = constants.defaultFeeRates.next.rate\r\n\r\n  if (!link) {\r\n    return defaultRate[speed]\r\n  }\r\n\r\n  let apiResult\r\n\r\n  try {\r\n    apiResult = await request.get(link, { cacheResponse: 60000 })\r\n  } catch (err) {\r\n    console.error(`EstimateFeeRate: ${err.message}`)\r\n    return defaultRate[speed]\r\n  }\r\n\r\n  const apiSpeeds = {\r\n    slow: 'low_fee_per_kb',\r\n    normal: 'medium_fee_per_kb',\r\n    fast: 'high_fee_per_kb',\r\n  }\r\n\r\n\r\n  const apiSpeed = apiSpeeds[speed] || apiSpeeds.normal\r\n  const apiRate = new BigNumber(apiResult[apiSpeed])\r\n\r\n  return apiRate.isGreaterThanOrEqualTo(DUST)\r\n    ? apiRate.toString()\r\n    : defaultRate[speed]\r\n}\r\n\r\nexport default {\r\n  calculateTxSize,\r\n  estimateFeeValue,\r\n  estimateFeeRate,\r\n  network,\r\n  networks,\r\n}\r\n"]}]}