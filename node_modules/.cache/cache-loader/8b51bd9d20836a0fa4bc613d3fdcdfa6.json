{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\components\\modals\\WithdrawModal\\WithdrawModal.tsx","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\components\\modals\\WithdrawModal\\WithdrawModal.tsx","mtime":1614842914034},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9leHRlbmRzIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXh0ZW5kcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2Fzc2VydFRoaXNJbml0aWFsaXplZCBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZCI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0cyI7CmltcG9ydCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvdG9Db25zdW1hYmxlQXJyYXkiOwoKdmFyIF9kZWMsIF9kZWMyLCBfY2xhc3MsIF90ZW1wOwoKaW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3IiOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KCmZ1bmN0aW9uIF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7IGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gInVuZGVmaW5lZCIgfHwgIVJlZmxlY3QuY29uc3RydWN0KSByZXR1cm4gZmFsc2U7IGlmIChSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKSByZXR1cm4gZmFsc2U7IGlmICh0eXBlb2YgUHJveHkgPT09ICJmdW5jdGlvbiIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9CgppbXBvcnQgUmVhY3QsIHsgRnJhZ21lbnQgfSBmcm9tICdyZWFjdCc7CmltcG9ydCBjeCBmcm9tICdjbGFzc25hbWVzJzsKaW1wb3J0IGNzc01vZHVsZXMgZnJvbSAncmVhY3QtY3NzLW1vZHVsZXMnOwppbXBvcnQgc3R5bGVzIGZyb20gJy4vV2l0aGRyYXdNb2RhbC5zY3NzJzsKaW1wb3J0IGFjdGlvbnMgZnJvbSAncmVkdXgvYWN0aW9ucyc7CmltcG9ydCBMaW5rIGZyb20gJ2xvY2FsX21vZHVsZXMvc3ctdmFsdWVsaW5rJzsKaW1wb3J0IHsgY29ubmVjdCB9IGZyb20gJ3JlZGFjdGlvbic7CmltcG9ydCB0eXBlZm9yY2UgZnJvbSAnc3dhcC5hcHAvdXRpbC90eXBlZm9yY2UnOwppbXBvcnQgeyBCaWdOdW1iZXIgfSBmcm9tICdiaWdudW1iZXIuanMnOwppbXBvcnQgeyBGb3JtYXR0ZWRNZXNzYWdlLCBpbmplY3RJbnRsLCBkZWZpbmVNZXNzYWdlcyB9IGZyb20gJ3JlYWN0LWludGwnOwppbXBvcnQgeyBpc01vYmlsZSB9IGZyb20gJ3JlYWN0LWRldmljZS1kZXRlY3QnOwppbXBvcnQgeyBpbnB1dFJlcGxhY2VDb21tYVdpdGhEb3QgfSBmcm9tICdoZWxwZXJzL2RvbVV0aWxzJzsKaW1wb3J0IHsgbG9jYWxpc2VkVXJsIH0gZnJvbSAnaGVscGVycy9sb2NhbGUnOwppbXBvcnQgbWluQW1vdW50IGZyb20gJ2hlbHBlcnMvY29uc3RhbnRzL21pbkFtb3VudCc7CmltcG9ydCByZWRpcmVjdFRvIGZyb20gJ2hlbHBlcnMvcmVkaXJlY3RUbyc7CmltcG9ydCBnZXRDdXJyZW5jeUtleSBmcm9tICdoZWxwZXJzL2dldEN1cnJlbmN5S2V5JzsKaW1wb3J0IGxzRGF0YUNhY2hlIGZyb20gJ2hlbHBlcnMvbHNEYXRhQ2FjaGUnOwppbXBvcnQgaGVscGVycywgeyBjb25zdGFudHMsIGxpbmtzLCBhZG1pbkZlZSwgZmVlZGJhY2sgfSBmcm9tICdoZWxwZXJzJzsKaW1wb3J0IE1vZGFsIGZyb20gJ2NvbXBvbmVudHMvbW9kYWwvTW9kYWwvTW9kYWwnOwppbXBvcnQgRmllbGRMYWJlbCBmcm9tICdjb21wb25lbnRzL2Zvcm1zL0ZpZWxkTGFiZWwvRmllbGRMYWJlbCc7CmltcG9ydCBJbnB1dCBmcm9tICdjb21wb25lbnRzL2Zvcm1zL0lucHV0L0lucHV0JzsKaW1wb3J0IEJ1dHRvbiBmcm9tICdjb21wb25lbnRzL2NvbnRyb2xzL0J1dHRvbi9CdXR0b24nOwppbXBvcnQgVG9vbHRpcCBmcm9tICdjb21wb25lbnRzL3VpL1Rvb2x0aXAvVG9vbHRpcCc7CmltcG9ydCBRclJlYWRlciBmcm9tICdjb21wb25lbnRzL1FyUmVhZGVyJzsKaW1wb3J0IEludm9pY2VJbmZvQmxvY2sgZnJvbSAnY29tcG9uZW50cy9JbnZvaWNlSW5mb0Jsb2NrL0ludm9pY2VJbmZvQmxvY2snOwppbXBvcnQgQWRtaW5GZWVJbmZvQmxvY2sgZnJvbSAnY29tcG9uZW50cy9BZG1pbkZlZUluZm9CbG9jay9BZG1pbkZlZUluZm9CbG9jayc7CmltcG9ydCBDdXJyZW5jeUxpc3QgZnJvbSAnLi9jb21wb25lbnRzL0N1cnJlbmN5TGlzdCc7CmltcG9ydCBGZWVJbmZvQmxvY2sgZnJvbSAnLi9jb21wb25lbnRzL0ZlZUluZm9CbG9jayc7CnZhciBpc0RhcmsgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShjb25zdGFudHMubG9jYWxTdG9yYWdlLmlzRGFyayk7CnZhciBXaXRoZHJhd01vZGFsID0gKF9kZWMgPSBjb25uZWN0KGZ1bmN0aW9uIChfcmVmKSB7CiAgdmFyIGN1cnJlbmNpZXMgPSBfcmVmLmN1cnJlbmNpZXMsCiAgICAgIF9yZWYkdXNlciA9IF9yZWYudXNlciwKICAgICAgZXRoRGF0YSA9IF9yZWYkdXNlci5ldGhEYXRhLAogICAgICBidGNEYXRhID0gX3JlZiR1c2VyLmJ0Y0RhdGEsCiAgICAgIGdob3N0RGF0YSA9IF9yZWYkdXNlci5naG9zdERhdGEsCiAgICAgIG5leHREYXRhID0gX3JlZiR1c2VyLm5leHREYXRhLAogICAgICB0b2tlbnNEYXRhID0gX3JlZiR1c2VyLnRva2Vuc0RhdGEsCiAgICAgIGFjdGl2ZUZpYXQgPSBfcmVmJHVzZXIuYWN0aXZlRmlhdCwKICAgICAgaXNCYWxhbmNlRmV0Y2hpbmcgPSBfcmVmJHVzZXIuaXNCYWxhbmNlRmV0Y2hpbmcsCiAgICAgIGFjdGl2ZUN1cnJlbmN5ID0gX3JlZiR1c2VyLmFjdGl2ZUN1cnJlbmN5LAogICAgICBkYXNoYm9hcmRNb2RhbHNBbGxvd2VkID0gX3JlZi51aS5kYXNoYm9hcmRNb2RhbHNBbGxvd2VkOwogIHJldHVybiB7CiAgICBhY3RpdmVGaWF0OiBhY3RpdmVGaWF0LAogICAgYWN0aXZlQ3VycmVuY3k6IGFjdGl2ZUN1cnJlbmN5LAogICAgY3VycmVuY2llczogY3VycmVuY2llcy5pdGVtcywKICAgIGl0ZW1zOiBbZXRoRGF0YSwgYnRjRGF0YSwgZ2hvc3REYXRhLCBuZXh0RGF0YV0sCiAgICB0b2tlbkl0ZW1zOiBfdG9Db25zdW1hYmxlQXJyYXkoT2JqZWN0LmtleXModG9rZW5zRGF0YSkubWFwKGZ1bmN0aW9uIChrKSB7CiAgICAgIHJldHVybiB0b2tlbnNEYXRhW2tdOwogICAgfSkpLAogICAgZGFzaGJvYXJkVmlldzogZGFzaGJvYXJkTW9kYWxzQWxsb3dlZCwKICAgIGlzQmFsYW5jZUZldGNoaW5nOiBpc0JhbGFuY2VGZXRjaGluZwogIH07Cn0pLCBfZGVjMiA9IGNzc01vZHVsZXMoc3R5bGVzLCB7CiAgYWxsb3dNdWx0aXBsZTogdHJ1ZQp9KSwgaW5qZWN0SW50bChfY2xhc3MgPSBfZGVjKF9jbGFzcyA9IF9kZWMyKF9jbGFzcyA9IChfdGVtcCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkgewogIF9pbmhlcml0cyhXaXRoZHJhd01vZGFsLCBfUmVhY3QkQ29tcG9uZW50KTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihXaXRoZHJhd01vZGFsKTsKCiAgZnVuY3Rpb24gV2l0aGRyYXdNb2RhbChwcm9wcykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXaXRoZHJhd01vZGFsKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJtb3VudGVkIiwgdHJ1ZSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiYnRjRmVlVGltZXIiLCBudWxsKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJyZXBvcnRFcnJvciIsIGZ1bmN0aW9uIChlcnJvcikgewogICAgICB2YXIgZGV0YWlscyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogJy0nOwogICAgICBmZWVkYmFjay53aXRoZHJhdy5mYWlsZWQoImRldGFpbHMoIi5jb25jYXQoZGV0YWlscywgIikgOiBlcnJvciBtZXNzYWdlKCIpLmNvbmNhdChlcnJvci5tZXNzYWdlLCAiKSIpKTsKICAgICAgY29uc29sZS5lcnJvcigiV2l0aGRyYXcuIGRldGFpbHMoIi5jb25jYXQoZGV0YWlscywgIikgOiBlcnJvcigiKS5jb25jYXQoSlNPTi5zdHJpbmdpZnkoZXJyb3IpLCAiKSIpKTsKCiAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICBkZXZFcnJvcjogewogICAgICAgICAgbmFtZTogZXJyb3IubmFtZSB8fCAnRXJyb3InLAogICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB8fCAnLScKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic2V0Q3VycmVuY3RBY3RpdmVBc3NldCIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF90aGlzJHByb3BzID0gX3RoaXMucHJvcHMsCiAgICAgICAgICBpdGVtcyA9IF90aGlzJHByb3BzLml0ZW1zLAogICAgICAgICAgdG9rZW5JdGVtcyA9IF90aGlzJHByb3BzLnRva2VuSXRlbXMsCiAgICAgICAgICBkYXRhID0gX3RoaXMkcHJvcHMuZGF0YTsKICAgICAgdmFyIGFsbEN1cnJlbmN5aWVzID0gaXRlbXMuY29uY2F0KHRva2VuSXRlbXMpOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGN1cnJlbnRBY3RpdmVBc3NldDogZGF0YSwKICAgICAgICBhbGxDdXJyZW5jeWllczogYWxsQ3VycmVuY3lpZXMKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzZXRCdGNGZWVSYXRlIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0ZSwgX3RoaXMkc3RhdGUkc2VsZWN0ZWRJLCBhZGRyZXNzLCBpc1VzZXJQcm90ZWN0ZWQsIGlzU21zUHJvdGVjdGVkLCBpc1BpblByb3RlY3RlZCwgY3VycmVudERlY2ltYWxzLCBhbW91bnQsIG1ldGhvZCwgQllURV9JTl9LQiwgbnVtQW1vdW50LCBfeWllbGQkaGVscGVycyRidGMkZXMsIGZlZVJhdGUsIHR4U2l6ZSwgZmVlLCBmZWVTYXRCeXRlOwoKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfdGhpcyRzdGF0ZSA9IF90aGlzLnN0YXRlLCBfdGhpcyRzdGF0ZSRzZWxlY3RlZEkgPSBfdGhpcyRzdGF0ZS5zZWxlY3RlZEl0ZW0sIGFkZHJlc3MgPSBfdGhpcyRzdGF0ZSRzZWxlY3RlZEkuYWRkcmVzcywgaXNVc2VyUHJvdGVjdGVkID0gX3RoaXMkc3RhdGUkc2VsZWN0ZWRJLmlzVXNlclByb3RlY3RlZCwgaXNTbXNQcm90ZWN0ZWQgPSBfdGhpcyRzdGF0ZSRzZWxlY3RlZEkuaXNTbXNQcm90ZWN0ZWQsIGlzUGluUHJvdGVjdGVkID0gX3RoaXMkc3RhdGUkc2VsZWN0ZWRJLmlzUGluUHJvdGVjdGVkLCBjdXJyZW50RGVjaW1hbHMgPSBfdGhpcyRzdGF0ZS5jdXJyZW50RGVjaW1hbHMsIGFtb3VudCA9IF90aGlzJHN0YXRlLmFtb3VudDsKICAgICAgICAgICAgICBtZXRob2QgPSAic2VuZCI7CiAgICAgICAgICAgICAgaWYgKGlzVXNlclByb3RlY3RlZCkgbWV0aG9kID0gInNlbmRfbXVsdGlzaWciOwogICAgICAgICAgICAgIGlmIChpc1Ntc1Byb3RlY3RlZCB8fCBpc1BpblByb3RlY3RlZCkgbWV0aG9kID0gInNlbmRfMmZhIjsKICAgICAgICAgICAgICBCWVRFX0lOX0tCID0gMTAyNDsKICAgICAgICAgICAgICBudW1BbW91bnQgPSBOdW1iZXIoYW1vdW50KSB8fCAwOwogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA2OwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgIHJldHVybiBoZWxwZXJzLmJ0Yy5lc3RpbWF0ZUZlZVZhbHVlKHsKICAgICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kLAogICAgICAgICAgICAgICAgc3BlZWQ6ICdmYXN0JywKICAgICAgICAgICAgICAgIGFkZHJlc3M6IGFkZHJlc3MsCiAgICAgICAgICAgICAgICBhbW91bnQ6IG51bUFtb3VudCwKICAgICAgICAgICAgICAgIG1vcmVJbmZvOiB0cnVlCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgX3lpZWxkJGhlbHBlcnMkYnRjJGVzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBmZWVSYXRlID0gX3lpZWxkJGhlbHBlcnMkYnRjJGVzLmZlZVJhdGU7CiAgICAgICAgICAgICAgdHhTaXplID0gX3lpZWxkJGhlbHBlcnMkYnRjJGVzLnR4U2l6ZTsKICAgICAgICAgICAgICBmZWUgPSBfeWllbGQkaGVscGVycyRidGMkZXMuZmVlOwogICAgICAgICAgICAgIGZlZVNhdEJ5dGUgPSBuZXcgQmlnTnVtYmVyKGZlZVJhdGUpLmRpdmlkZWRCeShCWVRFX0lOX0tCKS5kcCgwLCBCaWdOdW1iZXIuUk9VTkRfQ0VJTCkudG9OdW1iZXIoKTsKCiAgICAgICAgICAgICAgaWYgKF90aGlzLm1vdW50ZWQpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgYnRjRmVlUmF0ZTogZmVlU2F0Qnl0ZSwKICAgICAgICAgICAgICAgICAgdHhTaXplOiB0eFNpemUsCiAgICAgICAgICAgICAgICAgIGZlZXM6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgc3RhdGUuZmVlcyksIHt9LCB7CiAgICAgICAgICAgICAgICAgICAgbWluZXI6IG5ldyBCaWdOdW1iZXIoZmVlKSwKICAgICAgICAgICAgICAgICAgICB0b3RhbDogc3RhdGUuZmVlcy5zZXJ2aWNlLnBsdXMoZmVlKS5kcChjdXJyZW50RGVjaW1hbHMsIEJpZ051bWJlci5ST1VORF9DRUlMKQogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTk7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSg2KTsKCiAgICAgICAgICAgICAgX3RoaXMucmVwb3J0RXJyb3IoX2NvbnRleHQudDApOwoKICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1s2LCAxOV1dKTsKICAgIH0pKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic2V0Q29tbWlzc2lvbnMiLCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgIHZhciBjdXJyZW5jeSwgX3RoaXMkc3RhdGUyLCBpc0V0aFRva2VuLCBzZWxlY3RlZEl0ZW0sIHVzZWRBZG1pbkZlZSwgYW1vdW50LCBjdXJyZW50RGVjaW1hbHMsIGN1cnJlbnRDb2luLCBhZG1pbkZlZVNpemUsIG5ld01pbmVyRmVlLCBtZXRob2Q7CgogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjdXJyZW5jeSA9IF90aGlzLnByb3BzLmRhdGEuY3VycmVuY3k7CiAgICAgICAgICAgICAgX3RoaXMkc3RhdGUyID0gX3RoaXMuc3RhdGUsIGlzRXRoVG9rZW4gPSBfdGhpcyRzdGF0ZTIuaXNFdGhUb2tlbiwgc2VsZWN0ZWRJdGVtID0gX3RoaXMkc3RhdGUyLnNlbGVjdGVkSXRlbSwgdXNlZEFkbWluRmVlID0gX3RoaXMkc3RhdGUyLnVzZWRBZG1pbkZlZSwgYW1vdW50ID0gX3RoaXMkc3RhdGUyLmFtb3VudCwgY3VycmVudERlY2ltYWxzID0gX3RoaXMkc3RhdGUyLmN1cnJlbnREZWNpbWFsczsKICAgICAgICAgICAgICBjdXJyZW50Q29pbiA9IGdldEN1cnJlbmN5S2V5KGN1cnJlbmN5LCB0cnVlKS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgIGFkbWluRmVlU2l6ZSA9IHVzZWRBZG1pbkZlZSA/IGFkbWluRmVlLmNhbGMoY3VycmVuY3ksIGFtb3VudCkgOiAwOwogICAgICAgICAgICAgIG5ld01pbmVyRmVlID0gbmV3IEJpZ051bWJlcigwKTsKCiAgICAgICAgICAgICAgaWYgKF90aGlzLm1vdW50ZWQpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGZldGNoRmVlOiB0cnVlCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gODsKCiAgICAgICAgICAgICAgaWYgKCFpc0V0aFRva2VuKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAvLyBpZiBkZWNpbWFscyA8IDcgdGhlbiBlcXVhbCAwLjAuLi4xCiAgICAgICAgICAgICAgLy8gaWYgZGVjaW1hbHMgPj0gNyB0aGVuIGVxdWFsIDFlLTxkZWNpbWFscz4KICAgICAgICAgICAgICBtaW5BbW91bnRbY3VycmVudENvaW5dID0gTWF0aC5wb3coMTAsIC1jdXJyZW50RGVjaW1hbHMpOwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgcmV0dXJuIGhlbHBlcnMuZXRoLmVzdGltYXRlRmVlVmFsdWUoewogICAgICAgICAgICAgICAgbWV0aG9kOiAnc2VuZCcsCiAgICAgICAgICAgICAgICBzcGVlZDogJ2Zhc3QnCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIG1pbkFtb3VudC5ldGggPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBCaWdOdW1iZXI7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNzsKICAgICAgICAgICAgICByZXR1cm4gaGVscGVycy5ldGhUb2tlbi5lc3RpbWF0ZUZlZVZhbHVlKHsKICAgICAgICAgICAgICAgIG1ldGhvZDogJ3NlbmQnLAogICAgICAgICAgICAgICAgc3BlZWQ6ICdmYXN0JwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICBfY29udGV4dDIudDEgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICBuZXdNaW5lckZlZSA9IG5ldyBfY29udGV4dDIudDAoX2NvbnRleHQyLnQxKTsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDMyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICBpZiAoIWNvbnN0YW50cy5jb2luc1dpdGhEeW5hbWljRmVlLmluY2x1ZGVzKGN1cnJlbnRDb2luKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbWV0aG9kID0gJ3NlbmQnOwogICAgICAgICAgICAgIGlmIChzZWxlY3RlZEl0ZW0uaXNVc2VyUHJvdGVjdGVkKSBtZXRob2QgPSAnc2VuZF9tdWx0aXNpZyc7CiAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkSXRlbS5pc1BpblByb3RlY3RlZCB8fCBzZWxlY3RlZEl0ZW0uaXNTbXNQcm90ZWN0ZWQpIG1ldGhvZCA9ICdzZW5kXzJmYSc7CiAgICAgICAgICAgICAgX2NvbnRleHQyLnQyID0gQmlnTnVtYmVyOwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjg7CiAgICAgICAgICAgICAgcmV0dXJuIGhlbHBlcnNbY3VycmVudENvaW5dLmVzdGltYXRlRmVlVmFsdWUoewogICAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2QsCiAgICAgICAgICAgICAgICBzcGVlZDogJ2Zhc3QnLAogICAgICAgICAgICAgICAgYWRkcmVzczogc2VsZWN0ZWRJdGVtLmFkZHJlc3MsCiAgICAgICAgICAgICAgICBhbW91bnQ6IGFtb3VudAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgICBfY29udGV4dDIudDMgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICBuZXdNaW5lckZlZSA9IG5ldyBfY29udGV4dDIudDIoX2NvbnRleHQyLnQzKTsKICAgICAgICAgICAgICBtaW5BbW91bnRbY3VycmVudENvaW5dID0gbmV3TWluZXJGZWUudG9OdW1iZXIoKTsKCiAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkSXRlbS5pc0JUQykgewogICAgICAgICAgICAgICAgX3RoaXMuc2V0QnRjRmVlUmF0ZSgpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHN0YXRlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICBmZWVzOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlLmZlZXMpLCB7fSwgewogICAgICAgICAgICAgICAgICAgIG1pbmVyOiBuZXdNaW5lckZlZSwKICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlOiBuZXcgQmlnTnVtYmVyKGFkbWluRmVlU2l6ZSkuZHAoY3VycmVudERlY2ltYWxzLCBCaWdOdW1iZXIuUk9VTkRfQ0VJTCksCiAgICAgICAgICAgICAgICAgICAgdG90YWw6IG5ld01pbmVyRmVlLnBsdXMoYWRtaW5GZWVTaXplKS5kcChjdXJyZW50RGVjaW1hbHMsIEJpZ051bWJlci5ST1VORF9DRUlMKSwKICAgICAgICAgICAgICAgICAgICBhZG1pbkZlZVNpemU6IG5ldyBCaWdOdW1iZXIoYWRtaW5GZWVTaXplKQogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0QWxvd2VkQmFsYW5jZXMoKTsKCiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMzY6CiAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAzNjsKICAgICAgICAgICAgICBfY29udGV4dDIudDQgPSBfY29udGV4dDJbImNhdGNoIl0oOCk7CgogICAgICAgICAgICAgIF90aGlzLnJlcG9ydEVycm9yKF9jb250ZXh0Mi50NCk7CgogICAgICAgICAgICBjYXNlIDM5OgogICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMzk7CgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGZldGNoRmVlOiBmYWxzZQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmZpbmlzaCgzOSk7CgogICAgICAgICAgICBjYXNlIDQyOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbOCwgMzYsIDM5LCA0Ml1dKTsKICAgIH0pKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlU3VibWl0IiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICB2YXIgX3RoaXMkc3RhdGUzLCB0bywgYW1vdW50LCBvd25UeCwgZmVlcywgc2VsZWN0ZWRJdGVtLCBpc0V0aFRva2VuLCBfdGhpcyRzdGF0ZTMkY29tbWVudCwgY29tbWVudCwgX3RoaXMkcHJvcHMyLCBfdGhpcyRwcm9wczIkZGF0YSwgY3VycmVuY3ksIGFkZHJlc3MsIGludm9pY2UsIG9uUmVhZHksIG5hbWUsIHNlbmRPcHRpb25zLCBiZWZvcmVCYWxhbmNlcywgbmV4dFN0ZXBNb2RhbDsKCiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGZlZWRiYWNrLndpdGhkcmF3LnN0YXJ0ZWQoKTsKICAgICAgICAgICAgICBfdGhpcyRzdGF0ZTMgPSBfdGhpcy5zdGF0ZSwgdG8gPSBfdGhpcyRzdGF0ZTMuYWRkcmVzcywgYW1vdW50ID0gX3RoaXMkc3RhdGUzLmFtb3VudCwgb3duVHggPSBfdGhpcyRzdGF0ZTMub3duVHgsIGZlZXMgPSBfdGhpcyRzdGF0ZTMuZmVlcywgc2VsZWN0ZWRJdGVtID0gX3RoaXMkc3RhdGUzLnNlbGVjdGVkSXRlbSwgaXNFdGhUb2tlbiA9IF90aGlzJHN0YXRlMy5pc0V0aFRva2VuLCBfdGhpcyRzdGF0ZTMkY29tbWVudCA9IF90aGlzJHN0YXRlMy5jb21tZW50LCBjb21tZW50ID0gX3RoaXMkc3RhdGUzJGNvbW1lbnQgPT09IHZvaWQgMCA/ICcnIDogX3RoaXMkc3RhdGUzJGNvbW1lbnQ7CiAgICAgICAgICAgICAgX3RoaXMkcHJvcHMyID0gX3RoaXMucHJvcHMsIF90aGlzJHByb3BzMiRkYXRhID0gX3RoaXMkcHJvcHMyLmRhdGEsIGN1cnJlbmN5ID0gX3RoaXMkcHJvcHMyJGRhdGEuY3VycmVuY3ksIGFkZHJlc3MgPSBfdGhpcyRwcm9wczIkZGF0YS5hZGRyZXNzLCBpbnZvaWNlID0gX3RoaXMkcHJvcHMyJGRhdGEuaW52b2ljZSwgb25SZWFkeSA9IF90aGlzJHByb3BzMiRkYXRhLm9uUmVhZHksIG5hbWUgPSBfdGhpcyRwcm9wczIubmFtZTsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgaXNTaGlwcGVkOiB0cnVlLAogICAgICAgICAgICAgICAgICBkZXZFcnJvcjogbnVsbAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgc2VuZE9wdGlvbnMgPSB7CiAgICAgICAgICAgICAgICBmcm9tOiBhZGRyZXNzLAogICAgICAgICAgICAgICAgdG86IHRvLAogICAgICAgICAgICAgICAgYW1vdW50OiBhbW91bnQsCiAgICAgICAgICAgICAgICBzcGVlZDogJ2Zhc3QnLAogICAgICAgICAgICAgICAgbmFtZTogaXNFdGhUb2tlbiA/IGN1cnJlbmN5LnRvTG93ZXJDYXNlKCkgOiAnJwogICAgICAgICAgICAgIH07IC8vID8gaXMgaXQgbmVlZCA/CiAgICAgICAgICAgICAgLy8g0J7Qv9GA0LDRiNC40LLQsNC10Lwg0LHQsNC70LDQvdGB0Ysg0L7RgtC/0YDQsNCy0LjRgtC10LvRjyDQuCDQv9C+0LvRg9GH0LDRgtC10LvRjyDQvdCwINC80L7QvNC10L3RgiDQstGL0L/QvtC70L3QtdC90LjRjyDRgtGA0LDQvdC30LDQutGG0LjQuAogICAgICAgICAgICAgIC8vINCd0YPQttC90L4g0LTQu9GPINGA0LDRgdGH0LXRgtCwIGZpbmFsIGJhbGFuY2Ug0L/QvtC70YPRh9Cw0YLQtdC70Y8g0Lgg0L7RgtC/0YDQsNCy0LjRgtC10LvRjwoKICAgICAgICAgICAgICBiZWZvcmVCYWxhbmNlcyA9IGZhbHNlOyAvLyB0cnkgewogICAgICAgICAgICAgIC8vICAgLy8gYmVmb3JlQmFsYW5jZXMgPSBhd2FpdCBoZWxwZXJzLnRyYW5zYWN0aW9ucy5nZXRUeEJhbGFuY2VzKGN1cnJlbmN5LCBhZGRyZXNzLCB0bykKICAgICAgICAgICAgICAvLyB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgIC8vICAgdGhpcy5yZXBvcnRFcnJvcihlcnJvciwgJ0ZhaWwgZmV0Y2ggYmFsYW5jZXMgLSBtYXkgYmUgZGVzdGluYXRpb24gaXMgc2Vnd2l0JykKICAgICAgICAgICAgICAvLyB9CgogICAgICAgICAgICAgIGlmICghKGludm9pY2UgJiYgb3duVHgpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDk7CiAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnMuaW52b2ljZXMubWFya0ludm9pY2UoaW52b2ljZS5pZCwgJ3JlYWR5Jywgb3duVHgsIGFkZHJlc3MpOwoKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIGFjdGlvbnMubG9hZGVyLmhpZGUoKTsKICAgICAgICAgICAgICBhY3Rpb25zLm5vdGlmaWNhdGlvbnMuc2hvdyhjb25zdGFudHMubm90aWZpY2F0aW9ucy5TdWNjZXNzV2l0aGRyYXcsIHsKICAgICAgICAgICAgICAgIGFtb3VudDogYW1vdW50LAogICAgICAgICAgICAgICAgY3VycmVuY3k6IGN1cnJlbmN5LAogICAgICAgICAgICAgICAgYWRkcmVzczogdG8KICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgaXNTaGlwcGVkOiBmYWxzZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgYWN0aW9ucy5tb2RhbHMuY2xvc2UobmFtZSk7CgogICAgICAgICAgICAgIGlmIChvblJlYWR5IGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgICAgICAgIG9uUmVhZHkoKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgaWYgKCEoc2VsZWN0ZWRJdGVtLmlzUGluUHJvdGVjdGVkIHx8IHNlbGVjdGVkSXRlbS5pc1Ntc1Byb3RlY3RlZCB8fCBzZWxlY3RlZEl0ZW0uaXNVc2VyUHJvdGVjdGVkKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbmV4dFN0ZXBNb2RhbCA9IGNvbnN0YW50cy5tb2RhbHMuV2l0aGRyYXdCdGNQaW47CiAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkSXRlbS5pc1Ntc1Byb3RlY3RlZCkgbmV4dFN0ZXBNb2RhbCA9IGNvbnN0YW50cy5tb2RhbHMuV2l0aGRyYXdCdGNTbXM7CiAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkSXRlbS5pc1VzZXJQcm90ZWN0ZWQpIG5leHRTdGVwTW9kYWwgPSBjb25zdGFudHMubW9kYWxzLldpdGhkcmF3QnRjTXVsdGlzaWc7CiAgICAgICAgICAgICAgYWN0aW9ucy5tb2RhbHMuY2xvc2UobmFtZSk7CiAgICAgICAgICAgICAgYWN0aW9ucy5tb2RhbHMub3BlbihuZXh0U3RlcE1vZGFsLCB7CiAgICAgICAgICAgICAgICB3YWxsZXQ6IHNlbGVjdGVkSXRlbSwKICAgICAgICAgICAgICAgIGludm9pY2U6IGludm9pY2UsCiAgICAgICAgICAgICAgICBzZW5kT3B0aW9uczogc2VuZE9wdGlvbnMsCiAgICAgICAgICAgICAgICBiZWZvcmVCYWxhbmNlczogYmVmb3JlQmFsYW5jZXMsCiAgICAgICAgICAgICAgICBvblJlYWR5OiBvblJlYWR5LAogICAgICAgICAgICAgICAgYWRtaW5GZWU6IGZlZXMuYWRtaW5GZWVTaXplCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDI0OwogICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zW2N1cnJlbmN5LnRvTG93ZXJDYXNlKCldLnNlbmQoc2VuZE9wdGlvbnMpLnRoZW4oIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgX3JlZjUgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyh0eFJhdykgewogICAgICAgICAgICAgICAgICB2YXIgdHhJbmZvLCB0eElkLCB0eEluZm9DYWNoZSwgdHhJbmZvVXJsOwogICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zLmxvYWRlci5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc1tjdXJyZW5jeS50b0xvd2VyQ2FzZSgpXS5nZXRCYWxhbmNlKGN1cnJlbmN5KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpbnZvaWNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9ucy5pbnZvaWNlcy5tYXJrSW52b2ljZShpbnZvaWNlLmlkLCAncmVhZHknLCB0eFJhdywgYWRkcmVzcyk7CgogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTaGlwcGVkOiBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob25SZWFkeSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblJlYWR5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSAvLyBSZWRpcmVjdCB0byB0eAoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgdHhJbmZvID0gaGVscGVycy50cmFuc2FjdGlvbnMuZ2V0SW5mbyhjdXJyZW5jeS50b0xvd2VyQ2FzZSgpLCB0eFJhdyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdHhJZCA9IHR4SW5mby50eDsgLy8g0J3QtSDQuNGB0L/QvtC70YzQt9GD0LXQvCBhd2FpdC4g0KHQsdGA0LDRgdGL0LLQsNC10Lwg0YHRgtCw0YLQuNGB0YLQuNC60YMg0L/QviDRgtGA0LDQvdC30LDQutGG0LjQuCAoZmluYWwgYmFsYW5jZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDQkdC10Lcg0LHQu9C+0LrQuNGA0L7QstC60Lgg0LrQu9C40LXQvdGC0LAKICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDQoNC10LfRg9C70YzRgtCw0YIg0Lgg0YPRgdC/0LXRiNC90L7RgdGC0Ywg0LfQsNC/0YDQvtGB0LAg0LrRgNC40YLQuNGH0LXRgdC60L7Qs9C+INC30L3QsNGH0LXQvdC40Y8g0L3QtSDQuNC80LXRjtGCCgogICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlcnMudHJhbnNhY3Rpb25zLnB1bGxUeEJhbGFuY2VzKHR4SWQsIGFtb3VudCwgYmVmb3JlQmFsYW5jZXMsIGFkbWluRmVlKTsgLy8g0KHQvtGF0YDQsNC90Y/QtdC8INGC0YDQsNC90LfQsNC60YbQuNGOINCyINC60LXRiAoKICAgICAgICAgICAgICAgICAgICAgICAgICB0eEluZm9DYWNoZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtb3VudDogYW1vdW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZGVyQWRkcmVzczogYWRkcmVzcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VpdmVyQWRkcmVzczogdG8sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRtaW5GZWU6IGZlZXMuYWRtaW5GZWVTaXplCiAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICBsc0RhdGFDYWNoZS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleTogIlR4SW5mb18iLmNvbmNhdChjdXJyZW5jeS50b0xvd2VyQ2FzZSgpLCAiXyIpLmNvbmNhdCh0eElkKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWU6IDM2MDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB0eEluZm9DYWNoZQogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgIGZlZWRiYWNrLndpdGhkcmF3LmZpbmlzaGVkKCk7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21tZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zLmNvbW1lbnRzLnNldENvbW1lbnQoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IHR4SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnQ6IGNvbW1lbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgdHhJbmZvVXJsID0gaGVscGVycy50cmFuc2FjdGlvbnMuZ2V0VHhSb3V0ZXIoY3VycmVuY3kudG9Mb3dlckNhc2UoKSwgdHhJZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3RUbyh0eEluZm9VcmwpOwoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmNS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9KCkpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgYWN0aW9ucy5tb2RhbHMuY2xvc2UobmFtZSk7CiAgICAgICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRJdGVtID0gX3RoaXMuc3RhdGUuc2VsZWN0ZWRJdGVtOwogICAgICAgICAgICAgICAgdmFyIGVycm9yVGV4dCA9IGVycm9yLnJlcyA/IGVycm9yLnJlcy50ZXh0IDogJyc7CiAgICAgICAgICAgICAgICB2YXIgY3VzdG9tRXJyb3IgPSB7CiAgICAgICAgICAgICAgICAgIG5hbWU6IHsKICAgICAgICAgICAgICAgICAgICBpZDogJ1dpdGhkcmF3MjE4JywKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ1dpdGhkcmF3YWwgZXJyb3InCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHsKICAgICAgICAgICAgICAgICAgICBpZDogJ0Vycm9yTm90aWZpY2F0aW9uMTInLAogICAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnT29wcywgbG9va3MgbGlrZSBzb21ldGhpbmcgd2VudCB3cm9uZyEnCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgaWYgKC9pbnN1ZmZpY2llbnQgcHJpb3JpdHl8YmFkLXR4bnMtaW5wdXRzLWR1cGxpY2F0ZS8udGVzdChlcnJvclRleHQpKSB7CiAgICAgICAgICAgICAgICAgIGN1c3RvbUVycm9yLm1lc3NhZ2UgPSB7CiAgICAgICAgICAgICAgICAgICAgaWQ6ICdXaXRoZHJhdzIzMicsCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICdUaGVyZSBpcyBub3QgZW5vdWdoIGNvbmZpcm1hdGlvbiBvZiB0aGUgbGFzdCB0cmFuc2FjdGlvbi4gVHJ5IGxhdGVyLicKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpcy5yZXBvcnRFcnJvcihlcnJvciwgInNlbGVjdGVkIGl0ZW06ICIuY29uY2F0KHNlbGVjdGVkSXRlbS5mdWxsTmFtZSwgIiB8IGN1c3RvbSBtZXNzYWdlOiAiKS5jb25jYXQoY3VzdG9tRXJyb3IubWVzc2FnZS5kZWZhdWx0TWVzc2FnZSkpOwoKICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICBpc1NoaXBwZWQ6IGZhbHNlCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlNCk7CiAgICB9KSkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgIm9wZW5TY2FuIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgb3BlblNjYW5DYW0gPSBfdGhpcy5zdGF0ZS5vcGVuU2NhbkNhbTsKCiAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgb3BlblNjYW5DYW06ICFvcGVuU2NhbkNhbQogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlU2NhbiIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgdmFyIGFkZHJlc3MgPSBkYXRhLnNwbGl0KCc6JylbMV0uc3BsaXQoJz8nKVswXTsKICAgICAgICB2YXIgYW1vdW50ID0gZGF0YS5zcGxpdCgnPScpWzFdOwoKICAgICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBhZGRyZXNzOiBhZGRyZXNzLAogICAgICAgICAgICBhbW91bnQ6IGFtb3VudAogICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMub3BlblNjYW4oKTsKICAgICAgfQogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlQW1vdW50IiwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0ZTQgPSBfdGhpcy5zdGF0ZSwKICAgICAgICAgIGN1cnJlbnRBY3RpdmVBc3NldCA9IF90aGlzJHN0YXRlNC5jdXJyZW50QWN0aXZlQXNzZXQsCiAgICAgICAgICBjdXJyZW50RGVjaW1hbHMgPSBfdGhpcyRzdGF0ZTQuY3VycmVudERlY2ltYWxzLAogICAgICAgICAgZXhDdXJyZW5jeVJhdGUgPSBfdGhpcyRzdGF0ZTQuZXhDdXJyZW5jeVJhdGUsCiAgICAgICAgICBzZWxlY3RlZFZhbHVlID0gX3RoaXMkc3RhdGU0LnNlbGVjdGVkVmFsdWUsCiAgICAgICAgICBpc0JUQyA9IF90aGlzJHN0YXRlNC5zZWxlY3RlZEl0ZW0uaXNCVEM7CgogICAgICBpZiAoaXNCVEMpIHsKICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXMuYnRjRmVlVGltZXIpOwogICAgICAgIF90aGlzLmJ0Y0ZlZVRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5zZXRCdGNGZWVSYXRlKCk7CiAgICAgICAgfSwgMjAwMCk7CiAgICAgIH0KCiAgICAgIHZhciBoYXNFeEN1cnJlbmN5UmF0ZSA9IGV4Q3VycmVuY3lSYXRlLmlzR3JlYXRlclRoYW4oMCk7CgogICAgICBpZiAoc2VsZWN0ZWRWYWx1ZSA9PT0gY3VycmVudEFjdGl2ZUFzc2V0LmN1cnJlbmN5KSB7CiAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgZmlhdEFtb3VudDogdmFsdWUgJiYgaGFzRXhDdXJyZW5jeVJhdGUgPyBleEN1cnJlbmN5UmF0ZS50aW1lcyh2YWx1ZSkuZHAoMiwgQmlnTnVtYmVyLlJPVU5EX0NFSUwpLnRvU3RyaW5nKCkgOiAnJywKICAgICAgICAgIGFtb3VudDogdmFsdWUKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICBmaWF0QW1vdW50OiB2YWx1ZSwKICAgICAgICAgIGFtb3VudDogdmFsdWUgJiYgaGFzRXhDdXJyZW5jeVJhdGUgPyBuZXcgQmlnTnVtYmVyKHZhbHVlKS5kaXYoZXhDdXJyZW5jeVJhdGUpLmRwKGN1cnJlbnREZWNpbWFscykudG9TdHJpbmcoKSA6ICcnCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImhhbmRsZUNsb3NlIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3RoaXMkcHJvcHMzID0gX3RoaXMucHJvcHMsCiAgICAgICAgICBoaXN0b3J5ID0gX3RoaXMkcHJvcHMzLmhpc3RvcnksCiAgICAgICAgICBsb2NhbGUgPSBfdGhpcyRwcm9wczMuaW50bC5sb2NhbGU7CiAgICAgIHZhciBuYW1lID0gX3RoaXMucHJvcHMubmFtZTsKICAgICAgaGlzdG9yeS5wdXNoKGxvY2FsaXNlZFVybChsb2NhbGUsIGxpbmtzLmhvbWUpKTsKICAgICAgYWN0aW9ucy5tb2RhbHMuY2xvc2UobmFtZSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJoYW5kbGVCdXlDdXJyZW5jeVNlbGVjdCIsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgc2VsZWN0ZWRWYWx1ZTogdmFsdWUKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJzZXRBbG93ZWRCYWxhbmNlcyIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF90aGlzJHN0YXRlNSA9IF90aGlzLnN0YXRlLAogICAgICAgICAgaXNFdGhUb2tlbiA9IF90aGlzJHN0YXRlNS5pc0V0aFRva2VuLAogICAgICAgICAgdXNlZEFkbWluRmVlID0gX3RoaXMkc3RhdGU1LnVzZWRBZG1pbkZlZSwKICAgICAgICAgIGN1cnJlbnREZWNpbWFscyA9IF90aGlzJHN0YXRlNS5jdXJyZW50RGVjaW1hbHMsCiAgICAgICAgICBleEN1cnJlbmN5UmF0ZSA9IF90aGlzJHN0YXRlNS5leEN1cnJlbmN5UmF0ZSwKICAgICAgICAgIGJhbGFuY2VzID0gX3RoaXMkc3RhdGU1LmJhbGFuY2VzLAogICAgICAgICAgZmVlcyA9IF90aGlzJHN0YXRlNS5mZWVzOwogICAgICB2YXIgT05FX0hVTkRSRURfUEVSQ0VOVCA9IDEwMDsKICAgICAgdmFyIG1pbmVyRmVlID0gaXNFdGhUb2tlbiA/IG5ldyBCaWdOdW1iZXIoMCkgOiBmZWVzLm1pbmVyOwogICAgICB2YXIgbWF4U2VydmljZSA9IHVzZWRBZG1pbkZlZSA/IG5ldyBCaWdOdW1iZXIodXNlZEFkbWluRmVlLmZlZSkuZGl2aWRlZEJ5KE9ORV9IVU5EUkVEX1BFUkNFTlQpLm11bHRpcGxpZWRCeShiYWxhbmNlcy5iYWxhbmNlKSA6IG5ldyBCaWdOdW1iZXIoMCk7CiAgICAgIHZhciBtYXhBbW91bnQgPSBiYWxhbmNlcy5iYWxhbmNlLm1pbnVzKG1pbmVyRmVlKS5taW51cyhtYXhTZXJ2aWNlKS5kcChjdXJyZW50RGVjaW1hbHMsIEJpZ051bWJlci5ST1VORF9DRUlMKTsKICAgICAgdmFyIG1heEZpYXRBbW91bnQgPSBtYXhBbW91bnQubXVsdGlwbGllZEJ5KGV4Q3VycmVuY3lSYXRlKS5kcCgyLCBCaWdOdW1iZXIuUk9VTkRfQ0VJTCk7CgogICAgICBpZiAobWF4QW1vdW50LmlzR3JlYXRlclRoYW4oYmFsYW5jZXMuYmFsYW5jZSkgfHwgbWF4QW1vdW50LmlzTGVzc1RoYW5PckVxdWFsVG8oMCkpIHsKICAgICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAoc3RhdGUpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGJhbGFuY2VzOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlLmJhbGFuY2VzKSwge30sIHsKICAgICAgICAgICAgICBhbGxvd2VkQ3VycmVuY3k6IG5ldyBCaWdOdW1iZXIoMCksCiAgICAgICAgICAgICAgYWxsb3dlZEZpYXQ6IG5ldyBCaWdOdW1iZXIoMCkKICAgICAgICAgICAgfSkKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHN0YXRlKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBiYWxhbmNlczogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBzdGF0ZS5iYWxhbmNlcyksIHt9LCB7CiAgICAgICAgICAgICAgYWxsb3dlZEN1cnJlbmN5OiBtYXhBbW91bnQsCiAgICAgICAgICAgICAgYWxsb3dlZEZpYXQ6IG1heEZpYXRBbW91bnQKICAgICAgICAgICAgfSkKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInNldE1heEJhbGFuY2UiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBiYWxhbmNlcyA9IF90aGlzLnN0YXRlLmJhbGFuY2VzOwoKICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgIGFtb3VudDogYmFsYW5jZXMuYWxsb3dlZEN1cnJlbmN5LnRvU3RyaW5nKCksCiAgICAgICAgZmlhdEFtb3VudDogYmFsYW5jZXMuYWxsb3dlZEZpYXQudG9TdHJpbmcoKQogICAgICB9KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgInVwZGF0ZVNlcnZpY2VBbmRUb3RhbEZlZSIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF90aGlzJHN0YXRlNiA9IF90aGlzLnN0YXRlLAogICAgICAgICAgdXNlZEFkbWluRmVlID0gX3RoaXMkc3RhdGU2LnVzZWRBZG1pbkZlZSwKICAgICAgICAgIGFtb3VudCA9IF90aGlzJHN0YXRlNi5hbW91bnQsCiAgICAgICAgICBmZWVzID0gX3RoaXMkc3RhdGU2LmZlZXMsCiAgICAgICAgICBjdXJyZW50RGVjaW1hbHMgPSBfdGhpcyRzdGF0ZTYuY3VycmVudERlY2ltYWxzOwogICAgICB2YXIgT05FX0hVTkRSRURfUEVSQ0VOVCA9IDEwMDsKICAgICAgdmFyIG5ld1NlcnZpY2VGZWVTaXplID0gdXNlZEFkbWluRmVlID8gbmV3IEJpZ051bWJlcih1c2VkQWRtaW5GZWUuZmVlKS5kaXZpZGVkQnkoT05FX0hVTkRSRURfUEVSQ0VOVCkubXVsdGlwbGllZEJ5KGFtb3VudCkgOiBuZXcgQmlnTnVtYmVyKDApOwogICAgICBuZXdTZXJ2aWNlRmVlU2l6ZSA9IG5ldyBCaWdOdW1iZXIoYW1vdW50KS5pc0dyZWF0ZXJUaGFuKDApICYmIG5ld1NlcnZpY2VGZWVTaXplLmlzR3JlYXRlclRoYW4oZmVlcy5hZG1pbkZlZVNpemUpID8gbmV3U2VydmljZUZlZVNpemUgOiBmZWVzLmFkbWluRmVlU2l6ZTsKCiAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBmZWVzOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHN0YXRlLmZlZXMpLCB7fSwgewogICAgICAgICAgICBzZXJ2aWNlOiBuZXdTZXJ2aWNlRmVlU2l6ZS5kcChjdXJyZW50RGVjaW1hbHMsIEJpZ051bWJlci5ST1VORF9DRUlMKSwKICAgICAgICAgICAgdG90YWw6IGZlZXMubWluZXIucGx1cyhuZXdTZXJ2aWNlRmVlU2l6ZSkuZHAoY3VycmVudERlY2ltYWxzLCBCaWdOdW1iZXIuUk9VTkRfQ0VJTCkKICAgICAgICAgIH0pCiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJhbW91bnRJbnB1dEtleURvd25DYWxsYmFjayIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICB2YXIgX3RoaXMkc3RhdGU3ID0gX3RoaXMuc3RhdGUsCiAgICAgICAgICBjdXJyZW50RGVjaW1hbHMgPSBfdGhpcyRzdGF0ZTcuY3VycmVudERlY2ltYWxzLAogICAgICAgICAgY3VycmVudEFjdGl2ZUFzc2V0ID0gX3RoaXMkc3RhdGU3LmN1cnJlbnRBY3RpdmVBc3NldCwKICAgICAgICAgIHNlbGVjdGVkVmFsdWUgPSBfdGhpcyRzdGF0ZTcuc2VsZWN0ZWRWYWx1ZTsgLy8ga2V5IGNvZGVzCgogICAgICB2YXIgQkFDS1NQQUNFID0gODsKICAgICAgdmFyIExFRlRfQVJST1cgPSAzNzsKICAgICAgdmFyIFJJR0hUX0FSUk9XID0gMzk7CiAgICAgIHZhciBERUxFVEUgPSA0NjsKICAgICAgdmFyIGlzTnVtYmVyID0gK2V2ZW50LmtleSA+PSAwICYmICtldmVudC5rZXkgPD0gOTsKICAgICAgdmFyIGFtb3VudFZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlOwoKICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJywnKSB7CiAgICAgICAgaW5wdXRSZXBsYWNlQ29tbWFXaXRoRG90KGV2ZW50KTsKICAgICAgfQoKICAgICAgaWYgKCEoaXNOdW1iZXIgfHwgZXZlbnQua2V5Q29kZSA9PT0gQkFDS1NQQUNFIHx8IGV2ZW50LmtleUNvZGUgPT09IExFRlRfQVJST1cgfHwgZXZlbnQua2V5Q29kZSA9PT0gUklHSFRfQVJST1cgfHwgZXZlbnQua2V5Q29kZSA9PT0gREVMRVRFIHx8IGV2ZW50LmtleSA9PT0gJy4nIHx8IGV2ZW50LmtleSA9PT0gJywnKSkgewogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0gZWxzZSBpZiAoYW1vdW50VmFsdWUuaW5jbHVkZXMoJy4nKSkgewogICAgICAgIC8vIGJsb2NrIG51bWJlciBpbnB1dCBpZiBxdWFudGl0eSBkZWNpbWFsIHBsYWNlcwogICAgICAgIC8vIG1vcmUgdGhhbiBhbGxvd2VkIChjcnlwdG86IGN1cnJlbnREZWNpbWFscyB8IGZpYXQ6IDIpCiAgICAgICAgdmFyIG1heFF1YW50aXR5RGVjaW1hbHMgPSBzZWxlY3RlZFZhbHVlID09PSBjdXJyZW50QWN0aXZlQXNzZXQuY3VycmVuY3kgPyBhbW91bnRWYWx1ZS5zcGxpdCgnLicpWzFdLmxlbmd0aCA9PT0gY3VycmVudERlY2ltYWxzIDogYW1vdW50VmFsdWUuc3BsaXQoJy4nKVsxXS5sZW5ndGggPT09IDI7CiAgICAgICAgbWF4UXVhbnRpdHlEZWNpbWFscyAmJiBpc051bWJlciAmJiBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9CiAgICB9KTsKCiAgICB2YXIgX2l0ZW1zID0gcHJvcHMuaXRlbXMsCiAgICAgICAgX3Byb3BzJGRhdGEgPSBwcm9wcy5kYXRhLAogICAgICAgIF9hbW91bnQgPSBfcHJvcHMkZGF0YS5hbW91bnQsCiAgICAgICAgdG9BZGRyZXNzID0gX3Byb3BzJGRhdGEudG9BZGRyZXNzLAogICAgICAgIF9jdXJyZW5jeSA9IF9wcm9wcyRkYXRhLmN1cnJlbmN5LAogICAgICAgIHdpdGhkcmF3V2FsbGV0ID0gX3Byb3BzJGRhdGEuYWRkcmVzczsKICAgIHZhciBfY3VycmVudEFjdGl2ZUFzc2V0ID0gcHJvcHMuZGF0YTsKICAgIHZhciBfY3VycmVudERlY2ltYWxzID0gY29uc3RhbnRzLnRva2VuRGVjaW1hbHNbZ2V0Q3VycmVuY3lLZXkoX2N1cnJlbmN5LCB0cnVlKS50b0xvd2VyQ2FzZSgpXTsKCiAgICB2YXIgX2FsbEN1cnJlbmN5aWVzID0gYWN0aW9ucy5jb3JlLmdldFdhbGxldHMoe30pOyAvL2l0ZW1zLmNvbmNhdCh0b2tlbkl0ZW1zKQoKCiAgICB2YXIgX3NlbGVjdGVkSXRlbSA9IGFjdGlvbnMudXNlci5nZXRXaXRoZHJhd1dhbGxldChfY3VycmVuY3ksIHdpdGhkcmF3V2FsbGV0KTsKCiAgICB2YXIgX3VzZWRBZG1pbkZlZSA9IGFkbWluRmVlLmlzRW5hYmxlZChfc2VsZWN0ZWRJdGVtLmN1cnJlbmN5KTsKCiAgICB2YXIgaW5mb0Fib3V0Q3VycmVuY3kgPSBfY3VycmVudEFjdGl2ZUFzc2V0LmluZm9BYm91dEN1cnJlbmN5OwoKICAgIHZhciBfaXNFdGhUb2tlbiA9IGhlbHBlcnMuZXRoVG9rZW4uaXNFdGhUb2tlbih7CiAgICAgIG5hbWU6IF9jdXJyZW5jeS50b0xvd2VyQ2FzZSgpCiAgICB9KTsKCiAgICB2YXIgX2V4Q3VycmVuY3lSYXRlID0gaW5mb0Fib3V0Q3VycmVuY3kgJiYgaW5mb0Fib3V0Q3VycmVuY3kucHJpY2VfZmlhdCA/IG5ldyBCaWdOdW1iZXIoX2N1cnJlbnRBY3RpdmVBc3NldC5pbmZvQWJvdXRDdXJyZW5jeS5wcmljZV9maWF0KSA6IG5ldyBCaWdOdW1iZXIoMCk7IC8vIHNhdmUgZXRoZXJldW0gd2FsbGV0IGZvciB0b2tlbiBleGNoYW5nZSdzIHJhdGUKCgogICAgdmFyIGFycldpdGhFdGhXYWxsZXQgPSBfaXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgIHJldHVybiBpdGVtLmN1cnJlbmN5LnRvTG93ZXJDYXNlKCkgPT09ICdldGgnICYmIGl0ZW0uaW5mb0Fib3V0Q3VycmVuY3kgJiYgaXRlbS5pbmZvQWJvdXRDdXJyZW5jeS5wcmljZV9maWF0OwogICAgfSk7CgogICAgdmFyIGV0aFdhbGxldCA9IGFycldpdGhFdGhXYWxsZXRbMF0gfHwge307CiAgICBfdGhpcy5zdGF0ZSA9IHsKICAgICAgaXNTaGlwcGVkOiBmYWxzZSwKICAgICAgdXNlZEFkbWluRmVlOiBfdXNlZEFkbWluRmVlLAogICAgICBvcGVuU2NhbkNhbTogZmFsc2UsCiAgICAgIGFkZHJlc3M6IHRvQWRkcmVzcyA/IHRvQWRkcmVzcyA6ICcnLAogICAgICBmaWF0QW1vdW50OiAnJywKICAgICAgYW1vdW50OiAnJywKICAgICAgc2VsZWN0ZWRJdGVtOiBfc2VsZWN0ZWRJdGVtLAogICAgICBpc0V0aFRva2VuOiBfaXNFdGhUb2tlbiwKICAgICAgY3VycmVudERlY2ltYWxzOiBfY3VycmVudERlY2ltYWxzLAogICAgICBzZWxlY3RlZFZhbHVlOiBfY3VycmVuY3ksCiAgICAgIG93blR4OiAnJywKICAgICAgaGlkZGVuQ29pbnNMaXN0OiBhY3Rpb25zLmNvcmUuZ2V0SGlkZGVuQ29pbnMoKSwKICAgICAgY3VycmVudEFjdGl2ZUFzc2V0OiBfY3VycmVudEFjdGl2ZUFzc2V0LAogICAgICBldGhXYWxsZXQ6IGV0aFdhbGxldCwKICAgICAgZXhDdXJyZW5jeVJhdGU6IF9leEN1cnJlbmN5UmF0ZSwKICAgICAgYWxsQ3VycmVuY3lpZXM6IF9hbGxDdXJyZW5jeWllcywKICAgICAgZGV2RXJyb3I6IG51bGwsCiAgICAgIGZlZXM6IHsKICAgICAgICBtaW5lcjogbmV3IEJpZ051bWJlcigwKSwKICAgICAgICBzZXJ2aWNlOiBuZXcgQmlnTnVtYmVyKDApLAogICAgICAgIHRvdGFsOiBuZXcgQmlnTnVtYmVyKDApLAogICAgICAgIGFkbWluRmVlU2l6ZTogbmV3IEJpZ051bWJlcigwKQogICAgICB9LAogICAgICBiYWxhbmNlczogewogICAgICAgIGJhbGFuY2U6IG5ldyBCaWdOdW1iZXIoX3NlbGVjdGVkSXRlbS5iYWxhbmNlIHx8IDApLAogICAgICAgIGFsbG93ZWRDdXJyZW5jeTogbmV3IEJpZ051bWJlcigwKSwKICAgICAgICBhbGxvd2VkRmlhdDogbmV3IEJpZ051bWJlcigwKQogICAgICB9LAogICAgICBidGNGZWVSYXRlOiBudWxsLAogICAgICBmZXRjaEZlZTogdHJ1ZSwKICAgICAgdHhTaXplOiBudWxsLAogICAgICBpc0ludm9pY2VQYXk6ICEhX2N1cnJlbnRBY3RpdmVBc3NldC5pbnZvaWNlCiAgICB9OwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFdpdGhkcmF3TW9kYWwsIFt7CiAgICBrZXk6ICJjb21wb25lbnRXaWxsVW5tb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7CiAgICAgIHRoaXMubW91bnRlZCA9IGZhbHNlOwogICAgICBjbGVhclRpbWVvdXQodGhpcy5idGNGZWVUaW1lcik7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29tcG9uZW50RGlkTW91bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkgewogICAgICB0aGlzLnNldENvbW1pc3Npb25zKCk7CiAgICAgIGZlZWRiYWNrLndpdGhkcmF3LmVudGVyZWQoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb21wb25lbnREaWRVcGRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMsIHByZXZTdGF0ZSkgewogICAgICB2YXIgcHJldkRhdGEgPSBwcmV2UHJvcHMuZGF0YSwKICAgICAgICAgIHByZXZJdGVtcyA9IHByZXZQcm9wcy5pdGVtczsKICAgICAgdmFyIF90aGlzJHByb3BzNCA9IHRoaXMucHJvcHMsCiAgICAgICAgICBkYXRhID0gX3RoaXMkcHJvcHM0LmRhdGEsCiAgICAgICAgICBpdGVtcyA9IF90aGlzJHByb3BzNC5pdGVtczsKICAgICAgdmFyIHByZXZBbW91bnQgPSBwcmV2U3RhdGUuYW1vdW50LAogICAgICAgICAgcHJldkZpYXRBbW91bnQgPSBwcmV2U3RhdGUuZmlhdEFtb3VudDsKICAgICAgdmFyIF90aGlzJHN0YXRlOCA9IHRoaXMuc3RhdGUsCiAgICAgICAgICBhbW91bnQgPSBfdGhpcyRzdGF0ZTguYW1vdW50LAogICAgICAgICAgZmlhdEFtb3VudCA9IF90aGlzJHN0YXRlOC5maWF0QW1vdW50OwoKICAgICAgaWYgKHByZXZEYXRhICE9PSBkYXRhIHx8IHByZXZJdGVtcyAhPT0gaXRlbXMpIHsKICAgICAgICB0aGlzLnNldEN1cnJlbmN0QWN0aXZlQXNzZXQoKTsKICAgICAgfQoKICAgICAgaWYgKHByZXZBbW91bnQgIT09IGFtb3VudCB8fCBwcmV2RmlhdEFtb3VudCAhPT0gZmlhdEFtb3VudCkgewogICAgICAgIHRoaXMudXBkYXRlU2VydmljZUFuZFRvdGFsRmVlKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGRyZXNzSXNDb3JyZWN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRyZXNzSXNDb3JyZWN0KCkgewogICAgICB2YXIgY3VycmVuY3kgPSB0aGlzLnByb3BzLmRhdGEuY3VycmVuY3k7CiAgICAgIHZhciBfdGhpcyRzdGF0ZTkgPSB0aGlzLnN0YXRlLAogICAgICAgICAgYWRkcmVzcyA9IF90aGlzJHN0YXRlOS5hZGRyZXNzLAogICAgICAgICAgaXNFdGhUb2tlbiA9IF90aGlzJHN0YXRlOS5pc0V0aFRva2VuOwoKICAgICAgaWYgKGdldEN1cnJlbmN5S2V5KGN1cnJlbmN5LCBmYWxzZSkudG9Mb3dlckNhc2UoKSA9PT0gImJ0YyIpIHsKICAgICAgICBpZiAoIXR5cGVmb3JjZS5pc0NvaW5BZGRyZXNzLkJUQyhhZGRyZXNzKSkgewogICAgICAgICAgcmV0dXJuIGFjdGlvbnMuYnRjLmFkZHJlc3NJc0NvcnJlY3QoYWRkcmVzcyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKGlzRXRoVG9rZW4pIHsKICAgICAgICByZXR1cm4gdHlwZWZvcmNlLmlzQ29pbkFkZHJlc3MuRVRIKGFkZHJlc3MpOwogICAgICB9CgogICAgICByZXR1cm4gdHlwZWZvcmNlLmlzQ29pbkFkZHJlc3NbZ2V0Q3VycmVuY3lLZXkoY3VycmVuY3ksIGZhbHNlKS50b1VwcGVyQ2FzZSgpXShhZGRyZXNzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgX3RoaXMkc3RhdGUxMCA9IHRoaXMuc3RhdGUsCiAgICAgICAgICBvd25UeCA9IF90aGlzJHN0YXRlMTAub3duVHgsCiAgICAgICAgICBhbW91bnQgPSBfdGhpcyRzdGF0ZTEwLmFtb3VudCwKICAgICAgICAgIGFkZHJlc3MgPSBfdGhpcyRzdGF0ZTEwLmFkZHJlc3MsCiAgICAgICAgICBiYWxhbmNlcyA9IF90aGlzJHN0YXRlMTAuYmFsYW5jZXMsCiAgICAgICAgICBldGhXYWxsZXQgPSBfdGhpcyRzdGF0ZTEwLmV0aFdhbGxldCwKICAgICAgICAgIGlzU2hpcHBlZCA9IF90aGlzJHN0YXRlMTAuaXNTaGlwcGVkLAogICAgICAgICAgZmlhdEFtb3VudCA9IF90aGlzJHN0YXRlMTAuZmlhdEFtb3VudCwKICAgICAgICAgIGlzRXRoVG9rZW4gPSBfdGhpcyRzdGF0ZTEwLmlzRXRoVG9rZW4sCiAgICAgICAgICBvcGVuU2NhbkNhbSA9IF90aGlzJHN0YXRlMTAub3BlblNjYW5DYW0sCiAgICAgICAgICBleEN1cnJlbmN5UmF0ZSA9IF90aGlzJHN0YXRlMTAuZXhDdXJyZW5jeVJhdGUsCiAgICAgICAgICBjdXJyZW50RGVjaW1hbHMgPSBfdGhpcyRzdGF0ZTEwLmN1cnJlbnREZWNpbWFscywKICAgICAgICAgIGhpZGRlbkNvaW5zTGlzdCA9IF90aGlzJHN0YXRlMTAuaGlkZGVuQ29pbnNMaXN0LAogICAgICAgICAgY3VycmVudEFjdGl2ZUFzc2V0ID0gX3RoaXMkc3RhdGUxMC5jdXJyZW50QWN0aXZlQXNzZXQsCiAgICAgICAgICBzZWxlY3RlZFZhbHVlID0gX3RoaXMkc3RhdGUxMC5zZWxlY3RlZFZhbHVlLAogICAgICAgICAgdXNlZEFkbWluRmVlID0gX3RoaXMkc3RhdGUxMC51c2VkQWRtaW5GZWUsCiAgICAgICAgICBkZXZFcnJvciA9IF90aGlzJHN0YXRlMTAuZGV2RXJyb3IsCiAgICAgICAgICBmZWVzID0gX3RoaXMkc3RhdGUxMC5mZWVzLAogICAgICAgICAgZmV0Y2hGZWUgPSBfdGhpcyRzdGF0ZTEwLmZldGNoRmVlLAogICAgICAgICAgdHhTaXplID0gX3RoaXMkc3RhdGUxMC50eFNpemUsCiAgICAgICAgICBidGNGZWVSYXRlID0gX3RoaXMkc3RhdGUxMC5idGNGZWVSYXRlLAogICAgICAgICAgaXNCVENXYWxsZXQgPSBfdGhpcyRzdGF0ZTEwLnNlbGVjdGVkSXRlbS5pc0JUQzsKICAgICAgdmFyIF90aGlzJHByb3BzNSA9IHRoaXMucHJvcHMsCiAgICAgICAgICBuYW1lID0gX3RoaXMkcHJvcHM1Lm5hbWUsCiAgICAgICAgICBpbnRsID0gX3RoaXMkcHJvcHM1LmludGwsCiAgICAgICAgICBwb3J0YWxVSSA9IF90aGlzJHByb3BzNS5wb3J0YWxVSSwKICAgICAgICAgIGFjdGl2ZUZpYXQgPSBfdGhpcyRwcm9wczUuYWN0aXZlRmlhdCwKICAgICAgICAgIGRhc2hib2FyZFZpZXcgPSBfdGhpcyRwcm9wczUuZGFzaGJvYXJkVmlldzsKICAgICAgdmFyIGxpbmtlZCA9IExpbmsuYWxsKHRoaXMsICdhZGRyZXNzJywgJ2Ftb3VudCcsICdvd25UeCcsICdmaWF0QW1vdW50JywgJ2NvbW1lbnQnKTsKICAgICAgdmFyIGN1cnJlbmN5ID0gY3VycmVudEFjdGl2ZUFzc2V0LmN1cnJlbmN5LAogICAgICAgICAgY3VycmVudEFkZHJlc3MgPSBjdXJyZW50QWN0aXZlQXNzZXQuYWRkcmVzcywKICAgICAgICAgIGN1cnJlbnRCYWxhbmNlID0gY3VycmVudEFjdGl2ZUFzc2V0LmJhbGFuY2UsCiAgICAgICAgICBpbnZvaWNlID0gY3VycmVudEFjdGl2ZUFzc2V0Lmludm9pY2U7CiAgICAgIHZhciB0YWJsZVJvd3MgPSBhY3Rpb25zLmNvcmUuZ2V0V2FsbGV0cyh7fSkuZmlsdGVyKGZ1bmN0aW9uIChfcmVmNikgewogICAgICAgIHZhciBjdXJyZW5jeSA9IF9yZWY2LmN1cnJlbmN5LAogICAgICAgICAgICBhZGRyZXNzID0gX3JlZjYuYWRkcmVzcywKICAgICAgICAgICAgYmFsYW5jZSA9IF9yZWY2LmJhbGFuY2U7CiAgICAgICAgLy8gQFRvRG8gLSDQkiDQsdGD0LTRg9GJ0LXQvCDQvdGD0LbQvdC+INGD0LHRgNCw0YLRjCDQv9GA0L7QstC10YDQutGDINGC0L7Qu9GM0LrQviDQv9C+INGC0LjQv9GDINC80L7QvdC10YLRiy4KICAgICAgICAvLyDQodGC0LDRgNGD0Y4g0L/RgNC+0LLQtdGA0LrRgyDQvtGB0YLQsNCy0LjQuywg0YfRgtC+0LHRiyDRgyDRgdGC0LDRgNGL0YUg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9C10Lkg0L3QtSDQstGL0LLQsNC70LjQu9C40YHRjCDRgdC60YDRi9GC0YvQtSDQutC+0YjQtdC70YzQutC4CiAgICAgICAgcmV0dXJuICFoaWRkZW5Db2luc0xpc3QuaW5jbHVkZXMoY3VycmVuY3kpICYmICFoaWRkZW5Db2luc0xpc3QuaW5jbHVkZXMoIiIuY29uY2F0KGN1cnJlbmN5LCAiOiIpLmNvbmNhdChhZGRyZXNzKSkgfHwgYmFsYW5jZSA+IDA7CiAgICAgIH0pOwogICAgICB2YXIgYWN0aXZlQ3JpcHRvQ3VycmVuY3kgPSBnZXRDdXJyZW5jeUtleShjdXJyZW50QWN0aXZlQXNzZXQuY3VycmVuY3ksIHRydWUpLnRvVXBwZXJDYXNlKCk7CiAgICAgIHZhciBzZWxlY3RlZFZhbHVlVmlldyA9IGdldEN1cnJlbmN5S2V5KHNlbGVjdGVkVmFsdWUsIHRydWUpLnRvVXBwZXJDYXNlKCk7CiAgICAgIHZhciBjcmlwdG9DdXJyZW5jeUhhdmVJbmZvUHJpY2UgPSByZXR1cm5IYXZlSW5mb1ByaWNlKCk7CiAgICAgIHZhciBldGhCYWxhbmNlTGVzc1RoYW5NaW5lciA9IG5ldyBCaWdOdW1iZXIoZXRoV2FsbGV0LmJhbGFuY2UpLmlzTGVzc1RoYW4oZmVlcy5taW5lcik7CiAgICAgIHZhciBleEV0aGVyZXVtUmF0ZSA9IG5ldyBCaWdOdW1iZXIoZXRoV2FsbGV0LmluZm9BYm91dEN1cnJlbmN5LnByaWNlX2ZpYXQgfHwgMCk7CgogICAgICBmdW5jdGlvbiByZXR1cm5IYXZlSW5mb1ByaWNlKCkgewogICAgICAgIHZhciByZXN1bHQgPSB0cnVlOwogICAgICAgIHRhYmxlUm93cy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBpZiAoaXRlbS5jdXJyZW5jeSA9PT0gYWN0aXZlQ3JpcHRvQ3VycmVuY3kpIHsKICAgICAgICAgICAgcmVzdWx0ID0gaXRlbS5pbmZvQWJvdXRDdXJyZW5jeSAmJiBpdGVtLmluZm9BYm91dEN1cnJlbmN5LnByaWNlX2ZpYXQ7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfQoKICAgICAgdmFyIGlzRGlzYWJsZWQgPSAhYWRkcmVzcyB8fCAhK2Ftb3VudCB8fCBpc1NoaXBwZWQgfHwgISFvd25UeCB8fCAhdGhpcy5hZGRyZXNzSXNDb3JyZWN0KCkgfHwgaXNFdGhUb2tlbiAmJiBldGhCYWxhbmNlTGVzc1RoYW5NaW5lciB8fCBuZXcgQmlnTnVtYmVyKGFtb3VudCkuaXNHcmVhdGVyVGhhbihiYWxhbmNlcy5iYWxhbmNlKSB8fCBuZXcgQmlnTnVtYmVyKGFtb3VudCkuZHAoKSA+IGN1cnJlbnREZWNpbWFsczsKICAgICAgdmFyIGxhYmVscyA9IGRlZmluZU1lc3NhZ2VzKHsKICAgICAgICB3aXRoZHJvd01vZGFsOiB7CiAgICAgICAgICBpZDogJ3dpdGhkcm93VGl0bGUyNzEnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTZW5kIgogICAgICAgIH0sCiAgICAgICAgYmFsYW5jZUZpYXRNb2JpbGU6IHsKICAgICAgICAgIGlkOiAnV2l0aGRyYXdfRmlhdEJhbGFuY2VNb2JpbGUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd+e2Ftb3VudH0ge2N1cnJlbmN5fScKICAgICAgICB9LAogICAgICAgIGJhbGFuY2VGaWF0RGVza3RvcDogewogICAgICAgICAgaWQ6ICdXaXRoZHJhd19GaWF0QmFsYW5jZURlc2t0b3AnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICfRjdGC0L4gfnthbW91bnR9IHtjdXJyZW5jeX0nCiAgICAgICAgfSwKICAgICAgICBiYWxhbmNlTW9iaWxlOiB7CiAgICAgICAgICBpZDogJ1dpdGhkcmF3X0JhbGFuY2VNb2JpbGUnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd7YW1vdW50fSB7Y3VycmVuY3l9JwogICAgICAgIH0sCiAgICAgICAgYmFsYW5jZURlc2t0b3A6IHsKICAgICAgICAgIGlkOiAnV2l0aGRyYXdfQmFsYW5jZURlc2t0b3AnLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICd7YW1vdW50fSB7Y3VycmVuY3l9IHdpbGwgYmUgc2VuZCcKICAgICAgICB9LAogICAgICAgIG93blR4UGxhY2Vob2xkZXI6IHsKICAgICAgICAgIGlkOiAnd2l0aGRyYXdPd25UeFBsYWNlaG9sZGVyJywKICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnSWYgcGFpZCBmcm9tIGFub3RoZXIgc291cmNlJwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHZhciBkYXRhQ3VycmVuY3kgPSBpc0V0aFRva2VuID8gJ0VUSCcgOiBjdXJyZW5jeS50b1VwcGVyQ2FzZSgpOwogICAgICB2YXIgZm9ybVJlbmRlciA9IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZyYWdtZW50LCBudWxsLCBvcGVuU2NhbkNhbSAmJiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChRclJlYWRlciwgewogICAgICAgIG9wZW5TY2FuOiB0aGlzLm9wZW5TY2FuLAogICAgICAgIGhhbmRsZUVycm9yOiB0aGlzLnJlcG9ydEVycm9yLAogICAgICAgIGhhbmRsZVNjYW46IHRoaXMuaGFuZGxlU2NhbgogICAgICB9KSwgaW52b2ljZSAmJiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChJbnZvaWNlSW5mb0Jsb2NrLCB7CiAgICAgICAgaW52b2ljZURhdGE6IGludm9pY2UKICAgICAgfSksICFkYXNoYm9hcmRWaWV3ICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJwIiwgewogICAgICAgIHN0eWxlTmFtZTogaXNFdGhUb2tlbiA/ICdyZWRub3RlcycgOiAnbm90aWNlJwogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJXaXRoZHJvdzIxMyIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJQbGVhc2Ugbm90ZTogRmVlIGlzIHttaW5BbW91bnR9IHtkYXRhfS57YnJ9WW91ciBiYWxhbmNlIG11c3QgZXhjZWVkIHRoaXMgc3VtIHRvIHBlcmZvcm0gdHJhbnNhY3Rpb24iLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgbWluQW1vdW50OiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsIGlzRXRoVG9rZW4gPyBtaW5BbW91bnQuZXRoIDogZmVlcy50b3RhbC50b051bWJlcigpKSwKICAgICAgICAgIGJyOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwKICAgICAgICAgIGRhdGE6ICIiLmNvbmNhdChkYXRhQ3VycmVuY3kpCiAgICAgICAgfQogICAgICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIG1hcmdpbkJvdHRvbTogJzQwcHgnCiAgICAgICAgfQogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlTmFtZTogImN1c3RvbVNlbGVjdENvbnRhaW5lciIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRmllbGRMYWJlbCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAiV2l0aGRyb3c1NTkiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU2VuZCBmcm9tIHdhbGxldCAiCiAgICAgIH0pKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQ3VycmVuY3lMaXN0LCBfZXh0ZW5kcyh7fSwgdGhpcy5wcm9wcywgewogICAgICAgIGN1cnJlbnRBY3RpdmVBc3NldDogY3VycmVudEFjdGl2ZUFzc2V0LAogICAgICAgIGN1cnJlbnRCYWxhbmNlOiBjdXJyZW50QmFsYW5jZSwKICAgICAgICBjdXJyZW5jeTogY3VycmVuY3ksCiAgICAgICAgZXhDdXJyZW5jeVJhdGU6IGV4Q3VycmVuY3lSYXRlLnRvTnVtYmVyKCksCiAgICAgICAgYWN0aXZlRmlhdDogYWN0aXZlRmlhdCwKICAgICAgICB0YWJsZVJvd3M6IHRhYmxlUm93cywKICAgICAgICBjdXJyZW50QWRkcmVzczogY3VycmVudEFkZHJlc3MKICAgICAgfSkpKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGVOYW1lOiAiaGlnaExldmVsIgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGaWVsZExhYmVsLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJXaXRoZHJvdzExOTQiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQWRkcmVzcyAiCiAgICAgIH0pLCAnICcsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRvb2x0aXAsIHsKICAgICAgICBpZDogIld0SDIwMyIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZTogewogICAgICAgICAgdGV4dEFsaWduOiAnY2VudGVyJwogICAgICAgIH0KICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAiV1RIMjc1IiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk1ha2Ugc3VyZSB0aGUgd2FsbGV0IHlvdXticn1hcmUgc2VuZGluZyB0aGUgZnVuZHMgdG8gc3VwcG9ydHMge2N1cnJlbmN5fSIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBicjogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCksCiAgICAgICAgICBjdXJyZW5jeTogIiIuY29uY2F0KGN1cnJlbmN5LnRvVXBwZXJDYXNlKCkpCiAgICAgICAgfQogICAgICB9KSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoSW5wdXQsIHsKICAgICAgICB2YWx1ZUxpbms6IGxpbmtlZC5hZGRyZXNzLAogICAgICAgIGZvY3VzT25Jbml0OiB0cnVlLAogICAgICAgIHBhdHRlcm46ICIwLTlhLXpBLVo6IiwKICAgICAgICBwbGFjZWhvbGRlcjogIkVudGVyICIuY29uY2F0KGN1cnJlbmN5LnRvVXBwZXJDYXNlKCksICIgYWRkcmVzcyB0byB0cmFuc2ZlciIpLAogICAgICAgIHFyOiBpc01vYmlsZSwKICAgICAgICBvcGVuU2NhbjogdGhpcy5vcGVuU2NhbgogICAgICB9KSwgYWRkcmVzcyAmJiAhdGhpcy5hZGRyZXNzSXNDb3JyZWN0KCkgJiYgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZU5hbWU6ICJyZWRub3RlIGJvdHRvbTAiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogIldpdGhkcmF3SW5jb3JlY3RBZGRyZXNzIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIllvdXIgYWRkcmVzcyBub3QgY29ycmVjdCIKICAgICAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZU5hbWU6ICJsb3dMZXZlbCAiLmNvbmNhdChpc0RhcmsgPyAnZGFyaycgOiAnJyksCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIG1hcmdpbkJvdHRvbTogJzMwcHgnCiAgICAgICAgfQogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlOiB1c2VkQWRtaW5GZWUgPyB7CiAgICAgICAgICByaWdodDogJzIwcHgnCiAgICAgICAgfSA6IG51bGwsCiAgICAgICAgc3R5bGVOYW1lOiAiYWRkaXRpb25hbFx1MDQyMXVycmVuY2llcyIKICAgICAgfSwgY3JpcHRvQ3VycmVuY3lIYXZlSW5mb1ByaWNlICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFJlYWN0LkZyYWdtZW50LCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIHsKICAgICAgICBzdHlsZU5hbWU6IGN4KCdhZGRpdGlvbmFs0KF1cnJlbmNpZXNJdGVtJywgewogICAgICAgICAgYWRkaXRpb25hbNChdXJyZW5jaWVzSXRlbUFjdGl2ZTogc2VsZWN0ZWRWYWx1ZS50b1VwcGVyQ2FzZSgpID09PSBhY3RpdmVGaWF0CiAgICAgICAgfSksCiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuaGFuZGxlQnV5Q3VycmVuY3lTZWxlY3QoYWN0aXZlRmlhdCk7CiAgICAgICAgfQogICAgICB9LCBhY3RpdmVGaWF0KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgc3R5bGVOYW1lOiAiZGVsaW1pdGVyIgogICAgICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJzcGFuIiwgewogICAgICAgIHN0eWxlTmFtZTogY3goJ2FkZGl0aW9uYWzQoXVycmVuY2llc0l0ZW0nLCB7CiAgICAgICAgICBhZGRpdGlvbmFs0KF1cnJlbmNpZXNJdGVtQWN0aXZlOiBzZWxlY3RlZFZhbHVlVmlldyA9PT0gYWN0aXZlQ3JpcHRvQ3VycmVuY3kKICAgICAgICB9KSwKICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMi5oYW5kbGVCdXlDdXJyZW5jeVNlbGVjdChjdXJyZW50QWN0aXZlQXNzZXQuY3VycmVuY3kpOwogICAgICAgIH0KICAgICAgfSwgYWN0aXZlQ3JpcHRvQ3VycmVuY3kpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInAiLCB7CiAgICAgICAgc3R5bGU6IHVzZWRBZG1pbkZlZSA/IHsKICAgICAgICAgIHJpZ2h0OiAnMTBweCcKICAgICAgICB9IDogbnVsbCwKICAgICAgICBzdHlsZU5hbWU6ICJiYWxhbmNlIgogICAgICB9LCBuZXcgQmlnTnVtYmVyKGFtb3VudCkuaXNHcmVhdGVyVGhhbigwKSAmJiBjcmlwdG9DdXJyZW5jeUhhdmVJbmZvUHJpY2UgJiYgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgX2V4dGVuZHMoe30sIGxhYmVsc1tzZWxlY3RlZFZhbHVlICE9PSBhY3RpdmVGaWF0ID8gaXNNb2JpbGUgPyAiYmFsYW5jZUZpYXRNb2JpbGUiIDogImJhbGFuY2VGaWF0RGVza3RvcCIgOiBpc01vYmlsZSA/ICJiYWxhbmNlTW9iaWxlIiA6ICJiYWxhbmNlRGVza3RvcCJdLCB7CiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBhbW91bnQ6IHNlbGVjdGVkVmFsdWUgIT09IGFjdGl2ZUZpYXQgPyBuZXcgQmlnTnVtYmVyKGZpYXRBbW91bnQpLmRwKDIsIEJpZ051bWJlci5ST1VORF9DRUlMKS50b051bWJlcigpIDogbmV3IEJpZ051bWJlcihhbW91bnQpLmRwKDYsIEJpZ051bWJlci5ST1VORF9DRUlMKS50b051bWJlcigpLAogICAgICAgICAgY3VycmVuY3k6IHNlbGVjdGVkVmFsdWUgIT09IGFjdGl2ZUZpYXQgPyBhY3RpdmVGaWF0IDogYWN0aXZlQ3JpcHRvQ3VycmVuY3kudG9VcHBlckNhc2UoKQogICAgICAgIH0KICAgICAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRmllbGRMYWJlbCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAiV2l0aGRyb3cxMTgiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQW1vdW50IgogICAgICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGVOYW1lOiAiZ3JvdXAiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KElucHV0LCB7CiAgICAgICAgcGF0dGVybjogIjAtOVxcLiIsCiAgICAgICAgb25LZXlEb3duOiB0aGlzLmFtb3VudElucHV0S2V5RG93bkNhbGxiYWNrLAogICAgICAgIHZhbHVlTGluazogc2VsZWN0ZWRWYWx1ZSA9PT0gY3VycmVudEFjdGl2ZUFzc2V0LmN1cnJlbmN5ID8gbGlua2VkLmFtb3VudC5waXBlKHRoaXMuaGFuZGxlQW1vdW50KSA6IGxpbmtlZC5maWF0QW1vdW50LnBpcGUodGhpcy5oYW5kbGVBbW91bnQpCiAgICAgIH0pLCAhdXNlZEFkbWluRmVlICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFJlYWN0LkZyYWdtZW50LCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICBtYXJnaW5MZWZ0OiAnMTVweCcKICAgICAgICB9CiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEJ1dHRvbiwgewogICAgICAgIGRpc2FibGVkOiBmZXRjaEZlZSwKICAgICAgICBibHVlOiB0cnVlLAogICAgICAgIGJpZzogdHJ1ZSwKICAgICAgICBvbkNsaWNrOiB0aGlzLnNldE1heEJhbGFuY2UsCiAgICAgICAgaWQ6ICJXaXRoZHJvdzEzNCIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAiU2VsZWN0MjEwIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk1BWCIKICAgICAgfSkpKSwgIWlzTW9iaWxlICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRvb2x0aXAsIHsKICAgICAgICBpZDogIldpdGhkcm93MTM0IiwKICAgICAgICBwbGFjZTogInRvcCIsCiAgICAgICAgbWFyazogZmFsc2UKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAiV2l0aGRyYXdCdXR0b24zMiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJXaGVuIHlvdSBjbGljayB0aGlzIGJ1dHRvbiwgaW4gdGhlIGZpZWxkLCBhbiBhbW91bnR7YnJ9ZXF1YWwgdG8geW91ciBiYWxhbmNlIG1pbnVzIHRoZSBtaW5lcnMgY29tbWlzc2lvbiB3aWxsIGFwcGVhciIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBicjogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImJyIiwgbnVsbCkKICAgICAgICB9CiAgICAgIH0pKSkpLCBkYXNoYm9hcmRWaWV3ICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGVOYW1lOiAicHJvbXB0ICIuY29uY2F0KGZldGNoRmVlID8gJ2hpZGUnIDogJycpCiAgICAgIH0sIGlzRXRoVG9rZW4gJiYgZXRoQmFsYW5jZUxlc3NUaGFuTWluZXIgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJXaXRoZHJvd0JhbGFuY2VOb3RFbm91Z2h0RXRoZXJldW1CYWxhbmNlUHJvbXB0IiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk5vdCBlbm91Z2ggZXRoZXJldW0gYmFsYW5jZSBmb3IgbWluZXIgZmVlIgogICAgICB9KSA6IGJhbGFuY2VzLmFsbG93ZWRDdXJyZW5jeS5pc0VxdWFsVG8oMCkgPyAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJXaXRoZHJvd0JhbGFuY2VOb3RFbm91Z2h0UHJvbXB0IiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk5vdCBlbm91Z2ggYmFsYW5jZSB0byBzZW5kIgogICAgICB9KSA6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogIldpdGhkcm93MTcwIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIk1heGltdW0gYW1vdW50IHlvdSBjYW4gc2VuZCBpcyB7YWxsb3dlZEJhbGFuY2V9IHtjdXJyZW5jeX0iLAogICAgICAgIHZhbHVlczogewogICAgICAgICAgYWxsb3dlZEJhbGFuY2U6IHNlbGVjdGVkVmFsdWUgPT09IGN1cnJlbnRBY3RpdmVBc3NldC5jdXJyZW5jeSA/IGJhbGFuY2VzLmFsbG93ZWRDdXJyZW5jeS50b051bWJlcigpIDogYmFsYW5jZXMuYWxsb3dlZEZpYXQudG9OdW1iZXIoKSwKICAgICAgICAgIGN1cnJlbmN5OiBzZWxlY3RlZFZhbHVlID09PSBjdXJyZW50QWN0aXZlQXNzZXQuY3VycmVuY3kgPyBhY3RpdmVDcmlwdG9DdXJyZW5jeSA6IGFjdGl2ZUZpYXQKICAgICAgICB9CiAgICAgIH0pLCAnICcsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRvb2x0aXAsIHsKICAgICAgICBpZDogIld0SDIwNCIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZTogewogICAgICAgICAgbWF4V2lkdGg6ICcyNGVtJywKICAgICAgICAgIHRleHRBbGlnbjogJ2NlbnRlcicKICAgICAgICB9CiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogIldUSDI3NiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJUaGUgYW1vdW50IHNob3VsZCBub3QgZXhjZWVkIHlvdXJ7YnJ9IGN1cnJlbnQgYmFsYW5jZSBtaW51cyBtaW5pbmcgZmVlIiwKICAgICAgICB2YWx1ZXM6IHsKICAgICAgICAgIGJyOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKQogICAgICAgIH0KICAgICAgfSkpKSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlTmFtZTogImNvbW1lbnRGb3JtV3JhcHBlciIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRmllbGRMYWJlbCwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAiQ29tbWVudCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJDb21tZW50IgogICAgICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGVOYW1lOiAiZ3JvdXAiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KElucHV0LCB7CiAgICAgICAgdmFsdWVMaW5rOiBsaW5rZWQuY29tbWVudCwKICAgICAgICBwbGFjZWhvbGRlcjogaW50bC5mb3JtYXRNZXNzYWdlKHsKICAgICAgICAgIGlkOiAnQ29tbWVudCcsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogJ0NvbW1lbnQnCiAgICAgICAgfSkKICAgICAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZU5hbWU6ICJzZW5kQnRuc1dyYXBwZXIiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGVOYW1lOiAiYWN0aW9uQnRuIgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChCdXR0b24sIHsKICAgICAgICBiaWc6IHRydWUsCiAgICAgICAgZmlsbDogdHJ1ZSwKICAgICAgICBncmF5OiB0cnVlLAogICAgICAgIG9uQ2xpY2s6IHRoaXMuaGFuZGxlQ2xvc2UKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRnJhZ21lbnQsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogIldpdGhkcmF3TW9kYWxDYW5jZWxCdG4iLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ2FuY2VsIgogICAgICB9KSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZU5hbWU6ICJhY3Rpb25CdG4iCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEJ1dHRvbiwgewogICAgICAgIGJsdWU6IHRydWUsCiAgICAgICAgYmlnOiB0cnVlLAogICAgICAgIGZpbGw6IHRydWUsCiAgICAgICAgZGlzYWJsZWQ6IGlzRGlzYWJsZWQsCiAgICAgICAgb25DbGljazogdGhpcy5oYW5kbGVTdWJtaXQKICAgICAgfSwgaXNTaGlwcGVkID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRnJhZ21lbnQsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogIldpdGhkcmF3TW9kYWwxMTIxMiIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJQcm9jZXNzaW5nIC4uLiIKICAgICAgfSkpIDogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRnJhZ21lbnQsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogIldpdGhkcmF3TW9kYWwxMTEiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiU2VuZCIKICAgICAgfSksICcgJywgIiIuY29uY2F0KGN1cnJlbmN5LnRvVXBwZXJDYXNlKCkpKSkpKSwgdXNlZEFkbWluRmVlICYmIGlzRXRoVG9rZW4gJiYgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQWRtaW5GZWVJbmZvQmxvY2ssIF9leHRlbmRzKHt9LCB1c2VkQWRtaW5GZWUsIHsKICAgICAgICBjdXJyZW5jeTogY3VycmVuY3kKICAgICAgfSkpLCBpbnZvaWNlICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZyYWdtZW50LCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiaHIiLCBudWxsKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZU5hbWU6ICJsb3dMZXZlbCIsCiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIG1hcmdpbkJvdHRvbTogJzUwcHgnCiAgICAgICAgfQogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlTmFtZTogImdyb3VwRmllbGQiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGVOYW1lOiAiZG93bkxhYmVsIgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGaWVsZExhYmVsLCB7CiAgICAgICAgaW5Sb3c6IHRydWUKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCB7CiAgICAgICAgc3R5bGVOYW1lOiAibW9iaWxlRm9udCIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAiV2l0aGRyb3dPd25UWCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJcdTA0MThcdTA0M0JcdTA0MzggXHUwNDQzXHUwNDNBXHUwNDMwXHUwNDM2XHUwNDM4XHUwNDQyXHUwNDM1IFRYIgogICAgICB9KSkpKSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGVOYW1lOiAiZ3JvdXAiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KElucHV0LCB7CiAgICAgICAgc3R5bGVOYW1lOiAiaW5wdXQiLAogICAgICAgIHZhbHVlTGluazogbGlua2VkLm93blR4LAogICAgICAgIHBsYWNlaG9sZGVyOiAiIi5jb25jYXQoaW50bC5mb3JtYXRNZXNzYWdlKGxhYmVscy5vd25UeFBsYWNlaG9sZGVyKSkKICAgICAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQnV0dG9uLCB7CiAgICAgICAgc3R5bGVOYW1lOiAiYnV0dG9uRnVsbCIsCiAgICAgICAgYmx1ZTogdHJ1ZSwKICAgICAgICBiaWc6IHRydWUsCiAgICAgICAgZnVsbFdpZHRoOiB0cnVlLAogICAgICAgIGRpc2FibGVkOiAhb3duVHggfHwgaXNTaGlwcGVkLAogICAgICAgIG9uQ2xpY2s6IHRoaXMuaGFuZGxlU3VibWl0CiAgICAgIH0sIGlzU2hpcHBlZCA/IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZyYWdtZW50LCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJXaXRoZHJhd01vZGFsMTEyMTIiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiUHJvY2Vzc2luZyAuLi4iCiAgICAgIH0pKSA6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogIldpdGhkcmF3TW9kYWxJbnZvaWNlU2F2ZVR4IiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlx1MDQxRVx1MDQ0Mlx1MDQzQ1x1MDQzNVx1MDQ0Mlx1MDQzOFx1MDQ0Mlx1MDQ0QyBcdTA0M0FcdTA0MzBcdTA0M0EgXHUwNDNFXHUwNDNGXHUwNDNCXHUwNDMwXHUwNDQ3XHUwNDM1XHUwNDNEXHUwNDNEXHUwNDRCXHUwNDM5IgogICAgICB9KSkpLCBkYXNoYm9hcmRWaWV3ICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFJlYWN0LkZyYWdtZW50LCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICBwYWRkaW5nVG9wOiAnMmVtJwogICAgICAgIH0KICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRmVlSW5mb0Jsb2NrLCB7CiAgICAgICAgaXNFdGhUb2tlbjogaXNFdGhUb2tlbiwKICAgICAgICBjdXJyZW5jeTogY3VycmVuY3ksCiAgICAgICAgY3VycmVudERlY2ltYWxzOiBjdXJyZW50RGVjaW1hbHMsCiAgICAgICAgYWN0aXZlRmlhdDogYWN0aXZlRmlhdCwKICAgICAgICBkYXRhQ3VycmVuY3k6IGRhdGFDdXJyZW5jeSwKICAgICAgICBleEV0aGVyZXVtUmF0ZTogZXhFdGhlcmV1bVJhdGUsCiAgICAgICAgZXhDdXJyZW5jeVJhdGU6IGV4Q3VycmVuY3lSYXRlLAogICAgICAgIGZlZUN1cnJlbnRDdXJyZW5jeTogYnRjRmVlUmF0ZSwKICAgICAgICBpc0xvYWRpbmc6IGZldGNoRmVlLAogICAgICAgIHVzZWRBZG1pbkZlZTogdXNlZEFkbWluRmVlLAogICAgICAgIGhhc1R4U2l6ZTogaXNCVENXYWxsZXQsCiAgICAgICAgdHhTaXplOiB0eFNpemUsCiAgICAgICAgbWluZXJGZWU6IGZlZXMubWluZXIsCiAgICAgICAgc2VydmljZUZlZTogZmVlcy5zZXJ2aWNlLAogICAgICAgIHRvdGFsRmVlOiBmZWVzLnRvdGFsCiAgICAgIH0pKSwgZGV2RXJyb3IgJiYgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZU5hbWU6ICJlcnJvckJsb2NrIgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgicCIsIG51bGwsICJFcnJvciBuYW1lOiAiLCBkZXZFcnJvci5uYW1lLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKSwgIk1lc3NhZ2U6ICIsIGRldkVycm9yLm1lc3NhZ2UpKSkpOwogICAgICByZXR1cm4gcG9ydGFsVUkgPyBmb3JtUmVuZGVyIDogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoTW9kYWwsIHsKICAgICAgICBuYW1lOiBuYW1lLAogICAgICAgIG9uQ2xvc2U6IHRoaXMuaGFuZGxlQ2xvc2UsCiAgICAgICAgdGl0bGU6ICIiLmNvbmNhdChpbnRsLmZvcm1hdE1lc3NhZ2UobGFiZWxzLndpdGhkcm93TW9kYWwpLCAnICcpLmNvbmNhdChjdXJyZW5jeS50b1VwcGVyQ2FzZSgpKQogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICBwYWRkaW5nQm90dG9tOiAnNTBweCcsCiAgICAgICAgICBwYWRkaW5nVG9wOiAnMTVweCcKICAgICAgICB9CiAgICAgIH0sIGZvcm1SZW5kZXIpKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBXaXRoZHJhd01vZGFsOwp9KFJlYWN0LkNvbXBvbmVudCksIF90ZW1wKSkgfHwgX2NsYXNzKSB8fCBfY2xhc3MpIHx8IF9jbGFzcyk7CmV4cG9ydCB7IFdpdGhkcmF3TW9kYWwgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/components/modals/WithdrawModal/WithdrawModal.tsx"],"names":["React","Fragment","cx","cssModules","styles","actions","Link","connect","typeforce","BigNumber","FormattedMessage","injectIntl","defineMessages","isMobile","inputReplaceCommaWithDot","localisedUrl","minAmount","redirectTo","getCurrencyKey","lsDataCache","helpers","constants","links","adminFee","feedback","Modal","FieldLabel","Input","Button","Tooltip","QrReader","InvoiceInfoBlock","AdminFeeInfoBlock","CurrencyList","FeeInfoBlock","isDark","localStorage","getItem","WithdrawModal","currencies","user","ethData","btcData","ghostData","nextData","tokensData","activeFiat","isBalanceFetching","activeCurrency","dashboardModalsAllowed","ui","items","tokenItems","Object","keys","map","k","dashboardView","allowMultiple","props","error","details","withdraw","failed","message","console","JSON","stringify","setState","devError","name","data","allCurrencyies","concat","currentActiveAsset","state","selectedItem","address","isUserProtected","isSmsProtected","isPinProtected","currentDecimals","amount","method","BYTE_IN_KB","numAmount","Number","btc","estimateFeeValue","speed","moreInfo","feeRate","txSize","fee","feeSatByte","dividedBy","dp","ROUND_CEIL","toNumber","mounted","btcFeeRate","fees","miner","total","service","plus","reportError","currency","isEthToken","usedAdminFee","currentCoin","toLowerCase","adminFeeSize","calc","newMinerFee","fetchFee","eth","ethToken","coinsWithDynamicFee","includes","isBTC","setBtcFeeRate","setAlowedBalances","started","to","ownTx","comment","invoice","onReady","isShipped","sendOptions","from","beforeBalances","invoices","markInvoice","id","loader","hide","notifications","show","SuccessWithdraw","modals","close","Function","nextStepModal","WithdrawBtcPin","WithdrawBtcSms","WithdrawBtcMultisig","open","wallet","send","then","txRaw","getBalance","txInfo","transactions","getInfo","txId","tx","pullTxBalances","txInfoCache","senderAddress","receiverAddress","confirmed","push","key","time","finished","comments","setComment","txInfoUrl","getTxRouter","errorText","res","text","customError","defaultMessage","test","fullName","openScanCam","split","openScan","value","exCurrencyRate","selectedValue","clearTimeout","btcFeeTimer","setTimeout","hasExCurrencyRate","isGreaterThan","fiatAmount","times","toString","div","history","locale","intl","home","balances","ONE_HUNDRED_PERCENT","minerFee","maxService","multipliedBy","balance","maxAmount","minus","maxFiatAmount","isLessThanOrEqualTo","allowedCurrency","allowedFiat","newServiceFeeSize","event","BACKSPACE","LEFT_ARROW","RIGHT_ARROW","DELETE","isNumber","amountValue","target","keyCode","preventDefault","maxQuantityDecimals","length","toAddress","withdrawWallet","tokenDecimals","core","getWallets","getWithdrawWallet","isEnabled","infoAboutCurrency","price_fiat","arrWithEthWallet","filter","item","ethWallet","hiddenCoinsList","getHiddenCoins","isInvoicePay","setCommissions","entered","prevProps","prevState","prevData","prevItems","prevAmount","prevFiatAmount","setCurrenctActiveAsset","updateServiceAndTotalFee","isCoinAddress","BTC","addressIsCorrect","ETH","toUpperCase","isBTCWallet","portalUI","linked","all","currentAddress","currentBalance","tableRows","activeCriptoCurrency","selectedValueView","criptoCurrencyHaveInfoPrice","returnHaveInfoPrice","ethBalanceLessThanMiner","isLessThan","exEthereumRate","result","forEach","isDisabled","labels","withdrowModal","balanceFiatMobile","balanceFiatDesktop","balanceMobile","balanceDesktop","ownTxPlaceholder","dataCurrency","formRender","handleScan","br","marginBottom","textAlign","right","additionalСurrenciesItemActive","handleBuyCurrencySelect","amountInputKeyDownCallback","pipe","handleAmount","marginLeft","setMaxBalance","isEqualTo","allowedBalance","maxWidth","formatMessage","handleClose","handleSubmit","paddingTop","paddingBottom","Component"],"mappings":"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","sourcesContent":["import React, { Fragment } from 'react'\r\nimport cx from 'classnames'\r\nimport cssModules from 'react-css-modules'\r\nimport styles from './WithdrawModal.scss'\r\n\r\nimport actions from 'redux/actions'\r\nimport Link from 'local_modules/sw-valuelink'\r\nimport { connect } from 'redaction'\r\nimport typeforce from 'swap.app/util/typeforce'\r\nimport { BigNumber } from 'bignumber.js'\r\nimport { FormattedMessage, injectIntl, defineMessages } from 'react-intl'\r\nimport { isMobile } from 'react-device-detect'\r\n\r\nimport { inputReplaceCommaWithDot } from 'helpers/domUtils'\r\nimport { localisedUrl } from 'helpers/locale'\r\nimport minAmount from 'helpers/constants/minAmount'\r\nimport redirectTo from 'helpers/redirectTo'\r\nimport getCurrencyKey from 'helpers/getCurrencyKey'\r\nimport lsDataCache from 'helpers/lsDataCache'\r\nimport helpers, {\r\n  constants,\r\n  links,\r\n  adminFee,\r\n  feedback,\r\n} from 'helpers'\r\n\r\nimport Modal from 'components/modal/Modal/Modal'\r\nimport FieldLabel from 'components/forms/FieldLabel/FieldLabel'\r\nimport Input from 'components/forms/Input/Input'\r\nimport Button from 'components/controls/Button/Button'\r\nimport Tooltip from 'components/ui/Tooltip/Tooltip'\r\nimport QrReader from 'components/QrReader'\r\nimport InvoiceInfoBlock from 'components/InvoiceInfoBlock/InvoiceInfoBlock'\r\nimport AdminFeeInfoBlock from 'components/AdminFeeInfoBlock/AdminFeeInfoBlock'\r\nimport CurrencyList from './components/CurrencyList'\r\nimport FeeInfoBlock from './components/FeeInfoBlock'\r\n\r\nconst isDark = localStorage.getItem(constants.localStorage.isDark)\r\n\r\ntype Currency = {\r\n  addAssets: boolean\r\n  fullTitle: string\r\n  icon: string\r\n  name: string\r\n  title: string\r\n  value: string\r\n}\r\n\r\ntype WithdrawModalProps = {\r\n  name: 'WithdrawModal'\r\n  activeFiat: string\r\n  activeCurrency: string\r\n  dashboardView: boolean\r\n  isBalanceFetching: boolean\r\n  currencies: Currency[]\r\n\r\n  intl: IUniversalObj\r\n  history: IUniversalObj\r\n  data: IUniversalObj\r\n  tokenItems: IUniversalObj[]\r\n  items: IUniversalObj[]\r\n\r\n  portalUI?: any\r\n}\r\n\r\ntype WithdrawModalState = {\r\n  isShipped: boolean\r\n  isEthToken: boolean\r\n  fetchFee: boolean\r\n  isInvoicePay?: boolean\r\n  openScanCam: boolean\r\n  \r\n  address: string\r\n  comment?: string\r\n  ownTx: string\r\n  selectedValue: string\r\n  fiatAmount: string\r\n  amount: string\r\n  \r\n  currentDecimals: number\r\n  btcFeeRate: number\r\n  txSize: null | number\r\n  \r\n  devError: IError | null\r\n  ethWallet: IUniversalObj\r\n  exCurrencyRate: BigNumber\r\n  fees: {\r\n    miner: BigNumber\r\n    service: BigNumber\r\n    total: BigNumber\r\n    adminFeeSize: BigNumber\r\n  }\r\n  usedAdminFee: {\r\n    address: string\r\n    fee: number\r\n    min: number\r\n  }\r\n  balances: {\r\n    balance: BigNumber\r\n    allowedCurrency: BigNumber\r\n    allowedFiat: BigNumber\r\n  }\r\n\r\n  hiddenCoinsList: string[]\r\n  currentActiveAsset: IUniversalObj\r\n  allCurrencyies: IUniversalObj[]\r\n  selectedItem: IUniversalObj\r\n}\r\n\r\n@injectIntl\r\n@connect(\r\n  ({\r\n    currencies,\r\n    user: {\r\n      ethData,\r\n      btcData,\r\n      ghostData,\r\n      nextData,\r\n      tokensData,\r\n      activeFiat,\r\n      isBalanceFetching,\r\n      activeCurrency,\r\n    },\r\n    ui: { dashboardModalsAllowed },\r\n  }) => ({\r\n    activeFiat,\r\n    activeCurrency,\r\n    currencies: currencies.items,\r\n    items: [ethData, btcData, ghostData, nextData],\r\n    tokenItems: [...Object.keys(tokensData).map((k) => tokensData[k])],\r\n    dashboardView: dashboardModalsAllowed,\r\n    isBalanceFetching,\r\n  })\r\n)\r\n@cssModules(styles, { allowMultiple: true })\r\nexport default class WithdrawModal extends React.Component<WithdrawModalProps, WithdrawModalState> {\r\n  mounted = true\r\n  btcFeeTimer: ReturnType<typeof setTimeout> | null = null\r\n\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    const {\r\n      items,\r\n      data: { \r\n        amount, \r\n        toAddress, \r\n        currency,\r\n        address: withdrawWallet,\r\n      },\r\n    } = props\r\n\r\n    const currentActiveAsset = props.data\r\n    const currentDecimals = constants.tokenDecimals[getCurrencyKey(currency, true).toLowerCase()]\r\n    const allCurrencyies = actions.core.getWallets({}) //items.concat(tokenItems)\r\n    const selectedItem = actions.user.getWithdrawWallet(currency, withdrawWallet)\r\n    const usedAdminFee = adminFee.isEnabled(selectedItem.currency)\r\n    const infoAboutCurrency = currentActiveAsset.infoAboutCurrency\r\n    const isEthToken = helpers.ethToken.isEthToken({ name: currency.toLowerCase() })\r\n    const exCurrencyRate = infoAboutCurrency && infoAboutCurrency.price_fiat\r\n      ? new BigNumber(currentActiveAsset.infoAboutCurrency.price_fiat)\r\n      : new BigNumber(0)\r\n    // save ethereum wallet for token exchange's rate\r\n    const arrWithEthWallet = items.filter(item => {\r\n      return item.currency.toLowerCase() === 'eth' \r\n        && item.infoAboutCurrency\r\n        && item.infoAboutCurrency.price_fiat\r\n    })\r\n    const ethWallet = arrWithEthWallet[0] || {}\r\n\r\n    this.state = {\r\n      isShipped: false,\r\n      usedAdminFee,\r\n      openScanCam: false,\r\n      address: toAddress ? toAddress : '',\r\n      fiatAmount: '',\r\n      amount: '',\r\n      selectedItem,\r\n      isEthToken,\r\n      currentDecimals,\r\n      selectedValue: currency,\r\n      ownTx: '',\r\n      hiddenCoinsList: actions.core.getHiddenCoins(),\r\n      currentActiveAsset,\r\n      ethWallet,\r\n      exCurrencyRate,\r\n      allCurrencyies,\r\n      devError: null,\r\n      fees: {\r\n        miner: new BigNumber(0),\r\n        service: new BigNumber(0),\r\n        total: new BigNumber(0),\r\n        adminFeeSize: new BigNumber(0),\r\n      },\r\n      balances: {\r\n        balance: new BigNumber(selectedItem.balance || 0),\r\n        allowedCurrency: new BigNumber(0),\r\n        allowedFiat: new BigNumber(0),\r\n      },\r\n      btcFeeRate: null,\r\n      fetchFee: true,\r\n      txSize: null,\r\n      isInvoicePay: !!(currentActiveAsset.invoice),\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.mounted = false\r\n    clearTimeout(this.btcFeeTimer)\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setCommissions()\r\n    feedback.withdraw.entered()\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    const { \r\n      data: prevData, \r\n      items: prevItems,\r\n    } = prevProps\r\n    const { \r\n      data, \r\n      items,\r\n    } = this.props\r\n    const {\r\n      amount: prevAmount,\r\n      fiatAmount: prevFiatAmount,\r\n    } = prevState\r\n    const {\r\n      amount,\r\n      fiatAmount,\r\n    } = this.state\r\n\r\n    if (prevData !== data || prevItems !== items) {\r\n      this.setCurrenctActiveAsset()\r\n    }\r\n    if (prevAmount !== amount || prevFiatAmount !== fiatAmount) {\r\n      this.updateServiceAndTotalFee()\r\n    }\r\n  }\r\n\r\n  reportError = (error: IError, details: string = '-') => {\r\n    feedback.withdraw.failed(`details(${details}) : error message(${error.message})`)\r\n    console.error(`Withdraw. details(${details}) : error(${JSON.stringify(error)})`)\r\n    this.setState({ \r\n      devError: {\r\n        name: error.name || 'Error',\r\n        message: error.message || '-',\r\n      },\r\n    })\r\n  }\r\n\r\n  setCurrenctActiveAsset = () => {\r\n    const { items, tokenItems, data } = this.props\r\n    const allCurrencyies = items.concat(tokenItems)\r\n    this.setState({\r\n      currentActiveAsset: data,\r\n      allCurrencyies,\r\n    })\r\n  }\r\n\r\n  setBtcFeeRate = async () => {\r\n    const {\r\n      selectedItem: {\r\n        address,\r\n        isUserProtected,\r\n        isSmsProtected,\r\n        isPinProtected,\r\n      },\r\n      currentDecimals,\r\n      amount,\r\n    } = this.state\r\n\r\n    let method = `send`\r\n    if (isUserProtected) method = `send_multisig`\r\n    if (isSmsProtected || isPinProtected) method = `send_2fa`\r\n\r\n    const BYTE_IN_KB = 1024\r\n    const numAmount = Number(amount) || 0\r\n\r\n    try {\r\n      const { feeRate, txSize, fee } = await helpers.btc.estimateFeeValue({\r\n        method,\r\n        speed: 'fast',\r\n        address,\r\n        amount: numAmount,\r\n        moreInfo: true,\r\n      })\r\n      const feeSatByte = new BigNumber(feeRate).dividedBy(BYTE_IN_KB).dp(0, BigNumber.ROUND_CEIL).toNumber()\r\n\r\n      if (!this.mounted) return\r\n      this.setState((state) => ({\r\n        btcFeeRate: feeSatByte,\r\n        txSize,\r\n        fees: {\r\n          ...state.fees,\r\n          miner: new BigNumber(fee),\r\n          total: state.fees.service.plus(fee).dp(currentDecimals, BigNumber.ROUND_CEIL),\r\n        },\r\n      }))\r\n    } catch (error) {\r\n      this.reportError(error)\r\n    }\r\n  }\r\n\r\n  setCommissions = async () => {\r\n    const {\r\n      data: { currency },\r\n    } = this.props\r\n    const {\r\n      isEthToken,\r\n      selectedItem,\r\n      usedAdminFee,\r\n      amount,\r\n      currentDecimals,\r\n    } = this.state\r\n\r\n    const currentCoin = getCurrencyKey(currency, true).toLowerCase()\r\n    const adminFeeSize = usedAdminFee ? adminFee.calc(currency, amount) : 0\r\n    let newMinerFee = new BigNumber(0)\r\n\r\n    if (!this.mounted) return\r\n    this.setState({ fetchFee: true })\r\n\r\n    try {\r\n      if (isEthToken) {\r\n        // if decimals < 7 then equal 0.0...1\r\n        // if decimals >= 7 then equal 1e-<decimals>\r\n        minAmount[currentCoin] = 10 ** -currentDecimals\r\n        minAmount.eth = await helpers.eth.estimateFeeValue({\r\n          method: 'send',\r\n          speed: 'fast',\r\n        })\r\n\r\n        newMinerFee = new BigNumber(await helpers.ethToken.estimateFeeValue({\r\n          method: 'send',\r\n          speed: 'fast',\r\n        }))\r\n      } else if (constants.coinsWithDynamicFee.includes(currentCoin)) {\r\n        let method = 'send'\r\n        if (selectedItem.isUserProtected) method = 'send_multisig'\r\n        if (selectedItem.isPinProtected || selectedItem.isSmsProtected) method = 'send_2fa'\r\n\r\n        newMinerFee = new BigNumber(await helpers[currentCoin].estimateFeeValue({\r\n          method,\r\n          speed: 'fast',\r\n          address: selectedItem.address,\r\n          amount,\r\n        }))\r\n\r\n        minAmount[currentCoin] = newMinerFee.toNumber()\r\n\r\n        if (selectedItem.isBTC) {\r\n          this.setBtcFeeRate()\r\n        }\r\n      }\r\n\r\n      this.setState((state) => ({\r\n        fees: {\r\n          ...state.fees,\r\n          miner: newMinerFee,\r\n          service: new BigNumber(adminFeeSize).dp(currentDecimals, BigNumber.ROUND_CEIL),\r\n          total: newMinerFee.plus(adminFeeSize).dp(currentDecimals, BigNumber.ROUND_CEIL),\r\n          adminFeeSize: new BigNumber(adminFeeSize),\r\n        },\r\n      }))\r\n      this.setAlowedBalances()\r\n    } catch (error) {\r\n      this.reportError(error)\r\n    } finally {\r\n      this.setState({ fetchFee: false })\r\n    }\r\n  }\r\n\r\n  handleSubmit = async () => {\r\n    feedback.withdraw.started()\r\n\r\n    const {\r\n      address: to,\r\n      amount,\r\n      ownTx,\r\n      fees,\r\n      selectedItem,\r\n      isEthToken,\r\n      comment = ''\r\n    } = this.state\r\n\r\n    const {\r\n      data: { currency, address, invoice, onReady },\r\n      name,\r\n    } = this.props\r\n\r\n    this.setState(() => ({\r\n      isShipped: true,\r\n      devError: null,\r\n    }))\r\n\r\n    let sendOptions = {\r\n      from: address,\r\n      to,\r\n      amount,\r\n      speed: 'fast',\r\n      name: isEthToken ? currency.toLowerCase() : '',\r\n    }\r\n\r\n    // ? is it need ?\r\n    // Опрашиваем балансы отправителя и получателя на момент выполнения транзакции\r\n    // Нужно для расчета final balance получателя и отправителя\r\n    let beforeBalances = false\r\n    // try {\r\n    //   // beforeBalances = await helpers.transactions.getTxBalances(currency, address, to)\r\n    // } catch (error) {\r\n    //   this.reportError(error, 'Fail fetch balances - may be destination is segwit')\r\n    // }\r\n\r\n    if (invoice && ownTx) {\r\n      await actions.invoices.markInvoice(invoice.id, 'ready', ownTx, address)\r\n      actions.loader.hide()\r\n      actions.notifications.show(constants.notifications.SuccessWithdraw, {\r\n        amount,\r\n        currency,\r\n        address: to,\r\n      })\r\n      this.setState(() => ({ isShipped: false }))\r\n      actions.modals.close(name)\r\n      if (onReady instanceof Function) {\r\n        onReady()\r\n      }\r\n      return\r\n    }\r\n\r\n    if (selectedItem.isPinProtected || selectedItem.isSmsProtected || selectedItem.isUserProtected) {\r\n      let nextStepModal = constants.modals.WithdrawBtcPin\r\n      if (selectedItem.isSmsProtected) nextStepModal = constants.modals.WithdrawBtcSms\r\n      if (selectedItem.isUserProtected) nextStepModal = constants.modals.WithdrawBtcMultisig\r\n\r\n      actions.modals.close(name)\r\n      actions.modals.open(nextStepModal, {\r\n        wallet: selectedItem,\r\n        invoice,\r\n        sendOptions,\r\n        beforeBalances,\r\n        onReady,\r\n        adminFee: fees.adminFeeSize,\r\n      })\r\n      return\r\n    }\r\n\r\n    await actions[currency.toLowerCase()]\r\n      .send(sendOptions)\r\n      .then(async (txRaw) => {\r\n        actions.loader.hide()\r\n        actions[currency.toLowerCase()].getBalance(currency)\r\n        if (invoice) {\r\n          await actions.invoices.markInvoice(invoice.id, 'ready', txRaw, address)\r\n        }\r\n\r\n        this.setState({\r\n          isShipped: false\r\n        })\r\n\r\n        if (onReady instanceof Function) {\r\n          onReady()\r\n        }\r\n\r\n        // Redirect to tx\r\n        const txInfo = helpers.transactions.getInfo(currency.toLowerCase(), txRaw)\r\n        const { tx: txId } = txInfo\r\n\r\n        // Не используем await. Сбрасываем статистику по транзакции (final balance)\r\n        // Без блокировки клиента\r\n        // Результат и успешность запроса критического значения не имеют\r\n        helpers.transactions.pullTxBalances(txId, amount, beforeBalances, adminFee)\r\n\r\n        // Сохраняем транзакцию в кеш\r\n        const txInfoCache = {\r\n          amount,\r\n          senderAddress: address,\r\n          receiverAddress: to,\r\n          confirmed: false,\r\n          adminFee: fees.adminFeeSize,\r\n        }\r\n\r\n        lsDataCache.push({\r\n          key: `TxInfo_${currency.toLowerCase()}_${txId}`,\r\n          time: 3600,\r\n          data: txInfoCache,\r\n        })\r\n        feedback.withdraw.finished()\r\n\r\n        if (comment) {\r\n          actions.comments.setComment({\r\n            key: txId,\r\n            comment: comment\r\n          })\r\n        }\r\n\r\n        const txInfoUrl = helpers.transactions.getTxRouter(currency.toLowerCase(), txId)\r\n        redirectTo(txInfoUrl)\r\n      })\r\n      .then(() => {\r\n        actions.modals.close(name)\r\n      })\r\n      .catch((error) => {\r\n        const { selectedItem } = this.state\r\n        const errorText = error.res ? error.res.text : ''\r\n        const customError = {\r\n          name: {\r\n            id: 'Withdraw218',\r\n            defaultMessage: 'Withdrawal error',\r\n          },\r\n          message: {\r\n            id: 'ErrorNotification12',\r\n            defaultMessage: 'Oops, looks like something went wrong!',\r\n          },\r\n        }\r\n\r\n        if (/insufficient priority|bad-txns-inputs-duplicate/.test(errorText)) {\r\n          customError.message = {\r\n            id: 'Withdraw232',\r\n            defaultMessage: 'There is not enough confirmation of the last transaction. Try later.',\r\n          }\r\n        }\r\n\r\n        this.reportError(error, `selected item: ${selectedItem.fullName} | custom message: ${customError.message.defaultMessage}`)\r\n        this.setState(() => ({\r\n          isShipped: false,\r\n        }))\r\n      })\r\n  }\r\n\r\n  addressIsCorrect() {\r\n    const {\r\n      data: { currency },\r\n    } = this.props\r\n    const { address, isEthToken } = this.state\r\n\r\n    if (getCurrencyKey(currency, false).toLowerCase() === `btc`) {\r\n      if (!typeforce.isCoinAddress.BTC(address)) {\r\n        return actions.btc.addressIsCorrect(address)\r\n      }\r\n      return true\r\n    }\r\n\r\n    if (isEthToken) {\r\n      return typeforce.isCoinAddress.ETH(address)\r\n    }\r\n\r\n    return typeforce.isCoinAddress[getCurrencyKey(currency, false).toUpperCase()](address)\r\n  }\r\n\r\n  openScan = () => {\r\n    const { openScanCam } = this.state\r\n\r\n    this.setState(() => ({\r\n      openScanCam: !openScanCam,\r\n    }))\r\n  }\r\n\r\n  handleScan = (data) => {\r\n    if (data) {\r\n      const address = data.split(':')[1].split('?')[0]\r\n      const amount = data.split('=')[1]\r\n\r\n      this.setState(() => ({ address, amount }))\r\n      this.openScan()\r\n    }\r\n  }\r\n  // (value: any) => void' is not assignable to parameter of type Transform<string>\r\n  handleAmount = (value): any => {\r\n    const {\r\n      currentActiveAsset,\r\n      currentDecimals,\r\n      exCurrencyRate,\r\n      selectedValue,\r\n      selectedItem: {\r\n        isBTC,\r\n      },\r\n    } = this.state\r\n\r\n    if (isBTC) {\r\n      clearTimeout(this.btcFeeTimer)\r\n      this.btcFeeTimer = setTimeout(() => {\r\n        this.setBtcFeeRate()\r\n      }, 2000)\r\n    }\r\n\r\n    const hasExCurrencyRate = exCurrencyRate.isGreaterThan(0)\r\n\r\n    if (selectedValue === currentActiveAsset.currency) {\r\n      this.setState({\r\n        fiatAmount: value && hasExCurrencyRate\r\n          ? exCurrencyRate.times(value).dp(2, BigNumber.ROUND_CEIL).toString()\r\n          : '',\r\n        amount: value,\r\n      })\r\n    } else {\r\n      this.setState({\r\n        fiatAmount: value,\r\n        amount: value && hasExCurrencyRate\r\n          ? new BigNumber(value).div(exCurrencyRate).dp(currentDecimals).toString() \r\n          : '',\r\n      })\r\n    }\r\n  }\r\n\r\n  handleClose = () => {\r\n    const {\r\n      history,\r\n      intl: { locale },\r\n    } = this.props\r\n    const { name } = this.props\r\n\r\n    history.push(localisedUrl(locale, links.home))\r\n    actions.modals.close(name)\r\n  }\r\n\r\n  handleBuyCurrencySelect = (value) => {\r\n    this.setState({\r\n      selectedValue: value,\r\n    })\r\n  }\r\n\r\n  setAlowedBalances = () => {\r\n    const {\r\n      isEthToken,\r\n      usedAdminFee,\r\n      currentDecimals,\r\n      exCurrencyRate,\r\n      balances,\r\n      fees,\r\n    } = this.state\r\n\r\n    const ONE_HUNDRED_PERCENT = 100\r\n    const minerFee = isEthToken ? new BigNumber(0) : fees.miner\r\n    const maxService = usedAdminFee\r\n        ? new BigNumber(usedAdminFee.fee).dividedBy(ONE_HUNDRED_PERCENT).multipliedBy(balances.balance)\r\n        : new BigNumber(0)\r\n    const maxAmount = balances.balance.minus(minerFee).minus(maxService).dp(currentDecimals, BigNumber.ROUND_CEIL)\r\n    const maxFiatAmount = maxAmount.multipliedBy(exCurrencyRate).dp(2, BigNumber.ROUND_CEIL)\r\n\r\n    if (maxAmount.isGreaterThan(balances.balance) || maxAmount.isLessThanOrEqualTo(0)) {\r\n      this.setState((state) => ({\r\n        balances: {\r\n          ...state.balances,\r\n          allowedCurrency: new BigNumber(0),\r\n          allowedFiat: new BigNumber(0),\r\n        },\r\n      }))\r\n    } else {\r\n      this.setState((state) => ({\r\n        balances: {\r\n          ...state.balances,\r\n          allowedCurrency: maxAmount,\r\n          allowedFiat: maxFiatAmount,\r\n        },\r\n      }))\r\n    }\r\n  }\r\n\r\n  setMaxBalance = () => {\r\n    const { balances } = this.state\r\n\r\n    this.setState({\r\n      amount: balances.allowedCurrency.toString(),\r\n      fiatAmount: balances.allowedFiat.toString(),\r\n    })\r\n  }\r\n\r\n  updateServiceAndTotalFee = () => {\r\n    const { usedAdminFee, amount, fees, currentDecimals } = this.state\r\n    const ONE_HUNDRED_PERCENT = 100\r\n\r\n    let newServiceFeeSize = usedAdminFee\r\n      ? new BigNumber(usedAdminFee.fee).dividedBy(ONE_HUNDRED_PERCENT).multipliedBy(amount)\r\n      : new BigNumber(0)\r\n\r\n    newServiceFeeSize = new BigNumber(amount).isGreaterThan(0) \r\n      && newServiceFeeSize.isGreaterThan(fees.adminFeeSize)\r\n        ? newServiceFeeSize\r\n        : fees.adminFeeSize\r\n    \r\n    this.setState((state) => ({\r\n      fees: {\r\n        ...state.fees,\r\n        service: newServiceFeeSize.dp(currentDecimals, BigNumber.ROUND_CEIL),\r\n        total: fees.miner.plus(newServiceFeeSize).dp(currentDecimals, BigNumber.ROUND_CEIL),\r\n      },\r\n    }))\r\n  }\r\n\r\n  amountInputKeyDownCallback = (event) => {\r\n    const { currentDecimals, currentActiveAsset, selectedValue } = this.state\r\n    // key codes\r\n    const BACKSPACE = 8\r\n    const LEFT_ARROW = 37\r\n    const RIGHT_ARROW = 39\r\n    const DELETE = 46\r\n    const isNumber = +event.key >= 0 && +event.key <= 9\r\n    const amountValue = event.target.value\r\n\r\n    if (event.key === ',') {\r\n      inputReplaceCommaWithDot(event)\r\n    }\r\n    \r\n    if (\r\n      !(isNumber ||\r\n        event.keyCode === BACKSPACE ||\r\n        event.keyCode === LEFT_ARROW ||\r\n        event.keyCode === RIGHT_ARROW ||\r\n        event.keyCode === DELETE ||\r\n        event.key === '.' ||\r\n        event.key === ','\r\n      )\r\n    ) {\r\n      event.preventDefault()\r\n    } else if (amountValue.includes('.')) {\r\n      // block number input if quantity decimal places\r\n      // more than allowed (crypto: currentDecimals | fiat: 2)\r\n      const maxQuantityDecimals = selectedValue === currentActiveAsset.currency\r\n        ? amountValue.split('.')[1].length === currentDecimals\r\n        : amountValue.split('.')[1].length === 2\r\n\r\n      maxQuantityDecimals && isNumber && event.preventDefault()\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      ownTx,\r\n      amount,\r\n      address,\r\n      balances,\r\n      ethWallet,\r\n      isShipped,\r\n      fiatAmount,\r\n      isEthToken,\r\n      openScanCam,\r\n      exCurrencyRate,\r\n      currentDecimals,\r\n      hiddenCoinsList,\r\n      currentActiveAsset,\r\n      selectedValue,\r\n      usedAdminFee,\r\n      devError,\r\n      fees,\r\n      fetchFee,\r\n      txSize,\r\n      btcFeeRate,\r\n      selectedItem: {\r\n        isBTC: isBTCWallet,\r\n      },\r\n    } = this.state\r\n\r\n    const { name, intl, portalUI, activeFiat, dashboardView } = this.props\r\n    const linked = Link.all(this, 'address', 'amount', 'ownTx', 'fiatAmount', 'comment')\r\n\r\n    const {\r\n      currency,\r\n      address: currentAddress,\r\n      balance: currentBalance,\r\n      invoice,\r\n    } = currentActiveAsset\r\n\r\n    let tableRows = actions.core.getWallets({}).filter(({ currency, address, balance }) => {\r\n      // @ToDo - В будущем нужно убрать проверку только по типу монеты.\r\n      // Старую проверку оставил, чтобы у старых пользователей не вывалились скрытые кошельки\r\n\r\n      return (\r\n        (!hiddenCoinsList.includes(currency) &&\r\n          !hiddenCoinsList.includes(`${currency}:${address}`)) ||\r\n        balance > 0\r\n      )\r\n    })\r\n\r\n    const activeCriptoCurrency = getCurrencyKey(currentActiveAsset.currency, true).toUpperCase()\r\n    const selectedValueView = getCurrencyKey(selectedValue, true).toUpperCase()\r\n    const criptoCurrencyHaveInfoPrice = returnHaveInfoPrice();\r\n    const ethBalanceLessThanMiner = new BigNumber(ethWallet.balance).isLessThan(fees.miner)\r\n    const exEthereumRate = new BigNumber(ethWallet.infoAboutCurrency.price_fiat || 0)\r\n\r\n    function returnHaveInfoPrice(): boolean {\r\n      let result = true\r\n\r\n      tableRows.forEach(item => {\r\n        if (item.currency === activeCriptoCurrency) {\r\n          result = item.infoAboutCurrency && item.infoAboutCurrency.price_fiat\r\n        }\r\n      })\r\n\r\n      return result\r\n    }\r\n\r\n    const isDisabled =\r\n      !address ||\r\n      !+amount ||\r\n      isShipped ||\r\n      !!ownTx ||\r\n      !this.addressIsCorrect() ||\r\n      isEthToken && ethBalanceLessThanMiner ||\r\n      new BigNumber(amount).isGreaterThan(balances.balance) ||\r\n      new BigNumber(amount).dp() > currentDecimals\r\n\r\n\r\n    const labels = defineMessages({\r\n      withdrowModal: {\r\n        id: 'withdrowTitle271',\r\n        defaultMessage: `Send`,\r\n      },\r\n      balanceFiatMobile: {\r\n        id: 'Withdraw_FiatBalanceMobile',\r\n        defaultMessage: '~{amount} {currency}',\r\n      },\r\n      balanceFiatDesktop: {\r\n        id: 'Withdraw_FiatBalanceDesktop',\r\n        defaultMessage: 'это ~{amount} {currency}',\r\n      },\r\n      balanceMobile: {\r\n        id: 'Withdraw_BalanceMobile',\r\n        defaultMessage: '{amount} {currency}',\r\n      },\r\n      balanceDesktop: {\r\n        id: 'Withdraw_BalanceDesktop',\r\n        defaultMessage: '{amount} {currency} will be send',\r\n      },\r\n      ownTxPlaceholder: {\r\n        id: 'withdrawOwnTxPlaceholder',\r\n        defaultMessage: 'If paid from another source',\r\n      },\r\n    })\r\n\r\n    const dataCurrency = isEthToken ? 'ETH' : currency.toUpperCase()\r\n\r\n    const formRender = (\r\n      <Fragment>\r\n        {openScanCam && (\r\n          <QrReader\r\n            openScan={this.openScan}\r\n            handleError={this.reportError}\r\n            handleScan={this.handleScan}\r\n          />\r\n        )}\r\n        {invoice && <InvoiceInfoBlock invoiceData={invoice} />}\r\n        {!dashboardView && (\r\n          <p styleName={isEthToken ? 'rednotes' : 'notice'}>\r\n            <FormattedMessage\r\n              id=\"Withdrow213\"\r\n              defaultMessage=\"Please note: Fee is {minAmount} {data}.{br}Your balance must exceed this sum to perform transaction\"\r\n              values={{\r\n                minAmount: <span>{isEthToken ? minAmount.eth : fees.total.toNumber()}</span>,\r\n                br: <br />,\r\n                data: `${dataCurrency}`,\r\n              }}\r\n            />\r\n          </p>\r\n        )}\r\n\r\n        <div style={{ marginBottom: '40px' }}>\r\n          <div styleName=\"customSelectContainer\">\r\n            <FieldLabel>\r\n              <FormattedMessage id=\"Withdrow559\" defaultMessage=\"Send from wallet \" />\r\n            </FieldLabel>\r\n            <CurrencyList\r\n              {...this.props}\r\n              currentActiveAsset={currentActiveAsset}\r\n              currentBalance={currentBalance}\r\n              currency={currency}\r\n              exCurrencyRate={exCurrencyRate.toNumber()}\r\n              activeFiat={activeFiat}\r\n              tableRows={tableRows}\r\n              currentAddress={currentAddress}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div styleName=\"highLevel\">\r\n          <FieldLabel>\r\n            <FormattedMessage id=\"Withdrow1194\" defaultMessage=\"Address \" />{' '}\r\n            <Tooltip id=\"WtH203\">\r\n              <div style={{ textAlign: 'center' }}>\r\n                <FormattedMessage\r\n                  id=\"WTH275\"\r\n                  defaultMessage=\"Make sure the wallet you{br}are sending the funds to supports {currency}\"\r\n                  values={{\r\n                    br: <br />,\r\n                    currency: `${currency.toUpperCase()}`,\r\n                  }}\r\n                />\r\n              </div>\r\n            </Tooltip>\r\n          </FieldLabel>\r\n          <Input\r\n            valueLink={linked.address}\r\n            focusOnInit\r\n            pattern=\"0-9a-zA-Z:\"\r\n            placeholder={`Enter ${currency.toUpperCase()} address to transfer`}\r\n            qr={isMobile}\r\n            openScan={this.openScan}\r\n          />\r\n          {/* show invalid value warning in address input */}\r\n          {address && !this.addressIsCorrect() && (\r\n            <div styleName=\"rednote bottom0\">\r\n              <FormattedMessage\r\n                id=\"WithdrawIncorectAddress\"\r\n                defaultMessage=\"Your address not correct\"\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div styleName={`lowLevel ${isDark ? 'dark' : ''}`} style={{ marginBottom: '30px' }}>\r\n          {/* why style ? see tip for max button */}  \r\n          <div style={usedAdminFee ? { right: '20px' } : null} styleName=\"additionalСurrencies\">\r\n            {criptoCurrencyHaveInfoPrice && <>\r\n                <span\r\n                  styleName={cx('additionalСurrenciesItem', {\r\n                    additionalСurrenciesItemActive: selectedValue.toUpperCase() === activeFiat,\r\n                  })}\r\n                  onClick={() => this.handleBuyCurrencySelect(activeFiat)}\r\n                >\r\n                  {activeFiat}\r\n                </span>\r\n                <span styleName=\"delimiter\"></span>\r\n              </>\r\n            }\r\n            <span\r\n              styleName={cx('additionalСurrenciesItem', {\r\n                additionalСurrenciesItemActive:\r\n                  selectedValueView === activeCriptoCurrency,\r\n              })}\r\n              onClick={() => this.handleBuyCurrencySelect(currentActiveAsset.currency)}\r\n            >\r\n              {activeCriptoCurrency}\r\n            </span>\r\n          </div>\r\n          {/* why style ? see tip for max button */}\r\n          <p style={usedAdminFee ? { right: '10px' } : null} styleName='balance'>\r\n            {new BigNumber(amount).isGreaterThan(0) && criptoCurrencyHaveInfoPrice && (\r\n              <FormattedMessage\r\n                {...labels[\r\n                  selectedValue !== activeFiat\r\n                    ? isMobile\r\n                      ? `balanceFiatMobile`\r\n                      : `balanceFiatDesktop`\r\n                    : isMobile\r\n                    ? `balanceMobile`\r\n                    : `balanceDesktop`\r\n                ]}\r\n                values={{\r\n                  amount: selectedValue !== activeFiat\r\n                    ? new BigNumber(fiatAmount).dp(2, BigNumber.ROUND_CEIL).toNumber()\r\n                    : new BigNumber(amount).dp(6, BigNumber.ROUND_CEIL).toNumber(),\r\n                  currency: selectedValue !== activeFiat ? activeFiat : activeCriptoCurrency.toUpperCase(),\r\n                }}\r\n              />\r\n            )}\r\n          </p>\r\n\r\n          <FieldLabel>\r\n            <FormattedMessage id=\"Withdrow118\" defaultMessage=\"Amount\" />\r\n          </FieldLabel>\r\n          <div styleName=\"group\">\r\n            <Input\r\n              pattern=\"0-9\\.\"\r\n              onKeyDown={this.amountInputKeyDownCallback}\r\n              valueLink={selectedValue === currentActiveAsset.currency\r\n                ? linked.amount.pipe(this.handleAmount)\r\n                : linked.fiatAmount.pipe(this.handleAmount)\r\n              }\r\n            />\r\n            {/* \r\n            with service commission we can't send all balance (there is a remainder)\r\n            so we disable this button\r\n            */}\r\n            {!usedAdminFee &&\r\n              <>\r\n                <div style={{ marginLeft: '15px' }}>\r\n                  <Button disabled={fetchFee} blue big onClick={this.setMaxBalance} id=\"Withdrow134\">\r\n                    <FormattedMessage id=\"Select210\" defaultMessage=\"MAX\" />\r\n                  </Button>\r\n                </div>\r\n                {!isMobile && (\r\n                  <Tooltip id=\"Withdrow134\" place=\"top\" mark={false}>\r\n                    <FormattedMessage\r\n                      id=\"WithdrawButton32\"\r\n                      defaultMessage=\"When you click this button, in the field, an amount{br}equal to your balance minus the miners commission will appear\"\r\n                      values={{\r\n                        br: <br />,\r\n                      }}\r\n                    />\r\n                  </Tooltip>\r\n                )}\r\n              </>\r\n            }\r\n          </div>\r\n          {/* hint for amount value */}\r\n          {dashboardView && (\r\n            <div styleName={`prompt ${fetchFee ? 'hide' : ''}`}>\r\n              {isEthToken && ethBalanceLessThanMiner \r\n                ? (\r\n                    <FormattedMessage\r\n                      id=\"WithdrowBalanceNotEnoughtEthereumBalancePrompt\"\r\n                      defaultMessage=\"Not enough ethereum balance for miner fee\"\r\n                    />\r\n                  )\r\n                : balances.allowedCurrency.isEqualTo(0) ?\r\n                  (\r\n                    <FormattedMessage\r\n                      id=\"WithdrowBalanceNotEnoughtPrompt\"\r\n                      defaultMessage=\"Not enough balance to send\"\r\n                    />\r\n                  ) : (\r\n                    <FormattedMessage\r\n                      id=\"Withdrow170\"\r\n                      defaultMessage=\"Maximum amount you can send is {allowedBalance} {currency}\"\r\n                      values={{\r\n                        allowedBalance: selectedValue === currentActiveAsset.currency\r\n                          ? balances.allowedCurrency.toNumber()\r\n                          : balances.allowedFiat.toNumber(),\r\n                        currency: selectedValue === currentActiveAsset.currency \r\n                          ? activeCriptoCurrency\r\n                          : activeFiat,\r\n                      }}\r\n                    />\r\n                  )\r\n              }{' '}\r\n              <Tooltip id=\"WtH204\">\r\n                <div style={{ maxWidth: '24em', textAlign: 'center' }}>\r\n                  <FormattedMessage\r\n                    id=\"WTH276\"\r\n                    defaultMessage=\"The amount should not exceed your{br} current balance minus mining fee\"\r\n                    values={{\r\n                      br: <br />,\r\n                    }}\r\n                  />\r\n                </div>\r\n              </Tooltip>\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div styleName=\"commentFormWrapper\" >\r\n          <FieldLabel>\r\n            <FormattedMessage id=\"Comment\" defaultMessage=\"Comment\" />\r\n          </FieldLabel>\r\n          <div styleName=\"group\">\r\n            <Input\r\n              valueLink={linked.comment}\r\n              placeholder={\r\n                intl.formatMessage({\r\n                  id: 'Comment',\r\n                  defaultMessage: 'Comment',\r\n                })\r\n              }\r\n            />\r\n          </div>\r\n        </div>\r\n        <div styleName=\"sendBtnsWrapper\">\r\n          <div styleName=\"actionBtn\">\r\n            <Button big fill gray onClick={this.handleClose}>\r\n              <Fragment>\r\n                <FormattedMessage id=\"WithdrawModalCancelBtn\" defaultMessage=\"Cancel\" />\r\n              </Fragment>\r\n            </Button>\r\n          </div>\r\n          <div styleName=\"actionBtn\">\r\n            <Button blue big fill disabled={isDisabled} onClick={this.handleSubmit}>\r\n              {isShipped ? (\r\n                <Fragment>\r\n                  <FormattedMessage id=\"WithdrawModal11212\" defaultMessage=\"Processing ...\" />\r\n                </Fragment>\r\n              ) : (\r\n                <Fragment>\r\n                  <FormattedMessage id=\"WithdrawModal111\" defaultMessage=\"Send\" />{' '}\r\n                  {`${currency.toUpperCase()}`}\r\n                </Fragment>\r\n              )}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n        {usedAdminFee && isEthToken && (\r\n          <AdminFeeInfoBlock {...usedAdminFee} currency={currency} />\r\n        )}\r\n        {invoice && (\r\n          <Fragment>\r\n            <hr />\r\n            <div styleName=\"lowLevel\" style={{ marginBottom: '50px' }}>\r\n              <div styleName=\"groupField\">\r\n                <div styleName=\"downLabel\">\r\n                  <FieldLabel inRow>\r\n                    <span styleName=\"mobileFont\">\r\n                      <FormattedMessage id=\"WithdrowOwnTX\" defaultMessage=\"Или укажите TX\" />\r\n                    </span>\r\n                  </FieldLabel>\r\n                </div>\r\n              </div>\r\n              <div styleName=\"group\">\r\n                <Input\r\n                  styleName=\"input\"\r\n                  valueLink={linked.ownTx}\r\n                  placeholder={`${intl.formatMessage(labels.ownTxPlaceholder)}`}\r\n                />\r\n              </div>\r\n            </div>\r\n            <Button\r\n              styleName=\"buttonFull\"\r\n              blue\r\n              big\r\n              fullWidth\r\n              disabled={!ownTx || isShipped}\r\n              onClick={this.handleSubmit}\r\n            >\r\n              {isShipped ? (\r\n                <Fragment>\r\n                  <FormattedMessage id=\"WithdrawModal11212\" defaultMessage=\"Processing ...\" />\r\n                </Fragment>\r\n              ) : (\r\n                <FormattedMessage\r\n                  id=\"WithdrawModalInvoiceSaveTx\"\r\n                  defaultMessage=\"Отметить как оплаченный\"\r\n                />\r\n              )}\r\n            </Button>\r\n          </Fragment>\r\n        )}\r\n        {dashboardView && (\r\n          <>\r\n            <div style={{ paddingTop: '2em' }}>\r\n              <FeeInfoBlock\r\n                isEthToken={isEthToken}\r\n                currency={currency}\r\n                currentDecimals={currentDecimals}\r\n                activeFiat={activeFiat}\r\n                dataCurrency={dataCurrency}\r\n                exEthereumRate={exEthereumRate}\r\n                exCurrencyRate={exCurrencyRate}\r\n                feeCurrentCurrency={btcFeeRate}\r\n                isLoading={fetchFee}\r\n                usedAdminFee={usedAdminFee}\r\n                hasTxSize={isBTCWallet}\r\n                txSize={txSize}\r\n                minerFee={fees.miner}\r\n                serviceFee={fees.service}\r\n                totalFee={fees.total}\r\n              />\r\n            </div>\r\n            {devError && (\r\n                <div styleName=\"errorBlock\">\r\n                  <p>\r\n                    Error name: {devError.name}<br />\r\n                    Message: {devError.message}\r\n                  </p>\r\n                </div>\r\n              )\r\n            }\r\n          </>\r\n        )}\r\n      </Fragment>\r\n    )\r\n    return portalUI ? (\r\n      formRender\r\n    ) : (\r\n      <Modal\r\n        name={name}\r\n        onClose={this.handleClose}\r\n        title={`${intl.formatMessage(labels.withdrowModal)}${' '}${currency.toUpperCase()}`}\r\n      >\r\n        <div style={{ paddingBottom: '50px', paddingTop: '15px' }}>{formRender}</div>\r\n      </Modal>\r\n    )\r\n  }\r\n}"]}]}