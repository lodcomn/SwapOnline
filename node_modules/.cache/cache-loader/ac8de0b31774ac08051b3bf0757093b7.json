{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\common\\utils\\namedQuery.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\common\\utils\\namedQuery.ts","mtime":1614842913724},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKdmFyIG5hbWVkUXVlcnkgPSB7fTsKdmFyIG5hbWVkUXVlcnlUaW1lcnMgPSB7fTsKdmFyIG5hbWVkUXVlcnlUaWNrcyA9IDEwOwoKdmFyIG5hbWVkUXVlcnlUaW1lciA9IGZ1bmN0aW9uIG5hbWVkUXVlcnlUaW1lcihxdWVyeU5hbWUpIHsKICBpZiAobmFtZWRRdWVyeVtxdWVyeU5hbWVdLmxlbmd0aCkgewogICAgdmFyIHF1ZXJ5Q2h1bmsgPSBuYW1lZFF1ZXJ5W3F1ZXJ5TmFtZV0uc2hpZnQoKTsKICAgIHZhciBvblJlc29sdmUgPSBxdWVyeUNodW5rLnJlc29sdmUsCiAgICAgICAgb25FcnJvciA9IHF1ZXJ5Q2h1bmsuZXJyb3IsCiAgICAgICAgZGVsYXkgPSBxdWVyeUNodW5rLmRlbGF5LAogICAgICAgIGZ1bmMgPSBxdWVyeUNodW5rLmZ1bmMsCiAgICAgICAgaXNBc3luYyA9IHF1ZXJ5Q2h1bmsuaXNBc3luYzsKICAgIG5ldyBQcm9taXNlKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIHJldDsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDA7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jKCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJldCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uUmVzb2x2ZSA9PT0gImZ1bmN0aW9uIikgb25SZXNvbHZlKHJldCk7CiAgICAgICAgICAgICAgICBuYW1lZFF1ZXJ5VGltZXJzW3F1ZXJ5TmFtZV0gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgbmFtZWRRdWVyeVRpbWVyKHF1ZXJ5TmFtZSk7CiAgICAgICAgICAgICAgICB9LCBkZWxheSk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDg7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbkVycm9yID09PSAiZnVuY3Rpb24iKSBvbkVycm9yKF9jb250ZXh0LnQwKTsKICAgICAgICAgICAgICAgIG5hbWVkUXVlcnlUaW1lcnNbcXVlcnlOYW1lXSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBuYW1lZFF1ZXJ5VGltZXIocXVlcnlOYW1lKTsKICAgICAgICAgICAgICAgIH0sIGRlbGF5KTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMCwgOF1dKTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyKSB7CiAgICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgIH0oKSk7CiAgfSBlbHNlIHsKICAgIG5hbWVkUXVlcnlUaW1lcnNbcXVlcnlOYW1lXSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICBuYW1lZFF1ZXJ5VGltZXIocXVlcnlOYW1lKTsKICAgIH0sIG5hbWVkUXVlcnlUaWNrcyk7CiAgfQp9OwoKdmFyIG5hbWVkUXVlcnlJbml0ID0gZnVuY3Rpb24gbmFtZWRRdWVyeUluaXQocXVlcnlOYW1lKSB7CiAgaWYgKCFuYW1lZFF1ZXJ5W3F1ZXJ5TmFtZV0pIG5hbWVkUXVlcnlbcXVlcnlOYW1lXSA9IFtdOwoKICBpZiAoIW5hbWVkUXVlcnlUaW1lcnNbcXVlcnlOYW1lXSkgewogICAgbmFtZWRRdWVyeVRpbWVyc1txdWVyeU5hbWVdID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIG5hbWVkUXVlcnlUaW1lcihxdWVyeU5hbWUpOwogICAgfSwgbmFtZWRRdWVyeVRpY2tzKTsKICB9Cn07Cgp2YXIgbmFtZWRRdWVyeVJ1biA9IGZ1bmN0aW9uIG5hbWVkUXVlcnlSdW4ob3B0aW9ucykgewogIHZhciBxdWVyeU5hbWUgPSBvcHRpb25zLm5hbWUsCiAgICAgIHJlc29sdmUgPSBvcHRpb25zLnJlc29sdmUsCiAgICAgIGVycm9yID0gb3B0aW9ucy5lcnJvciwKICAgICAgZGVsYXkgPSBvcHRpb25zLmRlbGF5LAogICAgICBmdW5jID0gb3B0aW9ucy5mdW5jLAogICAgICBpc0FzeW5jID0gb3B0aW9ucy5pc0FzeW5jOwogIG5hbWVkUXVlcnlJbml0KHF1ZXJ5TmFtZSk7CiAgbmFtZWRRdWVyeVtxdWVyeU5hbWVdLnB1c2gob3B0aW9ucyk7Cn07CgpleHBvcnQgZGVmYXVsdCBuYW1lZFF1ZXJ5UnVuOw=="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/common/utils/namedQuery.ts"],"names":["namedQuery","namedQueryTimers","namedQueryTicks","namedQueryTimer","queryName","length","queryChunk","shift","onResolve","resolve","onError","error","delay","func","isAsync","Promise","reject","ret","setTimeout","namedQueryInit","namedQueryRun","options","name","push"],"mappings":";;AAAA,IAAMA,UAAU,GAAG,EAAnB;AACA,IAAMC,gBAAgB,GAAG,EAAzB;AACA,IAAMC,eAAe,GAAG,EAAxB;;AAEA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,SAAD,EAAe;AACrC,MAAIJ,UAAU,CAACI,SAAD,CAAV,CAAsBC,MAA1B,EAAkC;AAChC,QAAMC,UAAU,GAAGN,UAAU,CAACI,SAAD,CAAV,CAAsBG,KAAtB,EAAnB;AADgC,QAGrBC,SAHqB,GAQ5BF,UAR4B,CAG9BG,OAH8B;AAAA,QAIvBC,OAJuB,GAQ5BJ,UAR4B,CAI9BK,KAJ8B;AAAA,QAK9BC,KAL8B,GAQ5BN,UAR4B,CAK9BM,KAL8B;AAAA,QAM9BC,IAN8B,GAQ5BP,UAR4B,CAM9BO,IAN8B;AAAA,QAO9BC,OAP8B,GAQ5BR,UAR4B,CAO9BQ,OAP8B;AAUhC,QAAIC,OAAJ;AAAA,0EAAY,iBAAON,OAAP,EAAgBO,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEUH,IAAI,EAFd;;AAAA;AAEFI,gBAAAA,GAFE;AAIR,oBAAI,OAAOT,SAAP,eAAJ,EAAqCA,SAAS,CAACS,GAAD,CAAT;AACrChB,gBAAAA,gBAAgB,CAACG,SAAD,CAAhB,GAA8Bc,UAAU,CAAC,YAAM;AAC7Cf,kBAAAA,eAAe,CAACC,SAAD,CAAf;AACD,iBAFuC,EAErCQ,KAFqC,CAAxC;AALQ;AAAA;;AAAA;AAAA;AAAA;AASR,oBAAI,OAAOF,OAAP,eAAJ,EAAmCA,OAAO,aAAP;AACnCT,gBAAAA,gBAAgB,CAACG,SAAD,CAAhB,GAA8Bc,UAAU,CAAC,YAAM;AAC7Cf,kBAAAA,eAAe,CAACC,SAAD,CAAf;AACD,iBAFuC,EAErCQ,KAFqC,CAAxC;;AAVQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAZ;;AAAA;AAAA;AAAA;AAAA;AAeD,GAzBD,MAyBO;AACLX,IAAAA,gBAAgB,CAACG,SAAD,CAAhB,GAA8Bc,UAAU,CAAC,YAAM;AAC7Cf,MAAAA,eAAe,CAACC,SAAD,CAAf;AACD,KAFuC,EAErCF,eAFqC,CAAxC;AAGD;AACF,CA/BD;;AAiCA,IAAMiB,cAAc,GAAG,SAAjBA,cAAiB,CAACf,SAAD,EAAe;AACpC,MAAI,CAACJ,UAAU,CAACI,SAAD,CAAf,EAA4BJ,UAAU,CAACI,SAAD,CAAV,GAAwB,EAAxB;;AAC5B,MAAI,CAACH,gBAAgB,CAACG,SAAD,CAArB,EAAkC;AAChCH,IAAAA,gBAAgB,CAACG,SAAD,CAAhB,GAA8Bc,UAAU,CAAC,YAAM;AAC7Cf,MAAAA,eAAe,CAACC,SAAD,CAAf;AACD,KAFuC,EAErCF,eAFqC,CAAxC;AAGD;AACF,CAPD;;AASA,IAAMkB,aAAa,GAAG,SAAhBA,aAAgB,CAACC,OAAD,EAAa;AAAA,MAEzBjB,SAFyB,GAQ7BiB,OAR6B,CAE/BC,IAF+B;AAAA,MAG/Bb,OAH+B,GAQ7BY,OAR6B,CAG/BZ,OAH+B;AAAA,MAI/BE,KAJ+B,GAQ7BU,OAR6B,CAI/BV,KAJ+B;AAAA,MAK/BC,KAL+B,GAQ7BS,OAR6B,CAK/BT,KAL+B;AAAA,MAM/BC,IAN+B,GAQ7BQ,OAR6B,CAM/BR,IAN+B;AAAA,MAO/BC,OAP+B,GAQ7BO,OAR6B,CAO/BP,OAP+B;AAWjCK,EAAAA,cAAc,CAACf,SAAD,CAAd;AACAJ,EAAAA,UAAU,CAACI,SAAD,CAAV,CAAsBmB,IAAtB,CAA2BF,OAA3B;AACD,CAbD;;AAeA,eAAeD,aAAf","sourcesContent":["const namedQuery = {}\r\nconst namedQueryTimers = {}\r\nconst namedQueryTicks = 10\r\n\r\nconst namedQueryTimer = (queryName) => {\r\n  if (namedQuery[queryName].length) {\r\n    const queryChunk = namedQuery[queryName].shift()\r\n    const {\r\n      resolve: onResolve,\r\n      error: onError,\r\n      delay,\r\n      func,\r\n      isAsync,\r\n    } = queryChunk\r\n\r\n    new Promise(async (resolve, reject) => {\r\n      try {\r\n        const ret = await func()\r\n\r\n        if (typeof onResolve === `function`) onResolve(ret)\r\n        namedQueryTimers[queryName] = setTimeout(() => {\r\n          namedQueryTimer(queryName)\r\n        }, delay)\r\n      } catch (err) {\r\n        if (typeof onError === `function`) onError(err)\r\n        namedQueryTimers[queryName] = setTimeout(() => {\r\n          namedQueryTimer(queryName)\r\n        }, delay)\r\n      }\r\n    })\r\n  } else {\r\n    namedQueryTimers[queryName] = setTimeout(() => {\r\n      namedQueryTimer(queryName)\r\n    }, namedQueryTicks)\r\n  }\r\n}\r\n\r\nconst namedQueryInit = (queryName) => {\r\n  if (!namedQuery[queryName]) namedQuery[queryName] = []\r\n  if (!namedQueryTimers[queryName]) { \r\n    namedQueryTimers[queryName] = setTimeout(() => {\r\n      namedQueryTimer(queryName)\r\n    }, namedQueryTicks)\r\n  }\r\n}\r\n\r\nconst namedQueryRun = (options) => {\r\n  const {\r\n    name: queryName,\r\n    resolve,\r\n    error,\r\n    delay,\r\n    func,\r\n    isAsync,\r\n  } = options\r\n\r\n\r\n  namedQueryInit(queryName)\r\n  namedQuery[queryName].push(options)\r\n}\r\n\r\nexport default namedQueryRun"]}]}