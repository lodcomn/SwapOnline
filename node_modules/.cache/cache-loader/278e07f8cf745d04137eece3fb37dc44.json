{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\components\\modals\\OfferModal\\AddOffer\\AddOffer.tsx","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\components\\modals\\OfferModal\\AddOffer\\AddOffer.tsx","mtime":1614850799442},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyI7CmltcG9ydCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZiI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy90b0NvbnN1bWFibGVBcnJheSI7Cgp2YXIgX2RlYywgX2RlYzIsIF9jbGFzcywgX3RlbXA7CgppbXBvcnQgX3JlZ2VuZXJhdG9yUnVudGltZSBmcm9tICJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvciI7CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQoKZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KCi8vIEB0cy1ub2NoZWNrCmltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWRhY3Rpb24nOwppbXBvcnQgYWN0aW9ucyBmcm9tICdyZWR1eC9hY3Rpb25zJzsKaW1wb3J0IGhlbHBlcnMsIHsgY29uc3RhbnRzIH0gZnJvbSAnaGVscGVycyc7CmltcG9ydCBMaW5rIGZyb20gJ2xvY2FsX21vZHVsZXMvc3ctdmFsdWVsaW5rJzsKaW1wb3J0IGNvbmZpZyBmcm9tICdhcHAtY29uZmlnJzsKaW1wb3J0IHsgQmlnTnVtYmVyIH0gZnJvbSAnYmlnbnVtYmVyLmpzJzsKaW1wb3J0IHN0eWxlcyBmcm9tICcuL0FkZE9mZmVyLnNjc3MnOwppbXBvcnQgY3NzTW9kdWxlcyBmcm9tICdyZWFjdC1jc3MtbW9kdWxlcyc7CmltcG9ydCBTZWxlY3QgZnJvbSAnLi9TZWxlY3QvU2VsZWN0JzsKaW1wb3J0IEV4Y2hhbmdlUmF0ZUdyb3VwIGZyb20gJy4vRXhjaGFuZ2VSYXRlR3JvdXAvRXhjaGFuZ2VSYXRlR3JvdXAnOwppbXBvcnQgU2VsZWN0R3JvdXAgZnJvbSAnLi9TZWxlY3RHcm91cC9TZWxlY3RHcm91cCc7CmltcG9ydCBCdXR0b24gZnJvbSAnY29tcG9uZW50cy9jb250cm9scy9CdXR0b24vQnV0dG9uJzsKaW1wb3J0IFRvZ2dsZSBmcm9tICdjb21wb25lbnRzL2NvbnRyb2xzL1RvZ2dsZS9Ub2dnbGUnOwppbXBvcnQgVG9vbHRpcCBmcm9tICdjb21wb25lbnRzL3VpL1Rvb2x0aXAvVG9vbHRpcCc7CmltcG9ydCB7IEZvcm1hdHRlZE1lc3NhZ2UgfSBmcm9tICdyZWFjdC1pbnRsJzsKaW1wb3J0IG1pbkFtb3VudE9mZmVyIGZyb20gJ2hlbHBlcnMvY29uc3RhbnRzL21pbkFtb3VudE9mZmVyJzsKaW1wb3J0IGNvaW5zV2l0aER5bmFtaWNGZWUgZnJvbSAnaGVscGVycy9jb25zdGFudHMvY29pbnNXaXRoRHluYW1pY0ZlZSc7CmltcG9ydCBUdXJib0ljb24gZnJvbSAnc2hhcmVkL2NvbXBvbmVudHMvdWkvVHVyYm9JY29uL1R1cmJvSWNvbic7CmltcG9ydCB0dXJib1N3YXAgZnJvbSAnY29tbW9uL2hlbHBlcnMvdHVyYm9Td2FwJzsKdmFyIG1hdGhDb25zdGFudHMgPSB7CiAgaGlnaF9wcmVjaXNpb246IDEwZS04LAogIGxvd19wcmVjaXNpb246IDEwZS01Cn07Cgp2YXIgaXNOdW1iZXJTdHJpbmdGb3JtYXRDb3JyZWN0ID0gZnVuY3Rpb24gaXNOdW1iZXJTdHJpbmdGb3JtYXRDb3JyZWN0KG51bWJlcikgewogIHZhciBzdHJpbmdpZmllZCA9IFN0cmluZyhudW1iZXIpOwogIHZhciBmaXJzdERvdEluZGV4ID0gc3RyaW5naWZpZWQuaW5kZXhPZignLicpOwogIHZhciBsYXN0RG90SW5kZXggPSBzdHJpbmdpZmllZC5sYXN0SW5kZXhPZignLicpOyAvLyBmaXJzdCBhbmQgbGFzdCBkb3QgcG9zaXRpb25zIG1hdGNoLCBzbyBpdCBoYXMgb25seSBvbmUgZG90CgogIHJldHVybiBmaXJzdERvdEluZGV4ID09PSBsYXN0RG90SW5kZXg7Cn07Cgp2YXIgaXNEYXJrID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oY29uc3RhbnRzLmxvY2FsU3RvcmFnZS5pc0RhcmspOwp2YXIgQWRkT2ZmZXIgPSAoX2RlYyA9IGNvbm5lY3QoZnVuY3Rpb24gKF9yZWYpIHsKICB2YXIgY3VycmVuY2llcyA9IF9yZWYuY3VycmVuY2llcywKICAgICAgYWRkU2VsZWN0ZWRJdGVtcyA9IF9yZWYuYWRkU2VsZWN0ZWRJdGVtcywKICAgICAgX3JlZiR1c2VyID0gX3JlZi51c2VyLAogICAgICBldGhEYXRhID0gX3JlZiR1c2VyLmV0aERhdGEsCiAgICAgIGJ0Y0RhdGEgPSBfcmVmJHVzZXIuYnRjRGF0YSwKICAgICAgZ2hvc3REYXRhID0gX3JlZiR1c2VyLmdob3N0RGF0YSwKICAgICAgbmV4dERhdGEgPSBfcmVmJHVzZXIubmV4dERhdGEsCiAgICAgIHRva2Vuc0RhdGEgPSBfcmVmJHVzZXIudG9rZW5zRGF0YTsKICByZXR1cm4gewogICAgY3VycmVuY2llczogY3VycmVuY2llcy5pdGVtcywKICAgIGFkZFNlbGVjdGVkSXRlbXM6IGN1cnJlbmNpZXMuYWRkU2VsZWN0ZWRJdGVtcywKICAgIGl0ZW1zOiBbZXRoRGF0YSwgYnRjRGF0YSwgZ2hvc3REYXRhLCBuZXh0RGF0YV0sCiAgICB0b2tlbkl0ZW1zOiBfdG9Db25zdW1hYmxlQXJyYXkoT2JqZWN0LmtleXModG9rZW5zRGF0YSkubWFwKGZ1bmN0aW9uIChrKSB7CiAgICAgIHJldHVybiB0b2tlbnNEYXRhW2tdOwogICAgfSkpCiAgfTsKfSksIF9kZWMyID0gY3NzTW9kdWxlcyhzdHlsZXMsIHsKICBhbGxvd011bHRpcGxlOiB0cnVlCn0pLCBfZGVjKF9jbGFzcyA9IF9kZWMyKF9jbGFzcyA9IChfdGVtcCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbXBvbmVudCkgewogIF9pbmhlcml0cyhBZGRPZmZlciwgX0NvbXBvbmVudCk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoQWRkT2ZmZXIpOwoKICBmdW5jdGlvbiBBZGRPZmZlcihwcm9wcykgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBZGRPZmZlcik7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcyk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaXNTZW5kaW5nIiwgdm9pZCAwKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJnZXRGZWUiLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0ZSA9IF90aGlzLnN0YXRlLAogICAgICAgICAgc2VsbEN1cnJlbmN5ID0gX3RoaXMkc3RhdGUuc2VsbEN1cnJlbmN5LAogICAgICAgICAgYnV5Q3VycmVuY3kgPSBfdGhpcyRzdGF0ZS5idXlDdXJyZW5jeTsKCiAgICAgIF90aGlzLmNvcnJlY3RNaW5BbW91bnRTZWxsKHNlbGxDdXJyZW5jeSk7CgogICAgICBfdGhpcy5jb3JyZWN0TWluQW1vdW50QnV5KGJ1eUN1cnJlbmN5KTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImNoZWNrRXRoQmFsYW5jZSIsIC8qI19fUFVSRV9fKi9fYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICB2YXIgZXRoQmFsYW5jZTsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gYWN0aW9ucy5ldGguZ2V0QmFsYW5jZSgpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGV0aEJhbGFuY2UgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBldGhCYWxhbmNlOiBldGhCYWxhbmNlCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJjaGVja0JhbGFuY2UiLCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZjMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihzZWxsQ3VycmVuY3kpIHsKICAgICAgICB2YXIgX3RoaXMkcHJvcHMsIGl0ZW1zLCB0b2tlbkl0ZW1zLCBjdXJyZW5jeSwgYmFsYW5jZSwgdW5jb25maXJtZWRCYWxhbmNlLCBjdXJyZW50QmFsYW5jZSwgYmFsYW5jZVdpdGhvdXRGZWUsIGZpbmFsQmFsYW5jZTsKCiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc1tzZWxsQ3VycmVuY3ldLmdldEJhbGFuY2Uoc2VsbEN1cnJlbmN5KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX3RoaXMkcHJvcHMgPSBfdGhpcy5wcm9wcywgaXRlbXMgPSBfdGhpcyRwcm9wcy5pdGVtcywgdG9rZW5JdGVtcyA9IF90aGlzJHByb3BzLnRva2VuSXRlbXM7CiAgICAgICAgICAgICAgICBjdXJyZW5jeSA9IGl0ZW1zLmNvbmNhdCh0b2tlbkl0ZW1zKS5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uY3VycmVuY3kgPT09IHNlbGxDdXJyZW5jeS50b1VwcGVyQ2FzZSgpOwogICAgICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgICAgICBiYWxhbmNlID0gY3VycmVuY3kuYmFsYW5jZSwgdW5jb25maXJtZWRCYWxhbmNlID0gY3VycmVuY3kudW5jb25maXJtZWRCYWxhbmNlOwogICAgICAgICAgICAgICAgYmFsYW5jZSA9IG5ldyBCaWdOdW1iZXIoYmFsYW5jZSk7CiAgICAgICAgICAgICAgICB1bmNvbmZpcm1lZEJhbGFuY2UgPSBuZXcgQmlnTnVtYmVyKHVuY29uZmlybWVkQmFsYW5jZSk7CiAgICAgICAgICAgICAgICBjdXJyZW50QmFsYW5jZSA9IHVuY29uZmlybWVkQmFsYW5jZS5pc05hTigpICYmIHVuY29uZmlybWVkQmFsYW5jZS5pc0xlc3NUaGFuKDApID8gYmFsYW5jZS5wbHVzKHVuY29uZmlybWVkQmFsYW5jZSkgOiBiYWxhbmNlOwogICAgICAgICAgICAgICAgYmFsYW5jZVdpdGhvdXRGZWUgPSBoZWxwZXJzLmV0aFRva2VuLmlzRXRoVG9rZW4oewogICAgICAgICAgICAgICAgICBuYW1lOiBfdGhpcy5zdGF0ZS5zZWxsQ3VycmVuY3kKICAgICAgICAgICAgICAgIH0pID8gY3VycmVudEJhbGFuY2UgOiBjdXJyZW50QmFsYW5jZS5taW51cyhfdGhpcy5zdGF0ZS5taW5pbWFsZXN0QW1vdW50Rm9yU2VsbCk7CiAgICAgICAgICAgICAgICBmaW5hbEJhbGFuY2UgPSBiYWxhbmNlV2l0aG91dEZlZS5pc0dyZWF0ZXJUaGFuKDApID8gYmFsYW5jZVdpdGhvdXRGZWUgOiBuZXcgQmlnTnVtYmVyKDApOwoKICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgYmFsYW5jZTogZmluYWxCYWxhbmNlLnRvU3RyaW5nKCkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgIHJldHVybiBfcmVmMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJpc0V0aFRva2VuIiwgZnVuY3Rpb24gKHNlbGxDdXJyZW5jeSwgYnV5Q3VycmVuY3kpIHsKICAgICAgdmFyIGlzVG9rZW5TZWxsID0gaGVscGVycy5ldGhUb2tlbi5pc0V0aFRva2VuKHsKICAgICAgICBuYW1lOiBzZWxsQ3VycmVuY3kKICAgICAgfSk7CiAgICAgIHZhciBpc1Rva2VuQnV5ID0gaGVscGVycy5ldGhUb2tlbi5pc0V0aFRva2VuKHsKICAgICAgICBuYW1lOiBidXlDdXJyZW5jeQogICAgICB9KTsKCiAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaXNUb2tlbkJ1eTogaXNUb2tlbkJ1eSwKICAgICAgICAgIGlzVG9rZW5TZWxsOiBpc1Rva2VuU2VsbAogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY29ycmVjdE1pbkFtb3VudFNlbGwiLCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZjQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhzZWxsQ3VycmVuY3kpIHsKICAgICAgICB2YXIgbWluaW1hbGVzdEFtb3VudEZvclNlbGw7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoIShjb2luc1dpdGhEeW5hbWljRmVlLmluY2x1ZGVzKHNlbGxDdXJyZW5jeSkgJiYgIWhlbHBlcnMuZXRoVG9rZW4uaXNFdGhUb2tlbih7CiAgICAgICAgICAgICAgICAgIG5hbWU6IHNlbGxDdXJyZW5jeQogICAgICAgICAgICAgICAgfSkpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIGhlbHBlcnNbc2VsbEN1cnJlbmN5XS5lc3RpbWF0ZUZlZVZhbHVlKHsKICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnc3dhcCcsCiAgICAgICAgICAgICAgICAgIHNwZWVkOiAnZmFzdCcKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBtaW5pbWFsZXN0QW1vdW50Rm9yU2VsbCA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgICAgbWluaW1hbGVzdEFtb3VudEZvclNlbGw6IG1pbmltYWxlc3RBbW91bnRGb3JTZWxsCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDIpIHsKICAgICAgICByZXR1cm4gX3JlZjQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgIH0oKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY29ycmVjdE1pbkFtb3VudEJ1eSIsIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVmNSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KGJ1eUN1cnJlbmN5KSB7CiAgICAgICAgdmFyIG1pbmltYWxlc3RBbW91bnRGb3JCdXk7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoIWNvaW5zV2l0aER5bmFtaWNGZWUuaW5jbHVkZXMoYnV5Q3VycmVuY3kpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIGhlbHBlcnNbYnV5Q3VycmVuY3ldLmVzdGltYXRlRmVlVmFsdWUoewogICAgICAgICAgICAgICAgICBtZXRob2Q6ICdzd2FwJywKICAgICAgICAgICAgICAgICAgc3BlZWQ6ICdmYXN0JwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIG1pbmltYWxlc3RBbW91bnRGb3JCdXkgPSBfY29udGV4dDQuc2VudDsKCiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIG1pbmltYWxlc3RBbW91bnRGb3JCdXk6IG1pbmltYWxlc3RBbW91bnRGb3JCdXkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gKF94MykgewogICAgICAgIHJldHVybiBfcmVmNS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJ1cGRhdGVFeGNoYW5nZVJhdGUiLCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZjYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNShzZWxsQ3VycmVuY3ksIGJ1eUN1cnJlbmN5KSB7CiAgICAgICAgdmFyIGV4Y2hhbmdlUmF0ZVNlbGwsIGV4Y2hhbmdlUmF0ZUJ1eSwgZXhjaGFuZ2VSYXRlOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnMudXNlci5nZXRFeGNoYW5nZVJhdGUoc2VsbEN1cnJlbmN5LCAndXNkJyk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGV4Y2hhbmdlUmF0ZVNlbGwgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zLnVzZXIuZ2V0RXhjaGFuZ2VSYXRlKGJ1eUN1cnJlbmN5LCAndXNkJyk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGV4Y2hhbmdlUmF0ZUJ1eSA9IF9jb250ZXh0NS5zZW50OwoKICAgICAgICAgICAgICAgIGlmICghKHNlbGxDdXJyZW5jeSA9PT0gJ3N3YXAnIHx8IGJ1eUN1cnJlbmN5ID09PSAnc3dhcCcpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zLnVzZXIuZ2V0RXhjaGFuZ2VSYXRlKHNlbGxDdXJyZW5jeSwgYnV5Q3VycmVuY3kpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBfY29udGV4dDUudDAgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS50MCA9IG5ldyBCaWdOdW1iZXIoZXhjaGFuZ2VSYXRlU2VsbCkuZGl2KGV4Y2hhbmdlUmF0ZUJ1eSkuZHAoNCwgQmlnTnVtYmVyLlJPVU5EX0NFSUwpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgZXhjaGFuZ2VSYXRlID0gX2NvbnRleHQ1LnQwOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgICAgIGV4Y2hhbmdlUmF0ZTogZXhjaGFuZ2VSYXRlCiAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSh0cnVlKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gKF94NCwgX3g1KSB7CiAgICAgICAgcmV0dXJuIF9yZWY2LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9KCkpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImhhbmRsZUJ1eUN1cnJlbmN5U2VsZWN0IiwgLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZWY4ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoX3JlZjcpIHsKICAgICAgICB2YXIgdmFsdWUsIF90aGlzJHN0YXRlMiwgYnV5Q3VycmVuY3ksIHNlbGxDdXJyZW5jeSwgYnV5QW1vdW50LCBzZWxsQW1vdW50OwoKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHZhbHVlID0gX3JlZjcudmFsdWU7CiAgICAgICAgICAgICAgICBfdGhpcyRzdGF0ZTIgPSBfdGhpcy5zdGF0ZSwgYnV5Q3VycmVuY3kgPSBfdGhpcyRzdGF0ZTIuYnV5Q3VycmVuY3ksIHNlbGxDdXJyZW5jeSA9IF90aGlzJHN0YXRlMi5zZWxsQ3VycmVuY3ksIGJ1eUFtb3VudCA9IF90aGlzJHN0YXRlMi5idXlBbW91bnQsIHNlbGxBbW91bnQgPSBfdGhpcyRzdGF0ZTIuc2VsbEFtb3VudDsKCiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIGlzVHVyYm86IGZhbHNlCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoIShzZWxsQ3VycmVuY3kgPT09IHZhbHVlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzLnN3aXRjaGluZygpOwoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgX3RoaXMuY2hlY2tQYWlyKHNlbGxDdXJyZW5jeSk7CgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5jaGVja0JhbGFuY2Uoc2VsbEN1cnJlbmN5KTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMudXBkYXRlRXhjaGFuZ2VSYXRlKHNlbGxDdXJyZW5jeSwgdmFsdWUpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIGJ1eUN1cnJlbmN5OiB2YWx1ZQogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKHNlbGxBbW91bnQgPiAwIHx8IGJ1eUFtb3VudCA+IDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXMuaGFuZGxlQnV5QW1vdW50Q2hhbmdlKGJ1eUFtb3VudCk7CgogICAgICAgICAgICAgICAgICBfdGhpcy5oYW5kbGVTZWxsQW1vdW50Q2hhbmdlKHNlbGxBbW91bnQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzLmlzRXRoVG9rZW4oc2VsbEN1cnJlbmN5LCB2YWx1ZSk7CgogICAgICAgICAgICAgICAgX3RoaXMuZ2V0RmVlKCk7CgogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICB9KSk7CgogICAgICByZXR1cm4gZnVuY3Rpb24gKF94NikgewogICAgICAgIHJldHVybiBfcmVmOC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJoYW5kbGVTZWxsQ3VycmVuY3lTZWxlY3QiLCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlZjEwID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoX3JlZjkpIHsKICAgICAgICB2YXIgdmFsdWUsIF90aGlzJHN0YXRlMywgYnV5Q3VycmVuY3ksIHNlbGxDdXJyZW5jeSwgc2VsbEFtb3VudCwgYnV5QW1vdW50OwoKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHZhbHVlID0gX3JlZjkudmFsdWU7CiAgICAgICAgICAgICAgICBfdGhpcyRzdGF0ZTMgPSBfdGhpcy5zdGF0ZSwgYnV5Q3VycmVuY3kgPSBfdGhpcyRzdGF0ZTMuYnV5Q3VycmVuY3ksIHNlbGxDdXJyZW5jeSA9IF90aGlzJHN0YXRlMy5zZWxsQ3VycmVuY3ksIHNlbGxBbW91bnQgPSBfdGhpcyRzdGF0ZTMuc2VsbEFtb3VudCwgYnV5QW1vdW50ID0gX3RoaXMkc3RhdGUzLmJ1eUFtb3VudDsKCiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICAgIGlzVHVyYm86IGZhbHNlCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoIShidXlDdXJyZW5jeSA9PT0gdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMuc3dpdGNoaW5nKCk7CgogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxNjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBfdGhpcy5jaGVja1BhaXIodmFsdWUpOwoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuY2hlY2tCYWxhbmNlKHZhbHVlKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMudXBkYXRlRXhjaGFuZ2VSYXRlKHZhbHVlLCBidXlDdXJyZW5jeSk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgc2VsbEN1cnJlbmN5OiB2YWx1ZQogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKHNlbGxBbW91bnQgPiAwIHx8IGJ1eUFtb3VudCA+IDApIHsKICAgICAgICAgICAgICAgICAgX3RoaXMuaGFuZGxlQnV5QW1vdW50Q2hhbmdlKGJ1eUFtb3VudCk7CgogICAgICAgICAgICAgICAgICBfdGhpcy5oYW5kbGVTZWxsQW1vdW50Q2hhbmdlKHNlbGxBbW91bnQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzLmlzRXRoVG9rZW4odmFsdWUsIGJ1eUN1cnJlbmN5KTsKCiAgICAgICAgICAgICAgICBfdGhpcy5nZXRGZWUoKTsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgIH0pKTsKCiAgICAgIHJldHVybiBmdW5jdGlvbiAoX3g3KSB7CiAgICAgICAgcmV0dXJuIF9yZWYxMC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfSgpKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJoYW5kbGVFeGNoYW5nZVJhdGVDaGFuZ2UiLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgdmFyIF90aGlzJHN0YXRlNCA9IF90aGlzLnN0YXRlLAogICAgICAgICAgYnV5QW1vdW50ID0gX3RoaXMkc3RhdGU0LmJ1eUFtb3VudCwKICAgICAgICAgIHNlbGxBbW91bnQgPSBfdGhpcyRzdGF0ZTQuc2VsbEFtb3VudDsKCiAgICAgIGlmICghaXNOdW1iZXJTdHJpbmdGb3JtYXRDb3JyZWN0KHZhbHVlKSkgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIF90aGlzLmhhbmRsZUFueUNoYW5nZSh7CiAgICAgICAgdHlwZTogJ3JhdGUnLAogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9KTsKCiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImhhbmRsZUJ1eUFtb3VudENoYW5nZSIsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICBpZiAoIWlzTnVtYmVyU3RyaW5nRm9ybWF0Q29ycmVjdCh2YWx1ZSkpIHsKICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CgogICAgICBfdGhpcy5oYW5kbGVBbnlDaGFuZ2UoewogICAgICAgIHR5cGU6ICdidXknLAogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9KTsKCiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0pOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImhhbmRsZVNlbGxBbW91bnRDaGFuZ2UiLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgaWYgKCFpc051bWJlclN0cmluZ0Zvcm1hdENvcnJlY3QodmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgX3RoaXMuaGFuZGxlQW55Q2hhbmdlKHsKICAgICAgICB0eXBlOiAnc2VsbCcsCiAgICAgICAgdmFsdWU6IHZhbHVlCiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlQW55Q2hhbmdlIiwgZnVuY3Rpb24gKF9yZWYxMSkgewogICAgICB2YXIgdHlwZSA9IF9yZWYxMS50eXBlLAogICAgICAgICAgdmFsdWUgPSBfcmVmMTEudmFsdWU7CiAgICAgIHZhciBfdGhpcyRzdGF0ZTUgPSBfdGhpcy5zdGF0ZSwKICAgICAgICAgIG1hbnVhbFJhdGUgPSBfdGhpcyRzdGF0ZTUubWFudWFsUmF0ZSwKICAgICAgICAgIGV4Y2hhbmdlUmF0ZSA9IF90aGlzJHN0YXRlNS5leGNoYW5nZVJhdGUsCiAgICAgICAgICBidXlBbW91bnQgPSBfdGhpcyRzdGF0ZTUuYnV5QW1vdW50LAogICAgICAgICAgc2VsbEFtb3VudCA9IF90aGlzJHN0YXRlNS5zZWxsQW1vdW50LAogICAgICAgICAgYnV5Q3VycmVuY3kgPSBfdGhpcyRzdGF0ZTUuYnV5Q3VycmVuY3ksCiAgICAgICAgICBzZWxsQ3VycmVuY3kgPSBfdGhpcyRzdGF0ZTUuc2VsbEN1cnJlbmN5OwoKICAgICAgaWYgKHR5cGUgPT09ICdzZWxsJyB8fCB0eXBlID09PSAnYnV5JykgewogICAgICAgIGlmICghX3RoaXMuaXNTZW5kaW5nKSB7CiAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgIGlzU2VuZGluZzogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIC8qDQogICAgICAgICAgWFIgPSBTIC8gQg0KICAgICAgICAgIEIgPSBTIC8gWFINCiAgICAgICAgICBTID0gWFIgKiBCDQogICAgICAqLwoKCiAgICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgIGNhc2UgJ3NlbGwnOgogICAgICAgICAgewogICAgICAgICAgICAvKg0KICAgICAgICAgICAgICBTKysgLT4gWFIrKyAtPiBCIChNYW51YWwgUmF0ZSkNCiAgICAgICAgICAgICAgUysrIC0+IFhSIC0+IEIrKyAoQXV0byBSYXRlKQ0KICAgICAgICAgICAgKi8KICAgICAgICAgICAgdmFyIG5ld1NlbGxBbW91bnQgPSBuZXcgQmlnTnVtYmVyKHZhbHVlIHx8IDApOwoKICAgICAgICAgICAgaWYgKG1hbnVhbFJhdGUpIHsKICAgICAgICAgICAgICB2YXIgbmV3RXhjaGFuZ2VSYXRlID0gbmV3IEJpZ051bWJlcih2YWx1ZSkuZGl2aWRlZEJ5KGJ1eUFtb3VudCk7CgogICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsKICAgICAgICAgICAgICAgIGV4Y2hhbmdlUmF0ZTogbmV3RXhjaGFuZ2VSYXRlLmlzR3JlYXRlclRoYW4oMCkgPyBuZXdFeGNoYW5nZVJhdGUudG9TdHJpbmcoKSA6ICcnLAogICAgICAgICAgICAgICAgc2VsbEFtb3VudDogbmV3U2VsbEFtb3VudC50b1N0cmluZygpCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdmFyIG5ld0J1eUFtb3VudCA9IG5ld1NlbGxBbW91bnQubXVsdGlwbGllZEJ5KGV4Y2hhbmdlUmF0ZSB8fCAwKS5kcChjb25zdGFudHMudG9rZW5EZWNpbWFsc1tidXlDdXJyZW5jeS50b0xvd2VyQ2FzZSgpXSwgQmlnTnVtYmVyLlJPVU5EX0RPV04pOwoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzZWxsQW1vdW50OiBuZXdTZWxsQW1vdW50LnRvU3RyaW5nKCksCiAgICAgICAgICAgICAgICBidXlBbW91bnQ6IG5ld0J1eUFtb3VudC50b1N0cmluZygpCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICBjYXNlICdidXknOgogICAgICAgICAgewogICAgICAgICAgICAvKg0KICAgICAgICAgICAgICBCKysgLT4gWFItLSAtPiBTIChNYW51YWwgUmF0ZSkNCiAgICAgICAgICAgICAgQisrIC0+IFhSIC0+IFMrKyAoQXV0byBSYXRlKQ0KICAgICAgICAgICAgKi8KICAgICAgICAgICAgdmFyIF9uZXdCdXlBbW91bnQgPSBuZXcgQmlnTnVtYmVyKHZhbHVlIHx8IDApOwoKICAgICAgICAgICAgaWYgKG1hbnVhbFJhdGUpIHsKICAgICAgICAgICAgICB2YXIgX25ld0V4Y2hhbmdlUmF0ZSA9IG5ldyBCaWdOdW1iZXIoc2VsbEFtb3VudCkuZGl2aWRlZEJ5KHZhbHVlKTsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgZXhjaGFuZ2VSYXRlOiBfbmV3RXhjaGFuZ2VSYXRlLmlzR3JlYXRlclRoYW4oMCkgPyBfbmV3RXhjaGFuZ2VSYXRlLnRvU3RyaW5nKCkgOiAnJywKICAgICAgICAgICAgICAgIGJ1eUFtb3VudDogX25ld0J1eUFtb3VudC50b1N0cmluZygpCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdmFyIF9uZXdTZWxsQW1vdW50ID0gX25ld0J1eUFtb3VudC5kaXZpZGVkQnkoZXhjaGFuZ2VSYXRlIHx8IDApLmRwKGNvbnN0YW50cy50b2tlbkRlY2ltYWxzW3NlbGxDdXJyZW5jeS50b0xvd2VyQ2FzZSgpXSwgQmlnTnVtYmVyLlJPVU5EX0RPV04pOwoKICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgICAgICAgICBzZWxsQW1vdW50OiBfbmV3U2VsbEFtb3VudC50b1N0cmluZygpLAogICAgICAgICAgICAgICAgYnV5QW1vdW50OiBfbmV3QnV5QW1vdW50LnRvU3RyaW5nKCkKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGNhc2UgJ3JhdGUnOgogICAgICAgICAgewogICAgICAgICAgICBpZiAobmV3IEJpZ051bWJlcihzZWxsQW1vdW50KS5pc0dyZWF0ZXJUaGFuKG1hdGhDb25zdGFudHMuaGlnaF9wcmVjaXNpb24pKSB7CiAgICAgICAgICAgICAgLy8gSWYgdXNlciBoYXMgc2V0IHNlbGwgdmFsdWUgY2hhbmdlIGJ1eSB2YWx1ZQoKICAgICAgICAgICAgICAvKg0KICAgICAgICAgICAgICAgIFhSKysgLT4gUyAtPiBCLS0NCiAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICB2YXIgX25ld0J1eUFtb3VudDIgPSBuZXcgQmlnTnVtYmVyKHNlbGxBbW91bnQpLmRpdmlkZWRCeSh2YWx1ZSB8fCAwKTsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgYnV5QW1vdW50OiBfbmV3QnV5QW1vdW50Mi50b1N0cmluZygpCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIGNoYW5nZSBzZWxsIHZhbHVlIGlmIGJ1eSB2YWx1ZSBpcyBub3QgbnVsbAoKICAgICAgICAgICAgICAvKg0KICAgICAgICAgICAgICAgIFhSKysgLT4gUysrIC0+IEINCiAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICB2YXIgX25ld1NlbGxBbW91bnQyID0gbmV3IEJpZ051bWJlcih2YWx1ZSB8fCAwKS5tdWx0aXBsaWVkQnkoYnV5QW1vdW50KTsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgc2VsbEFtb3VudDogX25ld1NlbGxBbW91bnQyLnRvU3RyaW5nKCkKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmtub3duIHR5cGUnKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9KTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJoYW5kbGVOZXh0IiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgb25OZXh0ID0gX3RoaXMucHJvcHMub25OZXh0OyAvLyBhY3Rpb25zLmFuYWx5dGljcy5kYXRhRXZlbnQoJ29yZGVyYm9vay1hZGRvZmZlci1jbGljay1uZXh0LWJ1dHRvbicpCgogICAgICBvbk5leHQoX3RoaXMuc3RhdGUpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2hhbmdlQmFsYW5jZSIsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHNlbGxBbW91bnQ6IG5ldyBCaWdOdW1iZXIodmFsdWUpLnRvU3RyaW5nKCkKICAgICAgICB9OwogICAgICB9KTsKCiAgICAgIF90aGlzLmhhbmRsZVNlbGxBbW91bnRDaGFuZ2UodmFsdWUpOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiaGFuZGxlTWFudWFsUmF0ZSIsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgdmFyIHNlbGxDdXJyZW5jeSA9IF90aGlzLnN0YXRlLnNlbGxDdXJyZW5jeTsKCiAgICAgICAgX3RoaXMuaGFuZGxlU2VsbEN1cnJlbmN5U2VsZWN0KHsKICAgICAgICAgIHZhbHVlOiBzZWxsQ3VycmVuY3kKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBtYW51YWxSYXRlOiB2YWx1ZQogICAgICAgIH07CiAgICAgIH0pOwogICAgfSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAic3dpdGNoaW5nIiwgLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KCkgewogICAgICB2YXIgX3RoaXMkc3RhdGU2LCBzZWxsQ3VycmVuY3ksIGJ1eUN1cnJlbmN5LCBzZWxsQW1vdW50LCBidXlBbW91bnQ7CgogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfdGhpcyRzdGF0ZTYgPSBfdGhpcy5zdGF0ZSwgc2VsbEN1cnJlbmN5ID0gX3RoaXMkc3RhdGU2LnNlbGxDdXJyZW5jeSwgYnV5Q3VycmVuY3kgPSBfdGhpcyRzdGF0ZTYuYnV5Q3VycmVuY3ksIHNlbGxBbW91bnQgPSBfdGhpcyRzdGF0ZTYuc2VsbEFtb3VudCwgYnV5QW1vdW50ID0gX3RoaXMkc3RhdGU2LmJ1eUFtb3VudDsKCiAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoewogICAgICAgICAgICAgICAgc2VsbEFtb3VudDogJycsCiAgICAgICAgICAgICAgICBidXlBbW91bnQ6ICcnLAogICAgICAgICAgICAgICAgc2VsbEN1cnJlbmN5OiBidXlDdXJyZW5jeSwKICAgICAgICAgICAgICAgIGJ1eUN1cnJlbmN5OiBzZWxsQ3VycmVuY3kKICAgICAgICAgICAgICB9LCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuY2hlY2tCYWxhbmNlKGJ1eUN1cnJlbmN5KTsKCiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZUV4Y2hhbmdlUmF0ZShidXlDdXJyZW5jeSwgc2VsbEN1cnJlbmN5KTsKCiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnMucGFpcnMuc2VsZWN0UGFpcihidXlDdXJyZW5jeSk7CgogICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc0V0aFRva2VuKF90aGlzLnN0YXRlLnNlbGxDdXJyZW5jeSwgX3RoaXMuc3RhdGUuYnV5Q3VycmVuY3kpOwoKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZ2V0RmVlKCk7CgogICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBfY2FsbGVlOCk7CiAgICAgICAgICAgICAgfSkpKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWU5KTsKICAgIH0pKSk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAiY2hlY2tQYWlyIiwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgIHZhciBzZWxlY3RlZCA9IGFjdGlvbnMucGFpcnMuc2VsZWN0UGFpcih2YWx1ZSk7CiAgICAgIHZhciBjaGVjayA9IHNlbGVjdGVkLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLnZhbHVlOwogICAgICB9KS5pbmNsdWRlcyhfdGhpcy5zdGF0ZS5idXlDdXJyZW5jeSk7CgogICAgICBpZiAoIWNoZWNrKSB7CiAgICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgYnV5Q3VycmVuY3k6IHNlbGVjdGVkWzBdLnZhbHVlCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKCiAgICB2YXIgX2l0ZW1zID0gcHJvcHMuaXRlbXMsCiAgICAgICAgX3Rva2VuSXRlbXMgPSBwcm9wcy50b2tlbkl0ZW1zLAogICAgICAgIGluaXRpYWxEYXRhID0gcHJvcHMuaW5pdGlhbERhdGE7CgogICAgaWYgKGNvbmZpZyAmJiBjb25maWcuaXNXaWRnZXQpIHsKICAgICAgaWYgKHdpbmRvdy53aWRnZXRFUkMyMFRva2VucyAmJiBPYmplY3Qua2V5cyh3aW5kb3cud2lkZ2V0RVJDMjBUb2tlbnMpLmxlbmd0aCkgewogICAgICAgIE9iamVjdC5rZXlzKHdpbmRvdy53aWRnZXRFUkMyMFRva2VucykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICBtaW5BbW91bnRPZmZlcltrZXldID0gMTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtaW5BbW91bnRPZmZlcltjb25maWcuZXJjMjB0b2tlbl0gPSAxOwogICAgICB9CiAgICB9CgogICAgdmFyIF9yZWYxNCA9IGluaXRpYWxEYXRhIHx8IHt9LAogICAgICAgIF9leGNoYW5nZVJhdGUgPSBfcmVmMTQuZXhjaGFuZ2VSYXRlLAogICAgICAgIF9idXlBbW91bnQgPSBfcmVmMTQuYnV5QW1vdW50LAogICAgICAgIF9zZWxsQW1vdW50ID0gX3JlZjE0LnNlbGxBbW91bnQsCiAgICAgICAgX2J1eUN1cnJlbmN5ID0gX3JlZjE0LmJ1eUN1cnJlbmN5LAogICAgICAgIF9zZWxsQ3VycmVuY3kgPSBfcmVmMTQuc2VsbEN1cnJlbmN5OwoKICAgIF90aGlzLnN0YXRlID0gewogICAgICBiYWxhbmNlOiBudWxsLAogICAgICBpc1Rva2VuU2VsbDogZmFsc2UsCiAgICAgIGlzVG9rZW5CdXk6IGZhbHNlLAogICAgICBpc1BhcnRpYWw6IHRydWUsCiAgICAgIGlzVHVyYm86IGZhbHNlLAogICAgICBpc1NlbmRpbmc6IGZhbHNlLAogICAgICBtYW51YWxSYXRlOiB0cnVlLAogICAgICBidXlBbW91bnQ6IF9idXlBbW91bnQgfHwgJycsCiAgICAgIHNlbGxBbW91bnQ6IF9zZWxsQW1vdW50IHx8ICcnLAogICAgICBleGNoYW5nZVJhdGU6IF9leGNoYW5nZVJhdGUgfHwgMSwKICAgICAgYnV5Q3VycmVuY3k6IF9idXlDdXJyZW5jeSB8fCAnYnRjJywKICAgICAgc2VsbEN1cnJlbmN5OiBfc2VsbEN1cnJlbmN5IHx8ICdldGgnLAogICAgICBtaW5pbWFsZXN0QW1vdW50Rm9yQnV5OiBtaW5BbW91bnRPZmZlcltfYnV5Q3VycmVuY3ldIHx8IG1pbkFtb3VudE9mZmVyLmJ0YywKICAgICAgbWluaW1hbGVzdEFtb3VudEZvclNlbGw6IG1pbkFtb3VudE9mZmVyW19zZWxsQ3VycmVuY3ldIHx8IG1pbkFtb3VudE9mZmVyLmV0aCwKICAgICAgZXRoQmFsYW5jZTogMAogICAgfTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhBZGRPZmZlciwgW3sKICAgIGtleTogImNvbXBvbmVudERpZE1vdW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHsKICAgICAgdmFyIF90aGlzJHN0YXRlNyA9IHRoaXMuc3RhdGUsCiAgICAgICAgICBzZWxsQ3VycmVuY3kgPSBfdGhpcyRzdGF0ZTcuc2VsbEN1cnJlbmN5LAogICAgICAgICAgYnV5Q3VycmVuY3kgPSBfdGhpcyRzdGF0ZTcuYnV5Q3VycmVuY3ksCiAgICAgICAgICB2YWx1ZSA9IF90aGlzJHN0YXRlNy52YWx1ZTsKICAgICAgYWN0aW9ucy5wYWlycy5zZWxlY3RQYWlyKHNlbGxDdXJyZW5jeSk7CiAgICAgIHRoaXMuY2hlY2tCYWxhbmNlKHNlbGxDdXJyZW5jeSk7CiAgICAgIHRoaXMudXBkYXRlRXhjaGFuZ2VSYXRlKHNlbGxDdXJyZW5jeSwgYnV5Q3VycmVuY3kpOwogICAgICB0aGlzLmlzRXRoVG9rZW4oc2VsbEN1cnJlbmN5LCBidXlDdXJyZW5jeSk7CiAgICAgIHRoaXMuZ2V0RmVlKCk7CiAgICAgIHRoaXMuY2hlY2tFdGhCYWxhbmNlKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIF90aGlzJHByb3BzMiA9IHRoaXMucHJvcHMsCiAgICAgICAgICBjdXJyZW5jaWVzID0gX3RoaXMkcHJvcHMyLmN1cnJlbmNpZXMsCiAgICAgICAgICB0b2tlbkl0ZW1zID0gX3RoaXMkcHJvcHMyLnRva2VuSXRlbXMsCiAgICAgICAgICBhZGRTZWxlY3RlZEl0ZW1zID0gX3RoaXMkcHJvcHMyLmFkZFNlbGVjdGVkSXRlbXM7CiAgICAgIHZhciBfdGhpcyRzdGF0ZTggPSB0aGlzLnN0YXRlLAogICAgICAgICAgZXhjaGFuZ2VSYXRlID0gX3RoaXMkc3RhdGU4LmV4Y2hhbmdlUmF0ZSwKICAgICAgICAgIGJ1eUFtb3VudCA9IF90aGlzJHN0YXRlOC5idXlBbW91bnQsCiAgICAgICAgICBzZWxsQW1vdW50ID0gX3RoaXMkc3RhdGU4LnNlbGxBbW91bnQsCiAgICAgICAgICBidXlDdXJyZW5jeSA9IF90aGlzJHN0YXRlOC5idXlDdXJyZW5jeSwKICAgICAgICAgIHNlbGxDdXJyZW5jeSA9IF90aGlzJHN0YXRlOC5zZWxsQ3VycmVuY3ksCiAgICAgICAgICBtaW5pbWFsZXN0QW1vdW50Rm9yU2VsbCA9IF90aGlzJHN0YXRlOC5taW5pbWFsZXN0QW1vdW50Rm9yU2VsbCwKICAgICAgICAgIG1pbmltYWxlc3RBbW91bnRGb3JCdXkgPSBfdGhpcyRzdGF0ZTgubWluaW1hbGVzdEFtb3VudEZvckJ1eSwKICAgICAgICAgIGJhbGFuY2UgPSBfdGhpcyRzdGF0ZTguYmFsYW5jZSwKICAgICAgICAgIGV0aEJhbGFuY2UgPSBfdGhpcyRzdGF0ZTguZXRoQmFsYW5jZSwKICAgICAgICAgIG1hbnVhbFJhdGUgPSBfdGhpcyRzdGF0ZTgubWFudWFsUmF0ZSwKICAgICAgICAgIGlzUGFydGlhbCA9IF90aGlzJHN0YXRlOC5pc1BhcnRpYWwsCiAgICAgICAgICBpc1R1cmJvID0gX3RoaXMkc3RhdGU4LmlzVHVyYm8sCiAgICAgICAgICBpc1Rva2VuU2VsbCA9IF90aGlzJHN0YXRlOC5pc1Rva2VuU2VsbCwKICAgICAgICAgIGlzVG9rZW5CdXkgPSBfdGhpcyRzdGF0ZTguaXNUb2tlbkJ1eSwKICAgICAgICAgIHNlbGxJbnB1dFZhbHVlSXNPayA9IF90aGlzJHN0YXRlOC5zZWxsSW5wdXRWYWx1ZUlzT2s7IC8vIEB0by1kbyAtIGZldGNoIGV0aCBtaW5lciBmZWUgZm9yIHN3YXAKCiAgICAgIHZhciBtaW5OZWVkRXRoQmFsYW5jZSA9IDAuMDA0OwogICAgICB2YXIgbmVlZEV0aEJhbGFuY2UgPSBuZXcgQmlnTnVtYmVyKGV0aEJhbGFuY2UpLmlzTGVzc1RoYW4obWluTmVlZEV0aEJhbGFuY2UpICYmIChpc1Rva2VuQnV5IHx8IGlzVG9rZW5TZWxsKTsKICAgICAgdmFyIGxpbmtlZCA9IExpbmsuYWxsKHRoaXMsICdleGNoYW5nZVJhdGUnLCAnYnV5QW1vdW50JywgJ3NlbGxBbW91bnQnKTsKICAgICAgdmFyIG1pbmltYWxBbW91bnRTZWxsID0gIWlzVG9rZW5TZWxsID8gY29pbnNXaXRoRHluYW1pY0ZlZS5pbmNsdWRlcyhzZWxsQ3VycmVuY3kpID8gbWluaW1hbGVzdEFtb3VudEZvclNlbGwgOiBtaW5BbW91bnRPZmZlcltidXlDdXJyZW5jeV0gOiAwLjAwMTsKICAgICAgdmFyIG1pbmltYWxBbW91bnRCdXkgPSAhaXNUb2tlbkJ1eSA/IGNvaW5zV2l0aER5bmFtaWNGZWUuaW5jbHVkZXMoYnV5Q3VycmVuY3kpID8gbWluaW1hbGVzdEFtb3VudEZvckJ1eSA6IG1pbkFtb3VudE9mZmVyW2J1eUN1cnJlbmN5XSA6IDAuMDAxOyAvLyB0ZW1wb3Jhcnk6IGhpZGUgdHVyYm9zd2FwcyBvbiBtYWlubmV0CgogICAgICB2YXIgaXNTaG93U3dhcE1vZGVTd2l0Y2ggPSAhcHJvY2Vzcy5lbnYuTUFJTk5FVDsKICAgICAgdmFyIGlzVHVyYm9BbGxvd2VkID0gdHVyYm9Td2FwLmlzQXNzZXRTdXBwb3J0ZWQoYnV5Q3VycmVuY3kpICYmIHR1cmJvU3dhcC5pc0Fzc2V0U3VwcG9ydGVkKHNlbGxDdXJyZW5jeSk7CiAgICAgIHZhciBpc0Rpc2FibGVkID0gIWV4Y2hhbmdlUmF0ZSB8fCAhYnV5QW1vdW50ICYmICFzZWxsQW1vdW50IHx8IG5ldyBCaWdOdW1iZXIoc2VsbEFtb3VudCkuaXNHcmVhdGVyVGhhbihiYWxhbmNlKSB8fCBuZXcgQmlnTnVtYmVyKHNlbGxBbW91bnQpLmlzTGVzc1RoYW4obWluaW1hbEFtb3VudFNlbGwpIHx8IG5ldyBCaWdOdW1iZXIoYnV5QW1vdW50KS5pc0xlc3NUaGFuKG1pbmltYWxBbW91bnRCdXkpIHx8IG5lZWRFdGhCYWxhbmNlOwoKICAgICAgaWYgKGxpbmtlZC5zZWxsQW1vdW50LnZhbHVlICE9PSAnJyAmJiBsaW5rZWQuc2VsbEFtb3VudC52YWx1ZSA+IDApIHsKICAgICAgICBsaW5rZWQuc2VsbEFtb3VudC5jaGVjayhmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgIHJldHVybiBuZXcgQmlnTnVtYmVyKHZhbHVlKS5pc0dyZWF0ZXJUaGFuKG1pbmltYWxBbW91bnRTZWxsKTsKICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAidHJhbnNhY3Rpb240NDQiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTZWxsIGFtb3VudCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAiCiAgICAgICAgfSksICcgJywgbWluaW1hbEFtb3VudFNlbGwpKTsKICAgICAgfQoKICAgICAgaWYgKGxpbmtlZC5idXlBbW91bnQudmFsdWUgIT09ICcnICYmIGxpbmtlZC5zZWxsQW1vdW50LnZhbHVlID4gMCkgewogICAgICAgIGxpbmtlZC5idXlBbW91bnQuY2hlY2soZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gbmV3IEJpZ051bWJlcih2YWx1ZSkuaXNHcmVhdGVyVGhhbihtaW5pbWFsQW1vdW50QnV5KTsKICAgICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgic3BhbiIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAidHJhbnNhY3Rpb240NTAiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJCdXkgYW1vdW50IG11c3QgYmUgZ3JlYXRlciB0aGFuICIKICAgICAgICB9KSwgJyAnLCBtaW5pbWFsQW1vdW50QnV5KSk7CiAgICAgIH0KCiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlTmFtZTogIndyYXBwZXIgYWRkT2ZmZXIgIi5jb25jYXQoaXNEYXJrID8gJy0tZGFyaycgOiAnJywgIiAiKQogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlTmFtZTogIm9mZmVyVGl0bGUiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogIm9mZmVyTWVzc2FnZVRvVXNlciIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJZb3UgbXVzdCBiZSBvbmxpbmUgYWxsIHRoZSB0aW1lLCBvdGhlcndpc2UgeW91ciBvcmRlciB3aWxsIG5vdCBiZSB2aXNpYmxlIHRvIG90aGVyIHVzZXJzIgogICAgICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFNlbGVjdEdyb3VwLCB7CiAgICAgICAgaXNEYXJrOiBpc0RhcmssCiAgICAgICAgbGFiZWw6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAiYWRkb2ZmZXIzODEiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJTZWxsIgogICAgICAgIH0pLAogICAgICAgIHRvb2x0aXA6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAicGFydGlhbDQ2MiIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlRoZSBhbW91bnQgeW91IGhhdmUgb24gc3dhcC5vbmxpbmUgb3IgYW4gZXh0ZXJuYWwgd2FsbGV0IHRoYXQgeW91IHdhbnQgdG8gZXhjaGFuZ2UiCiAgICAgICAgfSksCiAgICAgICAgaW5wdXRWYWx1ZUxpbms6IGxpbmtlZC5zZWxsQW1vdW50LnBpcGUodGhpcy5oYW5kbGVTZWxsQW1vdW50Q2hhbmdlKSwKICAgICAgICBkb250RGlzcGxheUVycm9yOiB0cnVlLAogICAgICAgIHNlbGVjdGVkVmFsdWU6IHNlbGxDdXJyZW5jeSwKICAgICAgICBvblNlbGVjdDogdGhpcy5oYW5kbGVTZWxsQ3VycmVuY3lTZWxlY3QsCiAgICAgICAgaWQ6ICJzZWxsQW1vdW50IiwKICAgICAgICBiYWxhbmNlOiBiYWxhbmNlLAogICAgICAgIGN1cnJlbmNpZXM6IGN1cnJlbmNpZXMsCiAgICAgICAgcGxhY2Vob2xkZXI6ICIwLjAwMDAwMDAwIgogICAgICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoU2VsZWN0LCB7CiAgICAgICAgaXNEYXJrOiBpc0RhcmssCiAgICAgICAgY2hhbmdlQmFsYW5jZTogdGhpcy5jaGFuZ2VCYWxhbmNlLAogICAgICAgIGJhbGFuY2U6IGJhbGFuY2UsCiAgICAgICAgc3dpdGNoaW5nOiB0aGlzLnN3aXRjaGluZwogICAgICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoU2VsZWN0R3JvdXAsIHsKICAgICAgICBpc0Rhcms6IGlzRGFyaywKICAgICAgICBsYWJlbDogLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgICAgaWQ6ICJhZGRvZmZlcjM5NiIsCiAgICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkJ1eSIKICAgICAgICB9KSwKICAgICAgICB0b29sdGlwOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgICBpZDogInBhcnRpYWw0NzgiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJUaGUgYW1vdW50IHlvdSB3aWxsIHJlY2VpdmUgYWZ0ZXIgdGhlIGV4Y2hhbmdlIgogICAgICAgIH0pLAogICAgICAgIGlucHV0VmFsdWVMaW5rOiBsaW5rZWQuYnV5QW1vdW50LnBpcGUodGhpcy5oYW5kbGVCdXlBbW91bnRDaGFuZ2UpLAogICAgICAgIGRvbnREaXNwbGF5RXJyb3I6IHRydWUsCiAgICAgICAgc2VsZWN0ZWRWYWx1ZTogYnV5Q3VycmVuY3ksCiAgICAgICAgb25TZWxlY3Q6IHRoaXMuaGFuZGxlQnV5Q3VycmVuY3lTZWxlY3QsCiAgICAgICAgaWQ6ICJidXlBbW91bnQiLAogICAgICAgIGN1cnJlbmNpZXM6IGFkZFNlbGVjdGVkSXRlbXMsCiAgICAgICAgcGxhY2Vob2xkZXI6ICIwLjAwMDAwMDAwIgogICAgICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZU5hbWU6ICJleGNoYW5nZVJhdGUiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEV4Y2hhbmdlUmF0ZUdyb3VwLCB7CiAgICAgICAgbGFiZWw6IC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICAgIGlkOiAiYWRkb2ZmZXI0MDYiLAogICAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJFeGNoYW5nZSByYXRlIgogICAgICAgIH0pLAogICAgICAgIGlucHV0VmFsdWVMaW5rOiBsaW5rZWQuZXhjaGFuZ2VSYXRlLnBpcGUodGhpcy5oYW5kbGVFeGNoYW5nZVJhdGVDaGFuZ2UpLAogICAgICAgIGRpc2FibGVkOiAhbWFudWFsUmF0ZSwKICAgICAgICBpZDogImV4Y2hhbmdlUmF0ZSIsCiAgICAgICAgcGxhY2Vob2xkZXI6ICJFbnRlciBleGNoYW5nZSByYXRlIGFtb3VudCIsCiAgICAgICAgYnV5Q3VycmVuY3k6IGJ1eUN1cnJlbmN5LAogICAgICAgIHNlbGxDdXJyZW5jeTogc2VsbEN1cnJlbmN5CiAgICAgIH0pKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZU5hbWU6ICJjb250cm9sc1RvZ2dsZXMiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGVOYW1lOiAidG9nZ2xlIgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUb2dnbGUsIHsKICAgICAgICBjaGVja2VkOiBtYW51YWxSYXRlLAogICAgICAgIG9uQ2hhbmdlOiB0aGlzLmhhbmRsZU1hbnVhbFJhdGUKICAgICAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGVOYW1lOiAidG9nZ2xlVGV4dCIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAiQWRkT2ZmZXI0MTgiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiQ3VzdG9tIGV4Y2hhbmdlIHJhdGUiCiAgICAgIH0pLCAnICcsIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRvb2x0aXAsIHsKICAgICAgICBpZDogImFkZDI2NCIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAiYWRkNDA4IiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIlRvIGNoYW5nZSB0aGUgZXhjaGFuZ2UgcmF0ZSAiCiAgICAgIH0pKSkpLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlTmFtZTogInRvZ2dsZSIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVG9nZ2xlLCB7CiAgICAgICAgY2hlY2tlZDogaXNQYXJ0aWFsLAogICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZSgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuc2V0U3RhdGUoZnVuY3Rpb24gKHN0YXRlKSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgaXNQYXJ0aWFsOiAhc3RhdGUuaXNQYXJ0aWFsCiAgICAgICAgICAgIH07CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlTmFtZTogInRvZ2dsZVRleHQiCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogIkFkZE9mZmVyNDIzIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkVuYWJsZSBwYXJ0aWFsIGZpbGxzIgogICAgICB9KSwgJyAnLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChUb29sdGlwLCB7CiAgICAgICAgaWQ6ICJhZGQ1NDciCiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGU6IHsKICAgICAgICAgIHRleHRBbGlnbjogJ2NlbnRlcicKICAgICAgICB9CiAgICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogImFkZE9mZmVyUGFydGlhbFRvb2x0aXAiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiWW91IHdpbGwgcmVjZWl2ZSBleGNoYW5nZSByZXF1ZXN0cyBvciB0aGUge3B9IGFtb3VudCBsZXNzIHRoYW4gdGhlIHRvdGFsIGFtb3VudCB5b3Ugd2FudCB7cH0gc2VsbC4gRm9yIGV4YW1wbGUgeW91IHdhbnQgdG8gc2VsbCAxIEJUQyxcbiAgICAgICAgICAgICAgICAgICAgICBvdGhlciB1c2VycyBjYW4gc2VuZCB5b3UgZXhjaGFuZ2UgcmVxdWVzdHMge3B9Zm9yIDAuMSwgMC41IEJUQyIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBwOiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiYnIiLCBudWxsKQogICAgICAgIH0KICAgICAgfSkpKSkpLCBpc1Nob3dTd2FwTW9kZVN3aXRjaCAmJiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlTmFtZTogInRvZ2dsZSIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICBzdHlsZU5hbWU6ICJ0b2dnbGVUZXh0IgogICAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJBdG9taWNTd2FwX1RpdGxlIiwKICAgICAgICBkZWZhdWx0TWVzc2FnZTogIkF0b21pYyBzd2FwIgogICAgICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFRvZ2dsZSwgewogICAgICAgIGNoZWNrZWQ6IGlzVHVyYm8sCiAgICAgICAgaXNEaXNhYmxlZDogIWlzVHVyYm9BbGxvd2VkLAogICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZSgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuc2V0U3RhdGUoZnVuY3Rpb24gKHN0YXRlKSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgaXNUdXJibzogIXN0YXRlLmlzVHVyYm8KICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KCJkaXYiLCB7CiAgICAgICAgc3R5bGVOYW1lOiAidG9nZ2xlVGV4dCIKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoVHVyYm9JY29uLCBudWxsKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoInNwYW4iLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJUdXJib1N3YXBfVGl0bGUiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiVHVyYm8gc3dhcCIKICAgICAgfSksICJceEEwIiwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImEiLCB7CiAgICAgICAgaHJlZjogImh0dHBzOi8vZ2l0aHViLmNvbS9zd2Fwb25saW5lL011bHRpQ3VycmVuY3lXYWxsZXQvYmxvYi9tYXN0ZXIvZG9jcy9UVVJCT19TV0FQUy5tZCIsCiAgICAgICAgdGFyZ2V0OiAiX2JsYW5rIgogICAgICB9LCAiKD8pIikpKSkpLCBuZWVkRXRoQmFsYW5jZSAmJiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudCgiZGl2IiwgewogICAgICAgIHN0eWxlTmFtZTogIkVycm9yIgogICAgICB9LCBpc1Rva2VuQnV5ICYmIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KEZvcm1hdHRlZE1lc3NhZ2UsIHsKICAgICAgICBpZDogIkNyZWF0ZU9mZmVyX0J1eVRva2VuX05lZWRFdGgiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiXHUwNDE0XHUwNDNCXHUwNDRGIFx1MDQzRlx1MDQzRVx1MDQzQVx1MDQ0M1x1MDQzRlx1MDQzQVx1MDQzOCB7YnV5Q3VycmVuY3l9IFx1MDQzMlx1MDQzMFx1MDQzQyBcdTA0M0RcdTA0NDNcdTA0MzZcdTA0M0RcdTA0M0UgXHUwNDM4XHUwNDNDXHUwNDM1XHUwNDQyXHUwNDRDIHtldGhBbW91bnR9IEVUSCBcdTA0MzRcdTA0M0JcdTA0NEYgXHUwNDNFXHUwNDNGXHUwNDNCXHUwNDMwXHUwNDQyXHUwNDRCIFx1MDQzQVx1MDQzRVx1MDQzQ1x1MDQzQ1x1MDQzOFx1MDQ0MVx1MDQzOFx1MDQzOCIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBidXlDdXJyZW5jeTogYnV5Q3VycmVuY3kudG9VcHBlckNhc2UoKSwKICAgICAgICAgIGV0aEFtb3VudDogbWluTmVlZEV0aEJhbGFuY2UKICAgICAgICB9CiAgICAgIH0pLCBpc1Rva2VuU2VsbCAmJiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChGb3JtYXR0ZWRNZXNzYWdlLCB7CiAgICAgICAgaWQ6ICJDcmVhdGVPZmZlcl9TZWxsVG9rZW5fTmVlZEV0aCIsCiAgICAgICAgZGVmYXVsdE1lc3NhZ2U6ICJcdTA0MTRcdTA0M0JcdTA0NEYgXHUwNDNGXHUwNDQwXHUwNDNFXHUwNDM0XHUwNDMwXHUwNDM2XHUwNDM4IHtzZWxsQ3VycmVuY3l9IFx1MDQzMlx1MDQzMFx1MDQzQyBcdTA0M0RcdTA0NDNcdTA0MzZcdTA0M0RcdTA0M0UgXHUwNDM4XHUwNDNDXHUwNDM1XHUwNDQyXHUwNDRDIHtldGhBbW91bnR9IEVUSCBcdTA0MzRcdTA0M0JcdTA0NEYgXHUwNDNFXHUwNDNGXHUwNDNCXHUwNDMwXHUwNDQyXHUwNDRCIFx1MDQzQVx1MDQzRVx1MDQzQ1x1MDQzQ1x1MDQzOFx1MDQ0MVx1MDQzOFx1MDQzOCIsCiAgICAgICAgdmFsdWVzOiB7CiAgICAgICAgICBzZWxsQ3VycmVuY3k6IHNlbGxDdXJyZW5jeS50b1VwcGVyQ2FzZSgpLAogICAgICAgICAgZXRoQW1vdW50OiBtaW5OZWVkRXRoQmFsYW5jZQogICAgICAgIH0KICAgICAgfSkpLCBPYmplY3QudmFsdWVzKGxpbmtlZCkubWFwKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgICAgIHJldHVybiBCb29sZWFuKGl0ZW0uZXJyb3IpID8gLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoImRpdiIsIHsKICAgICAgICAgIGtleTogaW5kZXgsCiAgICAgICAgICBzdHlsZU5hbWU6ICJFcnJvciIKICAgICAgICB9LCBpdGVtLmVycm9yKSA6ICcnOwogICAgICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoQnV0dG9uLCB7CiAgICAgICAgc3R5bGVOYW1lOiAiYnV0dG9uIiwKICAgICAgICBmdWxsV2lkdGg6IHRydWUsCiAgICAgICAgYmx1ZTogdHJ1ZSwKICAgICAgICBkaXNhYmxlZDogaXNEaXNhYmxlZCwKICAgICAgICBvbkNsaWNrOiB0aGlzLmhhbmRsZU5leHQKICAgICAgfSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoRm9ybWF0dGVkTWVzc2FnZSwgewogICAgICAgIGlkOiAiQWRkT2ZmZXIzOTYiLAogICAgICAgIGRlZmF1bHRNZXNzYWdlOiAiTmV4dCIKICAgICAgfSkpKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBBZGRPZmZlcjsKfShDb21wb25lbnQpLCBfdGVtcCkpIHx8IF9jbGFzcykgfHwgX2NsYXNzKTsKZXhwb3J0IHsgQWRkT2ZmZXIgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/components/modals/OfferModal/AddOffer/AddOffer.tsx"],"names":["React","Component","connect","actions","helpers","constants","Link","config","BigNumber","styles","cssModules","Select","ExchangeRateGroup","SelectGroup","Button","Toggle","Tooltip","FormattedMessage","minAmountOffer","coinsWithDynamicFee","TurboIcon","turboSwap","mathConstants","high_precision","low_precision","isNumberStringFormatCorrect","number","stringified","String","firstDotIndex","indexOf","lastDotIndex","lastIndexOf","isDark","localStorage","getItem","AddOffer","currencies","addSelectedItems","user","ethData","btcData","ghostData","nextData","tokensData","items","tokenItems","Object","keys","map","k","allowMultiple","props","state","sellCurrency","buyCurrency","correctMinAmountSell","correctMinAmountBuy","eth","getBalance","ethBalance","setState","currency","concat","filter","item","toUpperCase","balance","unconfirmedBalance","currentBalance","isNaN","isLessThan","plus","balanceWithoutFee","ethToken","isEthToken","name","minus","minimalestAmountForSell","finalBalance","isGreaterThan","toString","isTokenSell","isTokenBuy","includes","estimateFeeValue","method","speed","minimalestAmountForBuy","getExchangeRate","exchangeRateSell","exchangeRateBuy","div","dp","ROUND_CEIL","exchangeRate","Promise","resolve","reject","value","buyAmount","sellAmount","isTurbo","switching","checkPair","checkBalance","updateExchangeRate","handleBuyAmountChange","handleSellAmountChange","getFee","undefined","handleAnyChange","type","manualRate","isSending","newSellAmount","newExchangeRate","dividedBy","newBuyAmount","multipliedBy","tokenDecimals","toLowerCase","ROUND_DOWN","console","error","onNext","handleSellCurrencySelect","pairs","selectPair","selected","check","initialData","isWidget","window","widgetERC20Tokens","length","forEach","key","erc20token","isPartial","btc","checkEthBalance","sellInputValueIsOk","minNeedEthBalance","needEthBalance","linked","all","minimalAmountSell","minimalAmountBuy","isShowSwapModeSwitch","process","env","MAINNET","isTurboAllowed","isAssetSupported","isDisabled","pipe","changeBalance","handleBuyCurrencySelect","handleExchangeRateChange","handleManualRate","textAlign","p","ethAmount","values","index","Boolean","handleNext"],"mappings":"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","sourcesContent":["// @ts-nocheck\r\nimport React, { Component } from 'react'\r\n\r\nimport { connect } from 'redaction'\r\nimport actions from 'redux/actions'\r\nimport helpers, { constants } from 'helpers'\r\n\r\nimport Link from 'local_modules/sw-valuelink'\r\nimport config from 'app-config'\r\n\r\nimport { BigNumber } from 'bignumber.js'\r\n\r\nimport styles from './AddOffer.scss'\r\nimport cssModules from 'react-css-modules'\r\n\r\nimport Select from './Select/Select'\r\nimport ExchangeRateGroup from './ExchangeRateGroup/ExchangeRateGroup'\r\nimport SelectGroup from './SelectGroup/SelectGroup'\r\n\r\nimport Button from 'components/controls/Button/Button'\r\nimport Toggle from 'components/controls/Toggle/Toggle'\r\nimport Input from 'components/forms/Input/Input'\r\nimport Tooltip from 'components/ui/Tooltip/Tooltip'\r\nimport { FormattedMessage } from 'react-intl'\r\nimport minAmountOffer from 'helpers/constants/minAmountOffer'\r\nimport coinsWithDynamicFee from 'helpers/constants/coinsWithDynamicFee'\r\nimport TurboIcon from 'shared/components/ui/TurboIcon/TurboIcon'\r\nimport turboSwap from 'common/helpers/turboSwap'\r\n\r\n\r\nconst mathConstants = {\r\n  high_precision: 10e-8,\r\n  low_precision: 10e-5,\r\n}\r\n\r\nconst isNumberStringFormatCorrect = number => {\r\n  const stringified = String(number)\r\n\r\n  const firstDotIndex = stringified.indexOf('.')\r\n  const lastDotIndex = stringified.lastIndexOf('.')\r\n\r\n  // first and last dot positions match, so it has only one dot\r\n  return firstDotIndex === lastDotIndex\r\n}\r\n\r\n\r\nconst isDark = localStorage.getItem(constants.localStorage.isDark)\r\n@connect(\r\n  ({\r\n    currencies,\r\n    addSelectedItems,\r\n    user: { ethData, btcData, ghostData, nextData, tokensData },\r\n  }) => ({\r\n    currencies: currencies.items,\r\n    addSelectedItems: currencies.addSelectedItems,\r\n    items: [ethData, btcData, ghostData, nextData],\r\n    tokenItems: [...Object.keys(tokensData).map(k => (tokensData[k]))],\r\n  })\r\n)\r\n@cssModules(styles, { allowMultiple: true })\r\nexport default class AddOffer extends Component<any, any> {\r\n\r\n  isSending: any\r\n\r\n  constructor(props) {\r\n    super(props)\r\n    const { items, tokenItems, initialData } = props\r\n\r\n    if (config && config.isWidget) {\r\n      if (window.widgetERC20Tokens && Object.keys(window.widgetERC20Tokens).length) {\r\n        Object.keys(window.widgetERC20Tokens).forEach((key) => {\r\n          minAmountOffer[key] = 1\r\n        })\r\n      } else {\r\n        minAmountOffer[config.erc20token] = 1\r\n      }\r\n    }\r\n\r\n    const { exchangeRate, buyAmount, sellAmount, buyCurrency, sellCurrency } = initialData || {}\r\n\r\n    this.state = {\r\n      balance: null,\r\n      isTokenSell: false,\r\n      isTokenBuy: false,\r\n      isPartial: true,\r\n      isTurbo: false,\r\n      isSending: false,\r\n      manualRate: true,\r\n      buyAmount: buyAmount || '',\r\n      sellAmount: sellAmount || '',\r\n      exchangeRate: exchangeRate || 1,\r\n      buyCurrency: buyCurrency || 'btc',\r\n      sellCurrency: sellCurrency || 'eth',\r\n      minimalestAmountForBuy: minAmountOffer[buyCurrency] || minAmountOffer.btc,\r\n      minimalestAmountForSell: minAmountOffer[sellCurrency] || minAmountOffer.eth,\r\n      ethBalance: 0,\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { sellCurrency, buyCurrency, value } = this.state\r\n\r\n    actions.pairs.selectPair(sellCurrency)\r\n    this.checkBalance(sellCurrency)\r\n    this.updateExchangeRate(sellCurrency, buyCurrency)\r\n    this.isEthToken(sellCurrency, buyCurrency)\r\n    this.getFee()\r\n    this.checkEthBalance()\r\n  }\r\n\r\n  getFee = () => {\r\n    const { sellCurrency, buyCurrency } = this.state\r\n\r\n    this.correctMinAmountSell(sellCurrency)\r\n    this.correctMinAmountBuy(buyCurrency)\r\n  }\r\n\r\n  checkEthBalance = async () => {\r\n    const ethBalance = await actions.eth.getBalance()\r\n    this.setState({\r\n      ethBalance,\r\n    })\r\n  }\r\n\r\n  checkBalance = async (sellCurrency) => {\r\n    await actions[sellCurrency].getBalance(sellCurrency)\r\n\r\n    const { items, tokenItems } = this.props\r\n\r\n    const currency = items.concat(tokenItems)\r\n      .filter(item => item.currency === sellCurrency.toUpperCase())[0]\r\n\r\n    let { balance, unconfirmedBalance } = currency\r\n\r\n    balance = new BigNumber(balance)\r\n    unconfirmedBalance = new BigNumber(unconfirmedBalance)\r\n\r\n    const currentBalance = unconfirmedBalance.isNaN() && unconfirmedBalance.isLessThan(0)\r\n      ? balance.plus(unconfirmedBalance)\r\n      : balance\r\n\r\n    const balanceWithoutFee = (helpers.ethToken.isEthToken({ name: this.state.sellCurrency }))\r\n      ? currentBalance\r\n      : currentBalance.minus(this.state.minimalestAmountForSell)\r\n\r\n    const finalBalance = balanceWithoutFee.isGreaterThan(0) ? balanceWithoutFee : new BigNumber(0)\r\n\r\n    this.setState({\r\n      balance: finalBalance.toString(),\r\n    })\r\n  }\r\n\r\n  isEthToken = (sellCurrency, buyCurrency) => {\r\n    const isTokenSell = helpers.ethToken.isEthToken({ name: sellCurrency })\r\n    const isTokenBuy = helpers.ethToken.isEthToken({ name: buyCurrency })\r\n\r\n    this.setState(() => ({\r\n      isTokenBuy,\r\n      isTokenSell,\r\n    }))\r\n  }\r\n\r\n  correctMinAmountSell = async (sellCurrency) => {\r\n    if (coinsWithDynamicFee.includes(sellCurrency) && !helpers.ethToken.isEthToken({ name: sellCurrency })) {\r\n      const minimalestAmountForSell = await helpers[sellCurrency].estimateFeeValue({ method: 'swap', speed: 'fast' })\r\n      this.setState({\r\n        minimalestAmountForSell,\r\n      })\r\n    }\r\n  }\r\n\r\n  correctMinAmountBuy = async (buyCurrency) => {\r\n    if (coinsWithDynamicFee.includes(buyCurrency)) {\r\n      const minimalestAmountForBuy = await helpers[buyCurrency].estimateFeeValue({ method: 'swap', speed: 'fast' })\r\n      this.setState({\r\n        minimalestAmountForBuy,\r\n      })\r\n    }\r\n  }\r\n\r\n  updateExchangeRate = async (sellCurrency, buyCurrency) => {\r\n    const exchangeRateSell: any = await actions.user.getExchangeRate(sellCurrency, 'usd')\r\n    const exchangeRateBuy: any = await actions.user.getExchangeRate(buyCurrency, 'usd')\r\n\r\n    const exchangeRate = sellCurrency === 'swap' || buyCurrency === 'swap'\r\n      ? await actions.user.getExchangeRate(sellCurrency, buyCurrency)\r\n      : new BigNumber(exchangeRateSell).div(exchangeRateBuy).dp(4, BigNumber.ROUND_CEIL)\r\n\r\n    return new Promise((resolve, reject) => {\r\n      this.setState({ exchangeRate }, () => resolve(true))\r\n    })\r\n  }\r\n\r\n  handleBuyCurrencySelect = async ({ value }) => {\r\n    const { buyCurrency, sellCurrency, buyAmount, sellAmount } = this.state\r\n\r\n    this.setState({\r\n      isTurbo: false,\r\n    })\r\n\r\n    if (sellCurrency === value) {\r\n      this.switching()\r\n    } else {\r\n      this.checkPair(sellCurrency)\r\n      await this.checkBalance(sellCurrency)\r\n      await this.updateExchangeRate(sellCurrency, value)\r\n\r\n      this.setState(() => ({\r\n        buyCurrency: value,\r\n      }))\r\n\r\n      if (sellAmount > 0 || buyAmount > 0) {\r\n        this.handleBuyAmountChange(buyAmount)\r\n        this.handleSellAmountChange(sellAmount)\r\n      }\r\n      this.isEthToken(sellCurrency, value)\r\n      this.getFee()\r\n    }\r\n  }\r\n\r\n  handleSellCurrencySelect = async ({ value }) => {\r\n    const { buyCurrency, sellCurrency, sellAmount, buyAmount } = this.state\r\n\r\n    this.setState({\r\n      isTurbo: false,\r\n    })\r\n\r\n    if (buyCurrency === value) {\r\n      this.switching()\r\n    } else {\r\n      this.checkPair(value)\r\n      await this.checkBalance(value)\r\n      await this.updateExchangeRate(value, buyCurrency)\r\n\r\n      this.setState(() => ({\r\n        sellCurrency: value,\r\n      }))\r\n\r\n      if (sellAmount > 0 || buyAmount > 0) {\r\n        this.handleBuyAmountChange(buyAmount)\r\n        this.handleSellAmountChange(sellAmount)\r\n      }\r\n      this.isEthToken(value, buyCurrency)\r\n      this.getFee()\r\n    }\r\n  }\r\n\r\n  handleExchangeRateChange = (value) => {\r\n    let { buyAmount, sellAmount } = this.state\r\n\r\n    if (!isNumberStringFormatCorrect(value)) {\r\n      return undefined\r\n    }\r\n\r\n    this.handleAnyChange({\r\n      type: 'rate',\r\n      value,\r\n    })\r\n\r\n    return value\r\n  }\r\n\r\n  handleBuyAmountChange = (value) => {\r\n    if (!isNumberStringFormatCorrect(value)) {\r\n      return undefined\r\n    }\r\n\r\n    this.handleAnyChange({\r\n      type: 'buy',\r\n      value,\r\n    })\r\n\r\n    return value\r\n  }\r\n\r\n  handleSellAmountChange = (value) => {\r\n    if (!isNumberStringFormatCorrect(value)) {\r\n      return undefined\r\n    }\r\n\r\n    this.handleAnyChange({\r\n      type: 'sell',\r\n      value,\r\n    })\r\n\r\n    return value\r\n  }\r\n\r\n  handleAnyChange = ({ type, value }) => {\r\n    const { manualRate, exchangeRate, buyAmount, sellAmount, buyCurrency, sellCurrency } = this.state\r\n\r\n    if (type === 'sell' || type === 'buy') {\r\n      if (!this.isSending) {\r\n        this.setState({ isSending: true })\r\n      }\r\n    }\r\n\r\n    /*\r\n        XR = S / B\r\n        B = S / XR\r\n        S = XR * B\r\n    */\r\n\r\n    switch (type) {\r\n      case 'sell': {\r\n        /*\r\n          S++ -> XR++ -> B (Manual Rate)\r\n          S++ -> XR -> B++ (Auto Rate)\r\n        */\r\n\r\n        const newSellAmount = new BigNumber(value || 0)\r\n\r\n        if (manualRate) {\r\n          const newExchangeRate = new BigNumber(value).dividedBy(buyAmount)\r\n\r\n          this.setState({\r\n            exchangeRate: newExchangeRate.isGreaterThan(0) ? newExchangeRate.toString() : '',\r\n            sellAmount: newSellAmount.toString(),\r\n          })\r\n        } else {\r\n          const newBuyAmount = newSellAmount.multipliedBy(exchangeRate || 0)\r\n            .dp(constants.tokenDecimals[buyCurrency.toLowerCase()], BigNumber.ROUND_DOWN)\r\n\r\n          this.setState({\r\n            sellAmount: newSellAmount.toString(),\r\n            buyAmount: newBuyAmount.toString(),\r\n          })\r\n        }\r\n        break\r\n      }\r\n\r\n      case 'buy': {\r\n        /*\r\n          B++ -> XR-- -> S (Manual Rate)\r\n          B++ -> XR -> S++ (Auto Rate)\r\n        */\r\n\r\n        const newBuyAmount = new BigNumber(value || 0)\r\n\r\n        if (manualRate) {\r\n          const newExchangeRate = new BigNumber(sellAmount).dividedBy(value)\r\n\r\n          this.setState({\r\n            exchangeRate: newExchangeRate.isGreaterThan(0) ? newExchangeRate.toString() : '',\r\n            buyAmount: newBuyAmount.toString(),\r\n          })\r\n        } else {\r\n          const newSellAmount = newBuyAmount.dividedBy(exchangeRate || 0)\r\n            .dp(constants.tokenDecimals[sellCurrency.toLowerCase()], BigNumber.ROUND_DOWN)\r\n\r\n          this.setState({\r\n            sellAmount: newSellAmount.toString(),\r\n            buyAmount: newBuyAmount.toString(),\r\n          })\r\n        }\r\n\r\n        break\r\n      }\r\n\r\n      case 'rate': {\r\n        if (new BigNumber(sellAmount).isGreaterThan(mathConstants.high_precision)) {\r\n          // If user has set sell value change buy value\r\n          /*\r\n            XR++ -> S -> B--\r\n          */\r\n\r\n          const newBuyAmount = new BigNumber(sellAmount).dividedBy(value || 0)\r\n\r\n          this.setState({\r\n            buyAmount: newBuyAmount.toString(),\r\n          })\r\n        } else {\r\n          // Otherwise change sell value if buy value is not null\r\n          /*\r\n            XR++ -> S++ -> B\r\n          */\r\n\r\n          const newSellAmount = new BigNumber(value || 0).multipliedBy(buyAmount)\r\n\r\n          this.setState({\r\n            sellAmount: newSellAmount.toString(),\r\n          })\r\n        }\r\n\r\n        break\r\n      }\r\n      default:\r\n        console.error('Unknown type')\r\n        break\r\n    }\r\n  }\r\n\r\n  handleNext = () => {\r\n    const { onNext } = this.props\r\n\r\n    // actions.analytics.dataEvent('orderbook-addoffer-click-next-button')\r\n    onNext(this.state)\r\n  }\r\n\r\n  changeBalance = (value) => {\r\n    this.setState(() => ({\r\n      sellAmount: new BigNumber(value).toString(),\r\n    }))\r\n\r\n    this.handleSellAmountChange(value)\r\n  }\r\n\r\n  handleManualRate = (value) => {\r\n    if (!value) {\r\n      const { sellCurrency } = this.state\r\n      this.handleSellCurrencySelect({ value: sellCurrency })\r\n    }\r\n    this.setState(() => ({ manualRate: value }))\r\n  }\r\n\r\n  switching = async () => {\r\n    const { sellCurrency, buyCurrency, sellAmount, buyAmount } = this.state\r\n\r\n    this.setState({\r\n      sellAmount: '',\r\n      buyAmount: '',\r\n      sellCurrency: buyCurrency,\r\n      buyCurrency: sellCurrency,\r\n    }, async () => {\r\n      await this.checkBalance(buyCurrency)\r\n      await this.updateExchangeRate(buyCurrency, sellCurrency)\r\n\r\n      actions.pairs.selectPair(buyCurrency)\r\n\r\n      this.isEthToken(this.state.sellCurrency, this.state.buyCurrency)\r\n      this.getFee()\r\n    })\r\n  }\r\n\r\n  checkPair = (value) => {\r\n    const selected = actions.pairs.selectPair(value)\r\n    const check = selected.map(item => item.value).includes(this.state.buyCurrency)\r\n\r\n    if (!check) {\r\n      this.setState(() => ({\r\n        buyCurrency: selected[0].value,\r\n      }))\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { currencies, tokenItems, addSelectedItems } = this.props\r\n    const { \r\n      exchangeRate, buyAmount,\r\n      sellAmount, buyCurrency,\r\n      sellCurrency, minimalestAmountForSell,\r\n      minimalestAmountForBuy, balance,\r\n      ethBalance, manualRate,\r\n      isPartial, isTurbo, isTokenSell,\r\n      isTokenBuy, sellInputValueIsOk\r\n    } = this.state\r\n\r\n    // @to-do - fetch eth miner fee for swap\r\n    const minNeedEthBalance = 0.004\r\n    const needEthBalance = (new BigNumber(ethBalance).isLessThan(minNeedEthBalance) && (isTokenBuy || isTokenSell))\r\n    const linked = Link.all(this, 'exchangeRate', 'buyAmount', 'sellAmount')\r\n\r\n    const minimalAmountSell = !isTokenSell\r\n      ? coinsWithDynamicFee.includes(sellCurrency) ? minimalestAmountForSell : minAmountOffer[buyCurrency]\r\n      : 0.001\r\n\r\n    const minimalAmountBuy = !isTokenBuy\r\n      ? coinsWithDynamicFee.includes(buyCurrency) ? minimalestAmountForBuy : minAmountOffer[buyCurrency]\r\n      : 0.001\r\n\r\n    // temporary: hide turboswaps on mainnet\r\n    const isShowSwapModeSwitch = !process.env.MAINNET\r\n\r\n    const isTurboAllowed = turboSwap.isAssetSupported(buyCurrency) && turboSwap.isAssetSupported(sellCurrency)\r\n\r\n    const isDisabled = !exchangeRate\r\n      || !buyAmount && !sellAmount\r\n      || new BigNumber(sellAmount).isGreaterThan(balance)\r\n      || new BigNumber(sellAmount).isLessThan(minimalAmountSell)\r\n      || new BigNumber(buyAmount).isLessThan(minimalAmountBuy)\r\n      || needEthBalance\r\n\r\n    if (linked.sellAmount.value !== '' && linked.sellAmount.value > 0) {\r\n      linked.sellAmount.check((value) => (new BigNumber(value).isGreaterThan(minimalAmountSell)),\r\n        <span>\r\n          <FormattedMessage id=\"transaction444\" defaultMessage=\"Sell amount must be greater than \" />\r\n          {' '}\r\n          {minimalAmountSell}\r\n        </span>\r\n      )\r\n    }\r\n    if (linked.buyAmount.value !== '' && linked.sellAmount.value > 0) {\r\n      linked.buyAmount.check((value) => (new BigNumber(value).isGreaterThan(minimalAmountBuy)),\r\n        <span>\r\n          <FormattedMessage id=\"transaction450\" defaultMessage=\"Buy amount must be greater than \" />\r\n          {' '}\r\n          {minimalAmountBuy}\r\n        </span>\r\n      )\r\n    }\r\n\r\n    return (\r\n      <div styleName={`wrapper addOffer ${isDark ? '--dark' : ''} `}>\r\n        <div styleName=\"offerTitle\">\r\n          <FormattedMessage id=\"offerMessageToUser\" defaultMessage=\"You must be online all the time, otherwise your order will not be visible to other users\" />\r\n        </div>\r\n\r\n        <SelectGroup\r\n          isDark={isDark}\r\n          label={<FormattedMessage id=\"addoffer381\" defaultMessage=\"Sell\" />}\r\n          tooltip={<FormattedMessage id=\"partial462\" defaultMessage=\"The amount you have on swap.online or an external wallet that you want to exchange\" />}\r\n          inputValueLink={linked.sellAmount.pipe(this.handleSellAmountChange)}\r\n          dontDisplayError\r\n          selectedValue={sellCurrency}\r\n          onSelect={this.handleSellCurrencySelect}\r\n          id=\"sellAmount\"\r\n          balance={balance}\r\n          currencies={currencies}\r\n          placeholder=\"0.00000000\"\r\n        />\r\n        <Select\r\n          isDark={isDark}\r\n          changeBalance={this.changeBalance}\r\n          balance={balance}\r\n          switching={this.switching}\r\n        />\r\n\r\n        <SelectGroup\r\n          isDark={isDark}\r\n          label={<FormattedMessage id=\"addoffer396\" defaultMessage=\"Buy\" />}\r\n          tooltip={<FormattedMessage id=\"partial478\" defaultMessage=\"The amount you will receive after the exchange\" />}\r\n          inputValueLink={linked.buyAmount.pipe(this.handleBuyAmountChange)}\r\n          dontDisplayError\r\n          selectedValue={buyCurrency}\r\n          onSelect={this.handleBuyCurrencySelect}\r\n          id=\"buyAmount\"\r\n          currencies={addSelectedItems}\r\n          placeholder=\"0.00000000\"\r\n        />\r\n\r\n        <div styleName=\"exchangeRate\">\r\n          <ExchangeRateGroup\r\n            label={<FormattedMessage id=\"addoffer406\" defaultMessage=\"Exchange rate\" />}\r\n            inputValueLink={linked.exchangeRate.pipe(this.handleExchangeRateChange)}\r\n            disabled={!manualRate}\r\n            id=\"exchangeRate\"\r\n            placeholder=\"Enter exchange rate amount\"\r\n            buyCurrency={buyCurrency}\r\n            sellCurrency={sellCurrency}\r\n          />\r\n        </div>\r\n\r\n        <div styleName=\"controlsToggles\">\r\n          <div styleName=\"toggle\">\r\n            {/*\r\n            //@ */}\r\n            <Toggle checked={manualRate} onChange={this.handleManualRate} />\r\n            <div styleName=\"toggleText\">\r\n              <FormattedMessage id=\"AddOffer418\" defaultMessage=\"Custom exchange rate\" />\r\n              {' '}\r\n              <Tooltip id=\"add264\">\r\n                <FormattedMessage id=\"add408\" defaultMessage=\"To change the exchange rate \" />\r\n              </Tooltip>\r\n            </div>\r\n          </div>\r\n\r\n          <div styleName=\"toggle\">\r\n            {/*\r\n            //@ */}\r\n            <Toggle checked={isPartial} onChange={() => this.setState((state) => ({ isPartial: !state.isPartial }))} />\r\n            <div styleName=\"toggleText\">\r\n              <FormattedMessage id=\"AddOffer423\" defaultMessage=\"Enable partial fills\" />\r\n              {' '}\r\n              <Tooltip id=\"add547\">\r\n                <div style={{ textAlign: 'center' }} >\r\n                  <FormattedMessage\r\n                    id=\"addOfferPartialTooltip\"\r\n                    defaultMessage={`You will receive exchange requests or the {p} amount less than the total amount you want {p} sell. For example you want to sell 1 BTC,\r\n                      other users can send you exchange requests {p}for 0.1, 0.5 BTC`}\r\n                    values={{ p: <br /> }}\r\n                  />\r\n                </div>\r\n              </Tooltip>\r\n            </div>\r\n          </div>\r\n\r\n          {isShowSwapModeSwitch &&\r\n            <div styleName=\"toggle\">\r\n              <div styleName=\"toggleText\">\r\n                <FormattedMessage id=\"AtomicSwap_Title\" defaultMessage=\"Atomic swap\" />\r\n              </div>\r\n              {/*\r\n              //@ */}\r\n              <Toggle checked={isTurbo} isDisabled={!isTurboAllowed} onChange={() => this.setState((state) => ({ isTurbo: !state.isTurbo }))} />\r\n              <div styleName=\"toggleText\">\r\n                <TurboIcon />\r\n                <span>\r\n                  <FormattedMessage id=\"TurboSwap_Title\" defaultMessage=\"Turbo swap\" />\r\n                  &nbsp;\r\n                  <a href=\"https://github.com/swaponline/MultiCurrencyWallet/blob/master/docs/TURBO_SWAPS.md\" target=\"_blank\">(?)</a>\r\n                </span>\r\n              </div>\r\n            </div>\r\n          }\r\n        </div>\r\n        {needEthBalance && (\r\n          <div styleName=\"Error\">\r\n            {isTokenBuy && (\r\n              <FormattedMessage\r\n                id=\"CreateOffer_BuyToken_NeedEth\"\r\n                defaultMessage=\"Для покупки {buyCurrency} вам нужно иметь {ethAmount} ETH для оплаты коммисии\"\r\n                values={{\r\n                  buyCurrency: buyCurrency.toUpperCase(),\r\n                  ethAmount: minNeedEthBalance,\r\n                }}\r\n              />\r\n            )}\r\n            {isTokenSell && (\r\n              <FormattedMessage\r\n                id=\"CreateOffer_SellToken_NeedEth\"\r\n                defaultMessage=\"Для продажи {sellCurrency} вам нужно иметь {ethAmount} ETH для оплаты коммисии\"\r\n                values={{\r\n                  sellCurrency: sellCurrency.toUpperCase(),\r\n                  ethAmount: minNeedEthBalance,\r\n                }}\r\n              />\r\n            )}\r\n          </div>\r\n        )}\r\n        {\r\n          Object.values(linked).map((item, index) => Boolean(item.error)\r\n            ? <div key={index} styleName=\"Error\">{item.error}</div>\r\n            : ''\r\n          )\r\n        }\r\n        <Button styleName=\"button\" fullWidth blue disabled={isDisabled} onClick={this.handleNext}>\r\n          <FormattedMessage id=\"AddOffer396\" defaultMessage=\"Next\" />\r\n        </Button>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]}]}