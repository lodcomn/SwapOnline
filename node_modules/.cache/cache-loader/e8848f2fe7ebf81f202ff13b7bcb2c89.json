{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\redux\\actions\\pubsubRoom.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\redux\\actions\\pubsubRoom.ts","mtime":1614842914293},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHJlZHVjZXJzIGZyb20gJ3JlZHV4L2NvcmUvcmVkdWNlcnMnOwppbXBvcnQgeyBnZXRTdGF0ZSB9IGZyb20gJ3JlZHV4L2NvcmUnOwppbXBvcnQgU3dhcEFwcCBmcm9tICdzd2FwLmFwcCc7Cgp2YXIgc2V0ID0gZnVuY3Rpb24gc2V0KHBheWxvYWQpIHsKICByZWR1Y2Vycy5wdWJzdWJSb29tLnNldChwYXlsb2FkKTsKfTsKCnZhciB1c2VySm9pbmVkID0gZnVuY3Rpb24gdXNlckpvaW5lZCgpIHsKICByZWR1Y2Vycy5wdWJzdWJSb29tLnVzZXJKb2luZWQoKTsKfTsKCnZhciB1c2VyTGVmdCA9IGZ1bmN0aW9uIHVzZXJMZWZ0KCkgewogIHJlZHVjZXJzLnB1YnN1YlJvb20udXNlckxlZnQoKTsKfTsKCnZhciBhbGxQZWVyc0xvYWRlZCA9IGZ1bmN0aW9uIGFsbFBlZXJzTG9hZGVkKCkgewogIHJlZHVjZXJzLnB1YnN1YlJvb20uYWxsUGVlcnNMb2FkZWQoKTsKfTsKCnZhciBvblJlYWR5ID0gZnVuY3Rpb24gb25SZWFkeShjYikgewogIHZhciBfY2hlY2tGdW5jID0gZnVuY3Rpb24gX2NoZWNrRnVuYygpIHsKICAgIHZhciBfZ2V0U3RhdGUgPSBnZXRTdGF0ZSgpLAogICAgICAgIGlzT25saW5lID0gX2dldFN0YXRlLnB1YnN1YlJvb20uaXNPbmxpbmU7CgogICAgaWYgKGlzT25saW5lKSB7CiAgICAgIGNiKCk7CiAgICB9IGVsc2UgewogICAgICBzZXRUaW1lb3V0KF9jaGVja0Z1bmMsIDEwMCk7CiAgICB9CiAgfTsKCiAgX2NoZWNrRnVuYygpOwp9OwoKdmFyIHdhaXRQZWVyID0gZnVuY3Rpb24gd2FpdFBlZXIocGVlciwgY2JTdWNjZXNzLCBjYkZhaWwsIHRpbWVPdXQpIHsKICBvblJlYWR5KGZ1bmN0aW9uICgpIHsKICAgIHZhciBpc1dhaXRpbmcgPSB0cnVlOwogICAgdmFyIGZhaWx0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgaXNXYWl0aW5nID0gZmFsc2U7CiAgICAgIGlmIChjYkZhaWwpIGNiRmFpbCgpOwogICAgfSwgdGltZU91dCk7CgogICAgdmFyIHdhaXRGdW5jID0gZnVuY3Rpb24gd2FpdEZ1bmMoKSB7CiAgICAgIGlmIChpc1dhaXRpbmcpIHsKICAgICAgICBpZiAoU3dhcEFwcC5zaGFyZWQoKS5zZXJ2aWNlcy5yb29tLmNvbm5lY3Rpb24uaGFzUGVlcihwZWVyKSkgewogICAgICAgICAgY2xlYXJUaW1lb3V0KGZhaWx0VGltZXIpOwogICAgICAgICAgaWYgKGNiU3VjY2VzcykgY2JTdWNjZXNzKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNldFRpbWVvdXQod2FpdEZ1bmMsIDEwMCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHdhaXRGdW5jKCk7CiAgfSk7Cn07CgpleHBvcnQgZGVmYXVsdCB7CiAgc2V0OiBzZXQsCiAgdXNlckpvaW5lZDogdXNlckpvaW5lZCwKICB1c2VyTGVmdDogdXNlckxlZnQsCiAgYWxsUGVlcnNMb2FkZWQ6IGFsbFBlZXJzTG9hZGVkLAogIG9uUmVhZHk6IG9uUmVhZHksCiAgd2FpdFBlZXI6IHdhaXRQZWVyCn07"},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/redux/actions/pubsubRoom.ts"],"names":["reducers","getState","SwapApp","set","payload","pubsubRoom","userJoined","userLeft","allPeersLoaded","onReady","cb","_checkFunc","isOnline","setTimeout","waitPeer","peer","cbSuccess","cbFail","timeOut","isWaiting","failtTimer","waitFunc","shared","services","room","connection","hasPeer","clearTimeout"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,qBAArB;AACA,SAASC,QAAT,QAAyB,YAAzB;AACA,OAAOC,OAAP,MAAoB,UAApB;;AAGA,IAAMC,GAAG,GAAG,SAANA,GAAM,CAAAC,OAAO,EAAI;AACrBJ,EAAAA,QAAQ,CAACK,UAAT,CAAoBF,GAApB,CAAwBC,OAAxB;AACD,CAFD;;AAIA,IAAME,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvBN,EAAAA,QAAQ,CAACK,UAAT,CAAoBC,UAApB;AACD,CAFD;;AAIA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,GAAM;AACrBP,EAAAA,QAAQ,CAACK,UAAT,CAAoBE,QAApB;AACD,CAFD;;AAIA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AAC3BR,EAAAA,QAAQ,CAACK,UAAT,CAAoBG,cAApB;AACD,CAFD;;AAIA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACC,EAAD,EAAQ;AACtB,MAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;AAAA,oBACeV,QAAQ,EADvB;AAAA,QACAW,QADA,aACfP,UADe,CACAO,QADA;;AAEvB,QAAIA,QAAJ,EAAc;AACZF,MAAAA,EAAE;AACH,KAFD,MAEO;AACLG,MAAAA,UAAU,CAACF,UAAD,EAAa,GAAb,CAAV;AACD;AACF,GAPD;;AAQAA,EAAAA,UAAU;AACX,CAVD;;AAYA,IAAMG,QAAQ,GAAG,SAAXA,QAAW,CAACC,IAAD,EAAOC,SAAP,EAAkBC,MAAlB,EAA0BC,OAA1B,EAAsC;AACrDT,EAAAA,OAAO,CAAC,YAAM;AACZ,QAAIU,SAAS,GAAG,IAAhB;AAEA,QAAMC,UAAU,GAAGP,UAAU,CAAC,YAAM;AAClCM,MAAAA,SAAS,GAAG,KAAZ;AACA,UAAIF,MAAJ,EAAYA,MAAM;AACnB,KAH4B,EAG1BC,OAH0B,CAA7B;;AAKA,QAAMG,QAAQ,GAAG,SAAXA,QAAW,GAAM;AACrB,UAAIF,SAAJ,EAAe;AACb,YAAIjB,OAAO,CAACoB,MAAR,GAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BC,UAA/B,CAA0CC,OAA1C,CAAkDX,IAAlD,CAAJ,EAA6D;AAC3DY,UAAAA,YAAY,CAACP,UAAD,CAAZ;AACA,cAAIJ,SAAJ,EAAeA,SAAS;AACzB,SAHD,MAGO;AACLH,UAAAA,UAAU,CAACQ,QAAD,EAAW,GAAX,CAAV;AACD;AACF;AACF,KATD;;AAUAA,IAAAA,QAAQ;AACT,GAnBM,CAAP;AAoBD,CArBD;;AAuBA,eAAe;AACblB,EAAAA,GAAG,EAAHA,GADa;AAEbG,EAAAA,UAAU,EAAVA,UAFa;AAGbC,EAAAA,QAAQ,EAARA,QAHa;AAIbC,EAAAA,cAAc,EAAdA,cAJa;AAKbC,EAAAA,OAAO,EAAPA,OALa;AAMbK,EAAAA,QAAQ,EAARA;AANa,CAAf","sourcesContent":["import reducers from 'redux/core/reducers'\r\nimport { getState } from 'redux/core'\r\nimport SwapApp from 'swap.app'\r\n\r\n\r\nconst set = payload => {\r\n  reducers.pubsubRoom.set(payload)\r\n}\r\n\r\nconst userJoined = () => {\r\n  reducers.pubsubRoom.userJoined()\r\n}\r\n\r\nconst userLeft = () => {\r\n  reducers.pubsubRoom.userLeft()\r\n}\r\n\r\nconst allPeersLoaded = () => {\r\n  reducers.pubsubRoom.allPeersLoaded()\r\n}\r\n\r\nconst onReady = (cb) => {\r\n  const _checkFunc = () => {\r\n    const { pubsubRoom : { isOnline } } = getState()\r\n    if (isOnline) {\r\n      cb()\r\n    } else {\r\n      setTimeout(_checkFunc, 100)\r\n    }\r\n  }\r\n  _checkFunc()\r\n}\r\n\r\nconst waitPeer = (peer, cbSuccess, cbFail, timeOut) => {\r\n  onReady(() => {\r\n    let isWaiting = true\r\n\r\n    const failtTimer = setTimeout(() => {\r\n      isWaiting = false\r\n      if (cbFail) cbFail()\r\n    }, timeOut)\r\n\r\n    const waitFunc = () => {\r\n      if (isWaiting) {\r\n        if (SwapApp.shared().services.room.connection.hasPeer(peer)) {\r\n          clearTimeout(failtTimer)\r\n          if (cbSuccess) cbSuccess()\r\n        } else {\r\n          setTimeout(waitFunc, 100)\r\n        }\r\n      }\r\n    }\r\n    waitFunc()\r\n  })\r\n}\r\n\r\nexport default {\r\n  set,\r\n  userJoined,\r\n  userLeft,\r\n  allPeersLoaded,\r\n  onReady,\r\n  waitPeer,\r\n}\r\n"]}]}