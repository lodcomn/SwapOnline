{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\common\\utils\\coin\\next.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\common\\utils\\coin\\next.ts","mtime":1614842913722},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9vYmplY3RXaXRob3V0UHJvcGVydGllcyI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmltcG9ydCBhcGlMb29wZXIgZnJvbSAnLi4vYXBpTG9vcGVyJzsKaW1wb3J0IHsgQmlnTnVtYmVyIH0gZnJvbSAnYmlnbnVtYmVyLmpzJzsKaW1wb3J0ICogYXMgbmV4dCBmcm9tICdiaXRjb2luanMtbGliJzsgLy8gVXNlIGZyb250IEFQSSBjb25maWcKCmltcG9ydCB7IGRlZmF1bHQgYXMgVEVTVE5FVCB9IGZyb20gJy4uLy4uLy4uL2Zyb250L2NvbmZpZy90ZXN0bmV0L2FwaSc7CmltcG9ydCB7IGRlZmF1bHQgYXMgTUFJTk5FVCB9IGZyb20gJy4uLy4uLy4uL2Zyb250L2NvbmZpZy90ZXN0bmV0L2FwaSc7CnZhciBEVVNUID0gNTQ2OyAvLyBIZWxwIGZ1bmN0aW9uIC0gZ2V0IGFwaSBieSBuZXR3b3JrCgp2YXIgZ2V0QXBpTmV4dCA9IGZ1bmN0aW9uIGdldEFwaU5leHQobmV0d29yaykgewogIHJldHVybiB7CiAgICBuYW1lOiAiYXBpTmV4dE1haW4iLAogICAgc2VydmVyczogbmV0d29yayA9PT0gIk1BSU5ORVQiID8gTUFJTk5FVC5uZXh0RXhwbG9yZXIgOiBURVNUTkVULm5leHRFeHBsb3JlcgogIH07Cn07Cgp2YXIgZ2V0QXBpQ3VzdG9tID0gZnVuY3Rpb24gZ2V0QXBpQ3VzdG9tKG5ldHdvcmspIHsKICByZXR1cm4gewogICAgbmFtZTogImFwaU5leHRDdXN0b20iLAogICAgc2VydmVyczogbmV0d29yayA9PT0gIk1BSU5ORVQiID8gTUFJTk5FVC5uZXh0RXhwbG9yZXJDdXN0b20gOiBURVNUTkVULm5leHRFeHBsb3JlckN1c3RvbQogIH07Cn07Cgp2YXIgZ2V0Q29yZSA9IGZ1bmN0aW9uIGdldENvcmUoKSB7CiAgcmV0dXJuIG5leHQ7Cn07Cgp2YXIgZmV0Y2hCYWxhbmNlID0gZnVuY3Rpb24gZmV0Y2hCYWxhbmNlKG9wdGlvbnMpIHsKICB2YXIgYWRkcmVzcyA9IG9wdGlvbnMuYWRkcmVzcywKICAgICAgQVBJX0VORFBPSU5UID0gb3B0aW9ucy5BUElfRU5EUE9JTlQsCiAgICAgIE5FVFdPUksgPSBvcHRpb25zLk5FVFdPUks7CiAgcmV0dXJuIGFwaUxvb3Blci5nZXQoQVBJX0VORFBPSU5UIHx8IGdldEFwaU5leHQoTkVUV09SSyksICIvYWRkcmVzcy8iLmNvbmNhdChhZGRyZXNzKSwgewogICAgY2hlY2tTdGF0dXM6IGZ1bmN0aW9uIGNoZWNrU3RhdHVzKGFuc3dlcikgewogICAgICB0cnkgewogICAgICAgIGlmIChhbnN3ZXIgJiYgYW5zd2VyLmJhbGFuY2UgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWU7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvKiAqLwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgaWdub3JlRXJyb3JzOiB0cnVlLAogICAgcmVwb3J0RXJyb3JzOiBmdW5jdGlvbiByZXBvcnRFcnJvcnMoYW5zd2VyLCBvblN1Y2Nlc3MsIG9uRmFpbCkgewogICAgICBjb25zb2xlLmxvZygnPj4+PiBmZXRjaEJhbGFuY2UgcmVwb3J0RXJyb3JzJyk7CiAgICAgIGNvbnNvbGUubG9nKGFuc3dlcik7CiAgICAgIG9uU3VjY2Vzcyh7CiAgICAgICAgYmFsYW5jZTogMAogICAgICB9KTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSkudGhlbihmdW5jdGlvbiAoX3JlZikgewogICAgdmFyIGJhbGFuY2UgPSBfcmVmLmJhbGFuY2U7CiAgICByZXR1cm4gYmFsYW5jZTsKICB9KTsKfTsKCnZhciBmZXRjaFVuc3BlbnRzID0gZnVuY3Rpb24gZmV0Y2hVbnNwZW50cyhvcHRpb25zKSB7CiAgdmFyIGFkZHJlc3MgPSBvcHRpb25zLmFkZHJlc3MsCiAgICAgIEFQSV9FTkRQT0lOVCA9IG9wdGlvbnMuQVBJX0VORFBPSU5ULAogICAgICBORVRXT1JLID0gb3B0aW9ucy5ORVRXT1JLOwogIHJldHVybiBhcGlMb29wZXIuZ2V0KEFQSV9FTkRQT0lOVCB8fCBnZXRBcGlDdXN0b20oTkVUV09SSyksICIvYWRkci8iLmNvbmNhdChhZGRyZXNzLCAiL3V0eG8iKSwgewogICAgY2FjaGVSZXNwb25zZTogNTAwMAogIH0pOwp9OwoKdmFyIGJyb2FkY2FzdFR4ID0gZnVuY3Rpb24gYnJvYWRjYXN0VHgob3B0aW9ucykgewogIHZhciB0eFJhdyA9IG9wdGlvbnMudHhSYXcsCiAgICAgIEFQSV9FTkRQT0lOVCA9IG9wdGlvbnMuQVBJX0VORFBPSU5ULAogICAgICBORVRXT1JLID0gb3B0aW9ucy5ORVRXT1JLOwogIHJldHVybiBhcGlMb29wZXIucG9zdChBUElfRU5EUE9JTlQgfHwgZ2V0QXBpTmV4dChORVRXT1JLKSwgIi9zZW5kcmF3dHJhbnNhY3Rpb24iLCB7CiAgICBib2R5OiB7CiAgICAgIHJhd3R4OiB0eFJhdwogICAgfQogIH0pOwp9OwoKdmFyIGZldGNoVHggPSBmdW5jdGlvbiBmZXRjaFR4KG9wdGlvbnMpIHsKICB2YXIgaGFzaCA9IG9wdGlvbnMuaGFzaCwKICAgICAgY2FjaGVSZXNwb25zZSA9IG9wdGlvbnMuY2FjaGVSZXNwb25zZSwKICAgICAgQVBJX0VORFBPSU5UID0gb3B0aW9ucy5BUElfRU5EUE9JTlQsCiAgICAgIE5FVFdPUksgPSBvcHRpb25zLk5FVFdPUks7CiAgcmV0dXJuIGFwaUxvb3Blci5nZXQoQVBJX0VORFBPSU5UIHx8IGdldEFwaU5leHQoTkVUV09SSyksICIvdHgvIi5jb25jYXQoaGFzaCksIHsKICAgIGNhY2hlUmVzcG9uc2U6IGNhY2hlUmVzcG9uc2UsCiAgICBjaGVja1N0YXR1czogZnVuY3Rpb24gY2hlY2tTdGF0dXMoYW5zd2VyKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKGFuc3dlciAmJiBhbnN3ZXIudHhJZCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gdHJ1ZTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIC8qICovCiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9KS50aGVuKGZ1bmN0aW9uIChfcmVmMikgewogICAgdmFyIGZlZXMgPSBfcmVmMi5mZWVzLAogICAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoX3JlZjIsIFsiZmVlcyJdKTsKCiAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7CiAgICAgIGZlZXM6IG5ldyBCaWdOdW1iZXIoZmVlcykubXVsdGlwbGllZEJ5KDFlOCkKICAgIH0sIHJlc3QpOwogIH0pOwp9OwovKiogdG8tdG8gLSBpbiBmcm9udCBoYXMgbWFyayAobm90LXdvcmtpbmcpIC0gbmVlZCByZWNoZWNrLCBtYXkgYmUgd2lsbCBiZSBmaXhlZCAqKi8KCgp2YXIgZmV0Y2hUeEluZm8gPSBmdW5jdGlvbiBmZXRjaFR4SW5mbyhvcHRpb25zKSB7CiAgdmFyIGhhc2ggPSBvcHRpb25zLmhhc2gsCiAgICAgIGNhY2hlUmVzcG9uc2UgPSBvcHRpb25zLmNhY2hlUmVzcG9uc2UsCiAgICAgIEFQSV9FTkRQT0lOVCA9IG9wdGlvbnMuQVBJX0VORFBPSU5ULAogICAgICBoYXNBZG1pbkZlZSA9IG9wdGlvbnMuaGFzQWRtaW5GZWUsCiAgICAgIE5FVFdPUksgPSBvcHRpb25zLk5FVFdPUks7CiAgcmV0dXJuIGZldGNoVHgoewogICAgaGFzaDogaGFzaCwKICAgIGNhY2hlUmVzcG9uc2U6IGNhY2hlUmVzcG9uc2UsCiAgICBBUElfRU5EUE9JTlQ6IEFQSV9FTkRQT0lOVCwKICAgIE5FVFdPUks6IE5FVFdPUksKICB9KS50aGVuKGZ1bmN0aW9uICh0eEluZm9fKSB7CiAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgdHhJbmZvXyk7CiAgICAvKiogeWVzIC0gXl5eXiBub3Qgd29ya2luZyAtINC30LDQs9C70YPQttC60LAgKiovCgogICAgdmFyIHZpbiA9IHR4SW5mb18udmluLAogICAgICAgIHZvdXQgPSB0eEluZm9fLnZvdXQsCiAgICAgICAgcmVzdCA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyh0eEluZm9fLCBbInZpbiIsICJ2b3V0Il0pOwoKICAgIHZhciBzZW5kZXJBZGRyZXNzID0gdmluID8gdmluWzBdLmFkZHIgOiBudWxsOwogICAgdmFyIGFtb3VudCA9IHZvdXQgPyBuZXcgQmlnTnVtYmVyKHZvdXRbMF0udmFsdWUpLnRvTnVtYmVyKCkgOiBudWxsOwogICAgdmFyIGFmdGVyQmFsYW5jZSA9IHZvdXQgJiYgdm91dFsxXSA/IG5ldyBCaWdOdW1iZXIodm91dFsxXS52YWx1ZSkudG9OdW1iZXIoKSA6IG51bGw7CiAgICB2YXIgYWRtaW5GZWUgPSBmYWxzZTsKCiAgICBpZiAoaGFzQWRtaW5GZWUpIHsKICAgICAgdmFyIGFkbWluT3V0cHV0ID0gdm91dC5maWx0ZXIoZnVuY3Rpb24gKG91dCkgewogICAgICAgIHJldHVybiBvdXQuc2NyaXB0UHViS2V5LmFkZHJlc3NlcyAmJiBvdXQuc2NyaXB0UHViS2V5LmFkZHJlc3Nlc1swXSA9PT0gaGFzQWRtaW5GZWUuYWRkcmVzcyAmJiAhbmV3IEJpZ051bWJlcihvdXQudmFsdWUpLmVxKGFtb3VudCk7CiAgICAgIH0pOwogICAgICB2YXIgYWZ0ZXJPdXRwdXQgPSB2b3V0LmZpbHRlcihmdW5jdGlvbiAob3V0KSB7CiAgICAgICAgcmV0dXJuIG91dC5hZGRyZXNzZXMgJiYgb3V0LmFkZHJlc3Nlc1swXSAhPT0gaGFzQWRtaW5GZWUuYWRkcmVzcyAmJiBvdXQuYWRkcmVzc2VzWzBdICE9PSBzZW5kZXJBZGRyZXNzOwogICAgICB9KTsKCiAgICAgIGlmIChhZnRlck91dHB1dC5sZW5ndGgpIHsKICAgICAgICBhZnRlckJhbGFuY2UgPSBuZXcgQmlnTnVtYmVyKGFmdGVyT3V0cHV0WzBdLnZhbHVlKS50b051bWJlcigpOwogICAgICB9CgogICAgICBpZiAoYWRtaW5PdXRwdXQubGVuZ3RoKSB7CiAgICAgICAgYWRtaW5GZWUgPSBuZXcgQmlnTnVtYmVyKGFkbWluT3V0cHV0WzBdLnZhbHVlKS50b051bWJlcigpOwogICAgICB9CiAgICB9CgogICAgdmFyIHR4SW5mbyA9IF9vYmplY3RTcHJlYWQoewogICAgICBhbW91bnQ6IGFtb3VudCwKICAgICAgYWZ0ZXJCYWxhbmNlOiBhZnRlckJhbGFuY2UsCiAgICAgIHNlbmRlckFkZHJlc3M6IHNlbmRlckFkZHJlc3MsCiAgICAgIHJlY2VpdmVyQWRkcmVzczogdm91dCA/IHZvdXRbMF0uc2NyaXB0UHViS2V5LmFkZHJlc3NlcyA6IG51bGwsCiAgICAgIGNvbmZpcm1lZDogISFyZXN0LmNvbmZpcm1hdGlvbnMsCiAgICAgIG1pbmVyRmVlOiByZXN0LmZlZXMuZGl2aWRlZEJ5KDFlOCkudG9OdW1iZXIoKSwKICAgICAgYWRtaW5GZWU6IGFkbWluRmVlLAogICAgICBtaW5lckZlZUN1cnJlbmN5OiAnTkVYVCcsCiAgICAgIG91dHB1dHM6IHZvdXQubWFwKGZ1bmN0aW9uIChvdXQpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgYW1vdW50OiBuZXcgQmlnTnVtYmVyKG91dC52YWx1ZSkudG9OdW1iZXIoKSwKICAgICAgICAgIGFkZHJlc3M6IG91dC5zY3JpcHRQdWJLZXkuYWRkcmVzc2VzIHx8IG51bGwKICAgICAgICB9OwogICAgICB9KQogICAgfSwgcmVzdCk7CgogICAgcmV0dXJuIHR4SW5mbzsKICB9KTsKfTsKCnZhciBjaGVja1dpdGhkcmF3ID0gZnVuY3Rpb24gY2hlY2tXaXRoZHJhdyhvcHRpb25zKSB7CiAgdmFyIHNjcmlwdEFkZHJlc3MgPSBvcHRpb25zLnNjcmlwdEFkZHJlc3MsCiAgICAgIEFQSV9FTkRQT0lOVCA9IG9wdGlvbnMuQVBJX0VORFBPSU5ULAogICAgICBORVRXT1JLID0gb3B0aW9ucy5ORVRXT1JLOwogIHJldHVybiBhcGlMb29wZXIuZ2V0KEFQSV9FTkRQT0lOVCB8fCBnZXRBcGlDdXN0b20oTkVUV09SSyksICIvdHhzLyIuY29uY2F0KHNjcmlwdEFkZHJlc3MpLCB7CiAgICBjaGVja1N0YXR1czogZnVuY3Rpb24gY2hlY2tTdGF0dXMoYW5zd2VyKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKGFuc3dlciAmJiBhbnN3ZXIudHhzICE9PSB1bmRlZmluZWQpIHJldHVybiB0cnVlOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgLyogKi8KICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHF1ZXJ5OiAnbmV4dF9iYWxhbmNlJwogIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgaWYgKHJlcy50eHMubGVuZ3RoID4gMSAmJiByZXMudHhzWzBdLnZvdXQubGVuZ3RoKSB7CiAgICAgIHZhciBhZGRyZXNzID0gcmVzLnR4c1swXS52b3V0WzBdLnNjcmlwdFB1YktleS5hZGRyZXNzZXNbMF07CiAgICAgIHZhciBhbW91bnQgPSByZXMudHhzWzBdLnZvdXRbMF0udmFsdWVTYXQ7CiAgICAgIHZhciB0eGlkID0gcmVzLnR4c1swXS50eGlkOwogICAgICByZXR1cm4gewogICAgICAgIGFkZHJlc3M6IGFkZHJlc3MsCiAgICAgICAgdHhpZDogdHhpZCwKICAgICAgICBhbW91bnQ6IGFtb3VudAogICAgICB9OwogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfTsKCnZhciBjYWxjdWxhdGVUeFNpemUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmMyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUob3B0aW9ucykgewogICAgdmFyIHNwZWVkLCBfdW5zcGVudHMsIGFkZHJlc3MsIF9vcHRpb25zJHR4T3V0LCB0eE91dCwgZml4ZWQsIE5FVFdPUkssIGRlZmF1bHRUeFNpemUsIHVuc3BlbnRzLCB0eEluLCB0eFNpemU7CgogICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgc3BlZWQgPSBvcHRpb25zLnNwZWVkLCBfdW5zcGVudHMgPSBvcHRpb25zLnVuc3BlbnRzLCBhZGRyZXNzID0gb3B0aW9ucy5hZGRyZXNzLCBfb3B0aW9ucyR0eE91dCA9IG9wdGlvbnMudHhPdXQsIHR4T3V0ID0gX29wdGlvbnMkdHhPdXQgPT09IHZvaWQgMCA/IDIgOiBfb3B0aW9ucyR0eE91dCwgZml4ZWQgPSBvcHRpb25zLmZpeGVkLCBORVRXT1JLID0gb3B0aW9ucy5ORVRXT1JLOwogICAgICAgICAgICBkZWZhdWx0VHhTaXplID0gNDAwOwoKICAgICAgICAgICAgaWYgKCFmaXhlZCkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBkZWZhdWx0VHhTaXplKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX3Vuc3BlbnRzOwoKICAgICAgICAgICAgaWYgKF9jb250ZXh0LnQwKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICByZXR1cm4gZmV0Y2hVbnNwZW50cyh7CiAgICAgICAgICAgICAgYWRkcmVzczogYWRkcmVzcywKICAgICAgICAgICAgICBORVRXT1JLOiBORVRXT1JLCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgdW5zcGVudHMgPSBfY29udGV4dC50MDsKICAgICAgICAgICAgdHhJbiA9IHVuc3BlbnRzLmxlbmd0aDsKICAgICAgICAgICAgdHhTaXplID0gdHhJbiA+IDAgPyB0eEluICogMTQ2ICsgdHhPdXQgKiAzMyArICgxNSArIHR4SW4gLSB0eE91dCkgOiBkZWZhdWx0VHhTaXplOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCB0eFNpemUpOwoKICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gY2FsY3VsYXRlVHhTaXplKF94KSB7CiAgICByZXR1cm4gX3JlZjMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7Cgp2YXIgZXN0aW1hdGVGZWVWYWx1ZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWY0ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIob3B0aW9ucykgewogICAgdmFyIF9mZWVSYXRlLCBpblNhdG9zaGlzLCBzcGVlZCwgYWRkcmVzcywgX3R4U2l6ZSwgZml4ZWQsIG1ldGhvZCwgTkVUV09SSywgdHhPdXQsIHR4U2l6ZSwgZmVlUmF0ZSwgY2FsY3VsYXRlZEZlZVZhbHVlLCBmaW5hbEZlZVZhbHVlOwoKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfZmVlUmF0ZSA9IG9wdGlvbnMuZmVlUmF0ZSwgaW5TYXRvc2hpcyA9IG9wdGlvbnMuaW5TYXRvc2hpcywgc3BlZWQgPSBvcHRpb25zLnNwZWVkLCBhZGRyZXNzID0gb3B0aW9ucy5hZGRyZXNzLCBfdHhTaXplID0gb3B0aW9ucy50eFNpemUsIGZpeGVkID0gb3B0aW9ucy5maXhlZCwgbWV0aG9kID0gb3B0aW9ucy5tZXRob2QsIE5FVFdPUksgPSBvcHRpb25zLk5FVFdPUks7CiAgICAgICAgICAgIHR4T3V0ID0gMjsKICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX3R4U2l6ZTsKCiAgICAgICAgICAgIGlmIChfY29udGV4dDIudDApIHsKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNjsKICAgICAgICAgICAgcmV0dXJuIGNhbGN1bGF0ZVR4U2l6ZSh7CiAgICAgICAgICAgICAgYWRkcmVzczogYWRkcmVzcywKICAgICAgICAgICAgICBzcGVlZDogc3BlZWQsCiAgICAgICAgICAgICAgZml4ZWQ6IGZpeGVkLAogICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kLAogICAgICAgICAgICAgIHR4T3V0OiB0eE91dCwKICAgICAgICAgICAgICBORVRXT1JLOiBORVRXT1JLCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICB0eFNpemUgPSBfY29udGV4dDIudDA7CiAgICAgICAgICAgIGZlZVJhdGUgPSBfZmVlUmF0ZSB8fCAzMCAqIDFlMzsgLy8gZmFzdAoKICAgICAgICAgICAgY2FsY3VsYXRlZEZlZVZhbHVlID0gQmlnTnVtYmVyLm1heGltdW0oRFVTVCwgbmV3IEJpZ051bWJlcihmZWVSYXRlKS5tdWx0aXBsaWVkQnkodHhTaXplKS5kaXYoMTAyNCkuZHAoMCwgQmlnTnVtYmVyLlJPVU5EX0hBTEZfRVZFTikpOyAvLyDQmNGB0L/QvtC70YzQt9GD0LXQvCDQutC+0LzQuNGB0YHQuNGOINCx0L7Qu9GM0YjQtSDRgNC10LrQvtC80LXQvdC00L7QstCw0L3QvdC+0Lkg0L3QsCA1INGB0LDRgtC+0YjQuAoKICAgICAgICAgICAgY2FsY3VsYXRlZEZlZVZhbHVlLnBsdXMoMjApOwogICAgICAgICAgICBmaW5hbEZlZVZhbHVlID0gaW5TYXRvc2hpcyA/IGNhbGN1bGF0ZWRGZWVWYWx1ZS50b1N0cmluZygpIDogY2FsY3VsYXRlZEZlZVZhbHVlLm11bHRpcGxpZWRCeSgxZS04KS50b1N0cmluZygpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiTmV4dCB3aXRoZHJhdyBmZWUgc3BlZWQoIi5jb25jYXQoc3BlZWQsICIpIG1ldGhvZCAoIikuY29uY2F0KG1ldGhvZCwgIikgIikuY29uY2F0KGZpbmFsRmVlVmFsdWUpKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIGZpbmFsRmVlVmFsdWUpOwoKICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUyKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiBlc3RpbWF0ZUZlZVZhbHVlKF94MikgewogICAgcmV0dXJuIF9yZWY0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpOwoKdmFyIG5ldHdvcmtzID0gewogIG1haW5uZXQ6IHsKICAgIG1lc3NhZ2VQcmVmaXg6ICdOZXh0Y29pbiBTaWduZWQgTWVzc2FnZTpcbicsCiAgICBiaXAzMjogewogICAgICAicHVibGljIjogMHgwNDg4QjIxRSwKICAgICAgInByaXZhdGUiOiAweDA0ODhBREU0CiAgICB9LAogICAgcHViS2V5SGFzaDogNzUsCiAgICBzY3JpcHRIYXNoOiA1LAogICAgd2lmOiAxMjgKICB9LAogIHRlc3RuZXQ6IHsKICAgIG1lc3NhZ2VQcmVmaXg6ICdOZXh0Y29pbiBTaWduZWQgTWVzc2FnZTpcbicsCiAgICBiaXAzMjogewogICAgICAicHVibGljIjogMHgwNDg4QjIxRSwKICAgICAgInByaXZhdGUiOiAweDA0ODhBREU0CiAgICB9LAogICAgcHViS2V5SGFzaDogNzUsCiAgICBzY3JpcHRIYXNoOiA1LAogICAgd2lmOiAxMjgKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBmZXRjaEJhbGFuY2U6IGZldGNoQmFsYW5jZSwKICBmZXRjaFVuc3BlbnRzOiBmZXRjaFVuc3BlbnRzLAogIGJyb2FkY2FzdFR4OiBicm9hZGNhc3RUeCwKICBmZXRjaFR4OiBmZXRjaFR4LAogIGZldGNoVHhJbmZvOiBmZXRjaFR4SW5mbywKICBjaGVja1dpdGhkcmF3OiBjaGVja1dpdGhkcmF3LAogIGVzdGltYXRlRmVlVmFsdWU6IGVzdGltYXRlRmVlVmFsdWUsCiAgZ2V0Q29yZTogZ2V0Q29yZSwKICBuZXR3b3JrczogbmV0d29ya3MKfTs="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/common/utils/coin/next.ts"],"names":["apiLooper","BigNumber","next","default","TESTNET","MAINNET","DUST","getApiNext","network","name","servers","nextExplorer","getApiCustom","nextExplorerCustom","getCore","fetchBalance","options","address","API_ENDPOINT","NETWORK","get","checkStatus","answer","balance","undefined","e","ignoreErrors","reportErrors","onSuccess","onFail","console","log","then","fetchUnspents","cacheResponse","broadcastTx","txRaw","post","body","rawtx","fetchTx","hash","txId","fees","rest","multipliedBy","fetchTxInfo","hasAdminFee","txInfo_","vin","vout","senderAddress","addr","amount","value","toNumber","afterBalance","adminFee","adminOutput","filter","out","scriptPubKey","addresses","eq","afterOutput","length","txInfo","receiverAddress","confirmed","confirmations","minerFee","dividedBy","minerFeeCurrency","outputs","map","checkWithdraw","scriptAddress","txs","query","res","valueSat","txid","calculateTxSize","speed","_unspents","unspents","txOut","fixed","defaultTxSize","txIn","txSize","estimateFeeValue","_feeRate","feeRate","inSatoshis","_txSize","method","calculatedFeeValue","maximum","div","dp","ROUND_HALF_EVEN","plus","finalFeeValue","toString","networks","mainnet","messagePrefix","bip32","pubKeyHash","scriptHash","wif","testnet"],"mappings":"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","sourcesContent":["\r\nimport apiLooper from '../apiLooper'\r\nimport { BigNumber } from 'bignumber.js'\r\nimport * as next from 'bitcoinjs-lib'\r\n\r\n// Use front API config\r\nimport { default as TESTNET } from '../../../front/config/testnet/api'\r\nimport { default as MAINNET } from '../../../front/config/testnet/api'\r\n\r\nconst DUST = 546\r\n\r\n// Help function - get api by network\r\nconst getApiNext = (network) => {\r\n  return {\r\n    name: `apiNextMain`,\r\n    servers: (network === `MAINNET`)\r\n      ? MAINNET.nextExplorer\r\n      : TESTNET.nextExplorer\r\n  }\r\n}\r\n\r\nconst getApiCustom = (network) => {\r\n  return {\r\n    name: `apiNextCustom`,\r\n    servers: (network === `MAINNET`)\r\n      ? MAINNET.nextExplorerCustom\r\n      : TESTNET.nextExplorerCustom\r\n  }\r\n}\r\n\r\nconst getCore = () => {\r\n  return next\r\n}\r\n\r\nconst fetchBalance = (options) => {\r\n  const {\r\n    address,\r\n    API_ENDPOINT, // nextExplorerCustom\r\n    NETWORK,\r\n  } = options\r\n\r\n\r\n  return apiLooper.get(API_ENDPOINT || getApiNext(NETWORK), `/address/${address}`, {\r\n    checkStatus: (answer) => {\r\n      try {\r\n        if (answer && answer.balance !== undefined) return true\r\n      } catch (e) { /* */ }\r\n      return false\r\n    },\r\n    ignoreErrors: true,\r\n    reportErrors: (answer, onSuccess, onFail) => {\r\n      console.log('>>>> fetchBalance reportErrors')\r\n      console.log(answer)\r\n      onSuccess({ balance: 0 })\r\n      return true\r\n    },\r\n  }).then(({ balance }) => balance)\r\n}\r\n\r\nconst fetchUnspents = (options) => {\r\n  const {\r\n    address,\r\n    API_ENDPOINT, // nextExplorerCustom\r\n    NETWORK,\r\n  } = options\r\n\r\n  return apiLooper.get(API_ENDPOINT || getApiCustom(NETWORK), `/addr/${address}/utxo`, { cacheResponse: 5000 })\r\n}\r\n\r\nconst broadcastTx = (options) => {\r\n  const {\r\n    txRaw,\r\n    API_ENDPOINT, // nextExplorer\r\n    NETWORK,\r\n  } = options\r\n\r\n  return apiLooper.post(API_ENDPOINT || getApiNext(NETWORK), `/sendrawtransaction`, {\r\n    body: {\r\n      rawtx: txRaw,\r\n    },\r\n  })\r\n}\r\n\r\nconst fetchTx = (options) => {\r\n  const {\r\n    hash,\r\n    cacheResponse,\r\n    API_ENDPOINT, // nextExplorer\r\n    NETWORK,\r\n  } = options\r\n\r\n  return apiLooper.get(API_ENDPOINT || getApiNext(NETWORK), `/tx/${hash}`, {\r\n    cacheResponse,\r\n    checkStatus: (answer) => {\r\n      try {\r\n        if (answer && answer.txId !== undefined) return true\r\n      } catch (e) { /* */ }\r\n      return false\r\n    },\r\n  }).then(({ fees, ...rest }) => ({\r\n    fees: new BigNumber(fees).multipliedBy(1e8),\r\n    ...rest,\r\n  }))\r\n}\r\n\r\n/** to-to - in front has mark (not-working) - need recheck, may be will be fixed **/\r\nconst fetchTxInfo = (options) => {\r\n  const {\r\n    hash,\r\n    cacheResponse,\r\n    API_ENDPOINT, // nextExplorer\r\n    hasAdminFee,\r\n    NETWORK,\r\n  } = options\r\n\r\n  return fetchTx({\r\n    hash,\r\n    cacheResponse,\r\n    API_ENDPOINT,\r\n    NETWORK,\r\n  }).then((txInfo_ : any) => {\r\n    return { ...txInfo_ } /** yes - ^^^^ not working - заглужка **/\r\n    const { vin, vout, ...rest } = txInfo_\r\n    const senderAddress = vin ? vin[0].addr : null\r\n    const amount = vout ? new BigNumber(vout[0].value).toNumber() : null\r\n\r\n    let afterBalance = vout && vout[1] ? new BigNumber(vout[1].value).toNumber() : null\r\n    let adminFee: any = false\r\n\r\n    if (hasAdminFee) {\r\n      const adminOutput = vout.filter((out) => (\r\n        out.scriptPubKey.addresses\r\n        && out.scriptPubKey.addresses[0] === hasAdminFee.address\r\n        && !(new BigNumber(out.value).eq(amount))\r\n      ))\r\n\r\n      const afterOutput = vout.filter((out) => (\r\n        out.addresses\r\n        && out.addresses[0] !== hasAdminFee.address\r\n        && out.addresses[0] !== senderAddress\r\n      ))\r\n\r\n      if (afterOutput.length) {\r\n        afterBalance = new BigNumber(afterOutput[0].value).toNumber()\r\n      }\r\n\r\n      if (adminOutput.length) {\r\n        adminFee = new BigNumber(adminOutput[0].value).toNumber()\r\n      }\r\n    }\r\n\r\n    const txInfo = {\r\n      amount,\r\n      afterBalance,\r\n      senderAddress,\r\n      receiverAddress: vout ? vout[0].scriptPubKey.addresses : null,\r\n      confirmed: !!(rest.confirmations),\r\n      minerFee: rest.fees.dividedBy(1e8).toNumber(),\r\n      adminFee,\r\n      minerFeeCurrency: 'NEXT',\r\n      outputs: vout.map((out) => ({\r\n        amount: new BigNumber(out.value).toNumber(),\r\n        address: out.scriptPubKey.addresses || null,\r\n      })),\r\n      ...rest,\r\n    }\r\n\r\n    return txInfo\r\n  })\r\n}\r\n\r\nconst checkWithdraw = (options) => {\r\n  const {\r\n    scriptAddress,\r\n    API_ENDPOINT, // nextExplorerCustom\r\n    NETWORK,\r\n  } = options\r\n\r\n  return apiLooper.get(API_ENDPOINT || getApiCustom(NETWORK), `/txs/${scriptAddress}`, {\r\n    checkStatus: (answer) => {\r\n      try {\r\n        if (answer && answer.txs !== undefined) return true\r\n      } catch (e) { /* */ }\r\n      return false\r\n    },\r\n    query: 'next_balance',\r\n  }).then((res : any) => {\r\n    if (res.txs.length > 1\r\n      && res.txs[0].vout.length\r\n    ) {\r\n      const address = res.txs[0].vout[0].scriptPubKey.addresses[0]\r\n      const amount = res.txs[0].vout[0].valueSat\r\n\r\n      const {\r\n        txid,\r\n      } = res.txs[0]\r\n      return {\r\n        address,\r\n        txid,\r\n        amount,\r\n      }\r\n    }\r\n    return false\r\n  })\r\n}\r\n\r\nconst calculateTxSize = async (options) => {\r\n  const {\r\n    speed,\r\n    unspents: _unspents,\r\n    address,\r\n    txOut = 2,\r\n    fixed,\r\n    NETWORK,\r\n  } = options\r\n\r\n  const defaultTxSize = 400\r\n\r\n  if (fixed) {\r\n    return defaultTxSize\r\n  }\r\n\r\n  const unspents = _unspents || await fetchUnspents({\r\n    address,\r\n    NETWORK,\r\n  })\r\n\r\n\r\n  const txIn = unspents.length\r\n  const txSize = txIn > 0\r\n    ? txIn * 146 + txOut * 33 + (15 + txIn - txOut)\r\n    : defaultTxSize\r\n\r\n  return txSize\r\n}\r\n\r\nconst estimateFeeValue = async (options) => {\r\n  const {\r\n    feeRate: _feeRate,\r\n    inSatoshis,\r\n    speed,\r\n    address,\r\n    txSize: _txSize,\r\n    fixed,\r\n    method,\r\n    NETWORK,\r\n  } = options\r\n\r\n  const txOut = 2\r\n\r\n\r\n  const txSize = _txSize || await calculateTxSize({\r\n    address,\r\n    speed,\r\n    fixed,\r\n    method,\r\n    txOut,\r\n    NETWORK,\r\n  })\r\n\r\n  const feeRate = _feeRate  || 30 * 1e3 // fast\r\n\r\n  const calculatedFeeValue = BigNumber.maximum(\r\n    DUST,\r\n    new BigNumber(feeRate)\r\n      .multipliedBy(txSize)\r\n      .div(1024)\r\n      .dp(0, BigNumber.ROUND_HALF_EVEN),\r\n  )\r\n\r\n  // Используем комиссию больше рекомендованной на 5 сатоши\r\n  calculatedFeeValue.plus(20)\r\n\r\n  const finalFeeValue = inSatoshis\r\n    ? calculatedFeeValue.toString()\r\n    : calculatedFeeValue.multipliedBy(1e-8).toString()\r\n\r\n  console.log(`Next withdraw fee speed(${speed}) method (${method}) ${finalFeeValue}`)\r\n  return finalFeeValue\r\n}\r\n\r\nconst networks = {\r\n  mainnet: {\r\n    messagePrefix: 'Nextcoin Signed Message:\\n',\r\n    bip32: {\r\n      public:  0x0488B21E,\r\n      private: 0x0488ADE4,\r\n    },\r\n    pubKeyHash: 75,\r\n    scriptHash: 5,\r\n    wif: 128,\r\n  },\r\n  testnet: {\r\n    messagePrefix: 'Nextcoin Signed Message:\\n',\r\n    bip32: {\r\n      public:  0x0488B21E,\r\n      private: 0x0488ADE4,\r\n    },\r\n    pubKeyHash: 75,\r\n    scriptHash: 5,\r\n    wif: 128,\r\n  },\r\n}\r\n\r\nexport default {\r\n  fetchBalance,\r\n  fetchUnspents,\r\n  broadcastTx,\r\n  fetchTx,\r\n  fetchTxInfo,\r\n  checkWithdraw,\r\n\r\n  estimateFeeValue,\r\n  getCore,\r\n  networks,\r\n}"]}]}