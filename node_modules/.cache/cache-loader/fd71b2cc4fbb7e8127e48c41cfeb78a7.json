{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\redux\\actions\\ghost.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\redux\\actions\\ghost.ts","mtime":1614852055921},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCi8vIEB0cy1ub2NoZWNrCmltcG9ydCBCaWdJbnRlZ2VyIGZyb20gJ2JpZ2knOwppbXBvcnQgeyBCaWdOdW1iZXIgfSBmcm9tICdiaWdudW1iZXIuanMnOwppbXBvcnQgKiBhcyBiaXRjb2luIGZyb20gJ2JpdGNvaW5qcy1saWInOwppbXBvcnQgKiBhcyBiaXAzOSBmcm9tICdiaXAzOSc7CmltcG9ydCBiaXRjb2luTWVzc2FnZSBmcm9tICdiaXRjb2luanMtbWVzc2FnZSc7CmltcG9ydCB7IGdldFN0YXRlIH0gZnJvbSAncmVkdXgvY29yZSc7CmltcG9ydCByZWR1Y2VycyBmcm9tICdyZWR1eC9jb3JlL3JlZHVjZXJzJzsKaW1wb3J0IHsgZ2hvc3QsIGFwaUxvb3BlciwgY29uc3RhbnRzIH0gZnJvbSAnaGVscGVycyc7CmltcG9ydCBhY3Rpb25zIGZyb20gJ3JlZHV4L2FjdGlvbnMnOwppbXBvcnQgdHlwZWZvcmNlIGZyb20gJ3N3YXAuYXBwL3V0aWwvdHlwZWZvcmNlJzsKaW1wb3J0IGNvbmZpZyBmcm9tICdhcHAtY29uZmlnJzsKCnZhciBiaXRjb3JlID0gcmVxdWlyZSgnZ2hvc3QtYml0Y29yZS1saWInKTsKCmltcG9ydCAqIGFzIG1uZW1vbmljVXRpbHMgZnJvbSAnLi4vLi4vLi4vLi4vY29tbW9uL3V0aWxzL21uZW1vbmljJzsKdmFyIGhhc0FkbWluRmVlID0gY29uZmlnICYmIGNvbmZpZy5vcHRzICYmIGNvbmZpZy5vcHRzLmZlZSAmJiBjb25maWcub3B0cy5mZWUuZ2hvc3QgJiYgY29uZmlnLm9wdHMuZmVlLmdob3N0LmZlZSAmJiBjb25maWcub3B0cy5mZWUuZ2hvc3QuYWRkcmVzcyAmJiBjb25maWcub3B0cy5mZWUuZ2hvc3QubWluID8gY29uZmlnLm9wdHMuZmVlLmdob3N0IDogZmFsc2U7Cgp2YXIgZ2V0UmFuZG9tTW5lbW9uaWNXb3JkcyA9IGZ1bmN0aW9uIGdldFJhbmRvbU1uZW1vbmljV29yZHMoKSB7CiAgcmV0dXJuIGJpcDM5LmdlbmVyYXRlTW5lbW9uaWMoKTsKfTsKCnZhciB2YWxpZGF0ZU1uZW1vbmljV29yZHMgPSBmdW5jdGlvbiB2YWxpZGF0ZU1uZW1vbmljV29yZHMobW5lbW9uaWMpIHsKICByZXR1cm4gYmlwMzkudmFsaWRhdGVNbmVtb25pYyhtbmVtb25pY1V0aWxzLmNvbnZlcnRNbmVtb25pY1RvVmFsaWQobW5lbW9uaWMpKTsKfTsKCnZhciBzd2VlcFRvTW5lbW9uaWMgPSBmdW5jdGlvbiBzd2VlcFRvTW5lbW9uaWMobW5lbW9uaWMsIHBhdGgpIHsKICB2YXIgd2FsbGV0ID0gZ2V0V2FsbGV0QnlXb3JkcyhtbmVtb25pYywgcGF0aCk7CiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY29uc3RhbnRzLnByaXZhdGVLZXlOYW1lcy5naG9zdE1uZW1vbmljLCB3YWxsZXQuV0lGKTsKICByZXR1cm4gd2FsbGV0LldJRjsKfTsKCnZhciBnZXRNYWluUHVibGljS2V5ID0gZnVuY3Rpb24gZ2V0TWFpblB1YmxpY0tleSgpIHsKICB2YXIgX2dldFN0YXRlID0gZ2V0U3RhdGUoKSwKICAgICAgZ2hvc3REYXRhID0gX2dldFN0YXRlLnVzZXIuZ2hvc3REYXRhOwoKICByZXR1cm4gZ2hvc3REYXRhLnB1YmxpY0tleS50b1N0cmluZygnSGV4Jyk7Cn07Cgp2YXIgaXNTd2VlcGVkID0gZnVuY3Rpb24gaXNTd2VlcGVkKCkgewogIHZhciBfZ2V0U3RhdGUyID0gZ2V0U3RhdGUoKSwKICAgICAgX2dldFN0YXRlMiR1c2VyID0gX2dldFN0YXRlMi51c2VyLAogICAgICBnaG9zdERhdGEgPSBfZ2V0U3RhdGUyJHVzZXIuZ2hvc3REYXRhLAogICAgICBnaG9zdE1uZW1vbmljRGF0YSA9IF9nZXRTdGF0ZTIkdXNlci5naG9zdE1uZW1vbmljRGF0YTsKCiAgaWYgKGdob3N0TW5lbW9uaWNEYXRhICYmIGdob3N0TW5lbW9uaWNEYXRhLmFkZHJlc3MgJiYgZ2hvc3REYXRhICYmIGdob3N0RGF0YS5hZGRyZXNzICYmIGdob3N0RGF0YS5hZGRyZXNzLnRvTG93ZXJDYXNlKCkgIT09IGdob3N0TW5lbW9uaWNEYXRhLmFkZHJlc3MudG9Mb3dlckNhc2UoKSkgcmV0dXJuIGZhbHNlOwogIHJldHVybiB0cnVlOwp9OwoKdmFyIGdldFN3ZWVwQWRkcmVzcyA9IGZ1bmN0aW9uIGdldFN3ZWVwQWRkcmVzcygpIHsKICB2YXIgX2dldFN0YXRlMyA9IGdldFN0YXRlKCksCiAgICAgIGdob3N0TW5lbW9uaWNEYXRhID0gX2dldFN0YXRlMy51c2VyLmdob3N0TW5lbW9uaWNEYXRhOwoKICBpZiAoZ2hvc3RNbmVtb25pY0RhdGEgJiYgZ2hvc3RNbmVtb25pY0RhdGEuYWRkcmVzcykgcmV0dXJuIGdob3N0TW5lbW9uaWNEYXRhLmFkZHJlc3M7CiAgcmV0dXJuIGZhbHNlOwp9OwoKdmFyIGdldFdhbGxldEJ5V29yZHMgPSBmdW5jdGlvbiBnZXRXYWxsZXRCeVdvcmRzKG1uZW1vbmljKSB7CiAgdmFyIHdhbGxldE51bWJlciA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogMDsKICB2YXIgcGF0aCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogJyc7CiAgcmV0dXJuIG1uZW1vbmljVXRpbHMuZ2V0R2hvc3RXYWxsZXQoZ2hvc3QubmV0d29yaywgbW5lbW9uaWMsIHdhbGxldE51bWJlciwgcGF0aCk7Cn07Cgp2YXIgYXV0aCA9IGZ1bmN0aW9uIGF1dGgocHJpdmF0ZUtleSkgewogIGlmIChwcml2YXRlS2V5KSB7CiAgICB2YXIgaGFzaCA9IGJpdGNvaW4uY3J5cHRvLnNoYTI1Nihwcml2YXRlS2V5KTsKICAgIHZhciBkID0gQmlnSW50ZWdlci5mcm9tQnVmZmVyKGhhc2gpOwogICAgdmFyIGtleVBhaXIgPSBiaXRjb2luLkVDUGFpci5mcm9tV0lGKHByaXZhdGVLZXksIGdob3N0Lm5ldHdvcmspOwogICAgdmFyIGFjY291bnQgPSBiaXRjb2luLkVDUGFpci5mcm9tV0lGKHByaXZhdGVLZXksIGdob3N0Lm5ldHdvcmspOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCgogICAgdmFyIF9iaXRjb2luJHBheW1lbnRzJHAycCA9IGJpdGNvaW4ucGF5bWVudHMucDJwa2goewogICAgICBwdWJrZXk6IGFjY291bnQucHVibGljS2V5LAogICAgICBuZXR3b3JrOiBnaG9zdC5uZXR3b3JrCiAgICB9KSwKICAgICAgICBhZGRyZXNzID0gX2JpdGNvaW4kcGF5bWVudHMkcDJwLmFkZHJlc3M7CgogICAgdmFyIHB1YmxpY0tleSA9IGFjY291bnQucHVibGljS2V5OwogICAgcmV0dXJuIHsKICAgICAgYWNjb3VudDogYWNjb3VudCwKICAgICAga2V5UGFpcjoga2V5UGFpciwKICAgICAgYWRkcmVzczogYWRkcmVzcywKICAgICAgcHJpdmF0ZUtleTogcHJpdmF0ZUtleSwKICAgICAgcHVibGljS2V5OiBwdWJsaWNLZXkKICAgIH07CiAgfQp9OwoKdmFyIGdldFByaXZhdGVLZXlCeUFkZHJlc3MgPSBmdW5jdGlvbiBnZXRQcml2YXRlS2V5QnlBZGRyZXNzKGFkZHJlc3MpIHsKICB2YXIgX2dldFN0YXRlNCA9IGdldFN0YXRlKCksCiAgICAgIF9nZXRTdGF0ZTQkdXNlciRnaG9zdCA9IF9nZXRTdGF0ZTQudXNlci5naG9zdERhdGEsCiAgICAgIG9sZEFkZHJlc3MgPSBfZ2V0U3RhdGU0JHVzZXIkZ2hvc3QuYWRkcmVzcywKICAgICAgcHJpdmF0ZUtleSA9IF9nZXRTdGF0ZTQkdXNlciRnaG9zdC5wcml2YXRlS2V5OwogIC8qDQogIGNvbnN0IGdob3N0TW5lbW9uaWNEYXRhDQogICAgICBnaG9zdE1uZW1vbmljRGF0YTogew0KICAgICAgICBhZGRyZXNzOiBtbmVtb25pY0FkZHJlc3MsDQogICAgICAgIHByaXZhdGVLZXk6IG1uZW1vbmljS2V5LA0KICAgICAgfSwNCiAgICB9LA0KICB9ID0gZ2V0U3RhdGUoKQ0KICAqLwoKCiAgaWYgKG9sZEFkZHJlc3MgPT09IGFkZHJlc3MpIHJldHVybiBwcml2YXRlS2V5OyAvL0AKCiAgaWYgKG1uZW1vbmljQWRkcmVzcyA9PT0gYWRkcmVzcykgcmV0dXJuIG1uZW1vbmljS2V5Owp9OwoKdmFyIGxvZ2luID0gZnVuY3Rpb24gbG9naW4ocHJpdmF0ZUtleSkgewogIHZhciBtbmVtb25pYyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDsKICB2YXIgbW5lbW9uaWNLZXlzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBudWxsOwogIHZhciBzd2VlcFRvTW5lbW9uaWNSZWFkeSA9IGZhbHNlOwogIGlmIChwcml2YXRlS2V5ICYmIG1uZW1vbmljICYmIG1uZW1vbmljS2V5cyAmJiBtbmVtb25pY0tleXMuZ2hvc3QgPT09IHByaXZhdGVLZXkpIHN3ZWVwVG9NbmVtb25pY1JlYWR5ID0gdHJ1ZTsKICBpZiAoIXByaXZhdGVLZXkgJiYgbW5lbW9uaWMpIHN3ZWVwVG9NbmVtb25pY1JlYWR5ID0gdHJ1ZTsKCiAgaWYgKHByaXZhdGVLZXkpIHsKICAgIHZhciBoYXNoID0gYml0Y29pbi5jcnlwdG8uc2hhMjU2KHByaXZhdGVLZXkpOwogICAgdmFyIGQgPSBCaWdJbnRlZ2VyLmZyb21CdWZmZXIoaGFzaCk7IC8vIGtleVBhaXIgICAgID0gYml0Y29pbi5FQ1BhaXIuZnJvbVdJRihwcml2YXRlS2V5LCBnaG9zdC5uZXR3b3JrKQogIH0gZWxzZSB7CiAgICBjb25zb2xlLmluZm8oJ0NyZWF0ZWQgYWNjb3VudCBHaG9zdCAuLi4nKTsgLy8ga2V5UGFpciAgICAgPSBiaXRjb2luLkVDUGFpci5tYWtlUmFuZG9tKHsgbmV0d29yazogZ2hvc3QubmV0d29yayB9KQogICAgLy8gcHJpdmF0ZUtleSAgPSBrZXlQYWlyLnRvV0lGKCkKICAgIC8vIHVzZSByYW5kb20gMTIgd29yZHMKCiAgICBpZiAoIW1uZW1vbmljKSBtbmVtb25pYyA9IGJpcDM5LmdlbmVyYXRlTW5lbW9uaWMoKTsKICAgIHZhciBhY2NEYXRhID0gZ2V0V2FsbGV0QnlXb3JkcyhtbmVtb25pYyk7CiAgICBjb25zb2xlLmxvZygnR2hvc3QuIEdlbmVyYXRlZCB3YWxsZXQgZnJvbSByYW5kb20gMTIgd29yZHMnKTsKICAgIGNvbnNvbGUubG9nKGFjY0RhdGEpOwogICAgcHJpdmF0ZUtleSA9IGFjY0RhdGEuV0lGOwogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY29uc3RhbnRzLnByaXZhdGVLZXlOYW1lcy5naG9zdE1uZW1vbmljLCBwcml2YXRlS2V5KTsKICB9CgogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGNvbnN0YW50cy5wcml2YXRlS2V5TmFtZXMuZ2hvc3QsIHByaXZhdGVLZXkpOwoKICB2YXIgZGF0YSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgYXV0aChwcml2YXRlS2V5KSksIHt9LCB7CiAgICBpc01uZW1vbmljOiBzd2VlcFRvTW5lbW9uaWNSZWFkeSwKICAgIGN1cnJlbmN5OiAnR0hPU1QnLAogICAgZnVsbE5hbWU6ICdnaG9zdCcKICB9KTsKCiAgd2luZG93LmdldEdob3N0QWRkcmVzcyA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBkYXRhLmFkZHJlc3M7CiAgfTsKCiAgd2luZG93LmdldEdob3N0RGF0YSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBkYXRhOwogIH07CgogIGNvbnNvbGUuaW5mbygnTG9nZ2VkIGluIHdpdGggR2hvc3QnLCBkYXRhKTsKICByZWR1Y2Vycy51c2VyLnNldEF1dGhEYXRhKHsKICAgIG5hbWU6ICdnaG9zdERhdGEnLAogICAgZGF0YTogZGF0YQogIH0pOwoKICBpZiAoIXN3ZWVwVG9NbmVtb25pY1JlYWR5KSB7CiAgICAvLyBBdXRoIHdpdGggb3VyIG1uZW1vbmljIGFjY291bnQKICAgIGlmIChtbmVtb25pYyA9PT0gIi0iKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N3ZWVwLiBDYW50IGF1dGguIE5lZWQgbmV3IG1uZW1vbmljIG9yIGVudGVyIG93biBmb3IgcmUtbG9naW4nKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICghbW5lbW9uaWNLZXlzIHx8ICFtbmVtb25pY0tleXMuZ2hvc3QpIHsKICAgICAgY29uc29sZS5lcnJvcignU3dlZXAuIENhbnQgYXV0aC4gTG9naW4ga2V5IHVuZGVmaW5lZCcpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIG1uZW1vbmljRGF0YSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgYXV0aChtbmVtb25pY0tleXMuZ2hvc3QpKSwge30sIHsKICAgICAgaXNNbmVtb25pYzogdHJ1ZQogICAgfSk7CgogICAgY29uc29sZS5pbmZvKCdMb2dnZWQgaW4gd2l0aCBHaG9zdCBNbmVtb25pYycsIG1uZW1vbmljRGF0YSk7CiAgICByZWR1Y2Vycy51c2VyLmFkZFdhbGxldCh7CiAgICAgIG5hbWU6ICdnaG9zdE1uZW1vbmljRGF0YScsCiAgICAgIGRhdGE6IF9vYmplY3RTcHJlYWQoewogICAgICAgIGN1cnJlbmN5OiAnR0hPU1QnLAogICAgICAgIGZ1bGxOYW1lOiAnR2hvc3QgKE5ldyknLAogICAgICAgIGJhbGFuY2U6IDAsCiAgICAgICAgaXNCYWxhbmNlRmV0Y2hlZDogZmFsc2UsCiAgICAgICAgYmFsYW5jZUVycm9yOiBudWxsLAogICAgICAgIGluZm9BYm91dEN1cnJlbmN5OiBudWxsCiAgICAgIH0sIG1uZW1vbmljRGF0YSkKICAgIH0pOwogICAgbmV3IFByb21pc2UoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShyZXNvbHZlKSB7CiAgICAgICAgdmFyIGJhbGFuY2VEYXRhOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBmZXRjaEJhbGFuY2VTdGF0dXMobW5lbW9uaWNEYXRhLmFkZHJlc3MpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBiYWxhbmNlRGF0YSA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKGJhbGFuY2VEYXRhKSB7CiAgICAgICAgICAgICAgICAgIHJlZHVjZXJzLnVzZXIuc2V0QXV0aERhdGEoewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdnaG9zdE1uZW1vbmljRGF0YScsCiAgICAgICAgICAgICAgICAgICAgZGF0YTogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBiYWxhbmNlRGF0YSksIHt9LCB7CiAgICAgICAgICAgICAgICAgICAgICBpc0JhbGFuY2VGZXRjaGVkOiB0cnVlCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICByZWR1Y2Vycy51c2VyLnNldEJhbGFuY2VFcnJvcih7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2dob3N0TW5lbW9uaWNEYXRhJwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9KCkpOwogIH0KCiAgcmV0dXJuIHByaXZhdGVLZXk7Cn07Cgp2YXIgZ2V0VHggPSBmdW5jdGlvbiBnZXRUeCh0eFJhdykgewogIGlmICh0eFJhdyAmJiB0eFJhdy5nZXRJZCAvL0AKICAmJiB0eFJhdy5nZXRJZCBpbnN0YW5jZW9mICdmdW5jdGlvbicpIHsKICAgIHJldHVybiB0eFJhdy5nZXRJZCgpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdHhSYXc7CiAgfQp9OwoKdmFyIGdldFR4Um91dGVyID0gZnVuY3Rpb24gZ2V0VHhSb3V0ZXIodHhJZCkgewogIHJldHVybiAiL2dob3N0L3R4LyIuY29uY2F0KHR4SWQpOwp9OwoKdmFyIGdldExpbmtUb0luZm8gPSBmdW5jdGlvbiBnZXRMaW5rVG9JbmZvKHR4KSB7CiAgaWYgKCF0eCkgewogICAgcmV0dXJuOwogIH0KCiAgcmV0dXJuICIiLmNvbmNhdChjb25maWcubGluay5naG9zdHNjYW4sICIvdHgvIikuY29uY2F0KHR4KTsKfTsKCnZhciBmZXRjaEJhbGFuY2VTdGF0dXMgPSBmdW5jdGlvbiBmZXRjaEJhbGFuY2VTdGF0dXMoYWRkcmVzcykgewogIHJldHVybiBhcGlMb29wZXIuZ2V0KCdnaG9zdHNjYW4nLCAiL2FkZHIvIi5jb25jYXQoYWRkcmVzcyksIHsKICAgIGNoZWNrU3RhdHVzOiBmdW5jdGlvbiBjaGVja1N0YXR1cyhhbnN3ZXIpIHsKICAgICAgdHJ5IHsKICAgICAgICBpZiAoYW5zd2VyICYmIGFuc3dlci5iYWxhbmNlICE9PSB1bmRlZmluZWQpIHJldHVybiB0cnVlOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgLyogKi8KICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0pLnRoZW4oZnVuY3Rpb24gKF9yZWYyKSB7CiAgICB2YXIgYmFsYW5jZSA9IF9yZWYyLmJhbGFuY2UsCiAgICAgICAgdW5jb25maXJtZWRCYWxhbmNlID0gX3JlZjIudW5jb25maXJtZWRCYWxhbmNlOwogICAgcmV0dXJuIHsKICAgICAgYWRkcmVzczogYWRkcmVzcywKICAgICAgYmFsYW5jZTogYmFsYW5jZSwKICAgICAgdW5jb25maXJtZWRCYWxhbmNlOiB1bmNvbmZpcm1lZEJhbGFuY2UKICAgIH07CiAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGUpIHsKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfTsKCnZhciBnZXRCYWxhbmNlID0gZnVuY3Rpb24gZ2V0QmFsYW5jZSgpIHsKICB2YXIgX2dldFN0YXRlNSA9IGdldFN0YXRlKCksCiAgICAgIGFkZHJlc3MgPSBfZ2V0U3RhdGU1LnVzZXIuZ2hvc3REYXRhLmFkZHJlc3M7CgogIHJldHVybiBhcGlMb29wZXIuZ2V0KCdnaG9zdHNjYW4nLCAiL2FkZHIvIi5jb25jYXQoYWRkcmVzcyksIHsKICAgIGluUXVlcnk6IHsKICAgICAgZGVsYXk6IDUwMCwKICAgICAgbmFtZTogImJhbGFuY2UiCiAgICB9LAogICAgY2hlY2tTdGF0dXM6IGZ1bmN0aW9uIGNoZWNrU3RhdHVzKGFuc3dlcikgewogICAgICB0cnkgewogICAgICAgIGlmIChhbnN3ZXIgJiYgYW5zd2VyLmJhbGFuY2UgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWU7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvKiAqLwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSkudGhlbihmdW5jdGlvbiAoX3JlZjMpIHsKICAgIHZhciBiYWxhbmNlID0gX3JlZjMuYmFsYW5jZSwKICAgICAgICB1bmNvbmZpcm1lZEJhbGFuY2UgPSBfcmVmMy51bmNvbmZpcm1lZEJhbGFuY2U7CiAgICBjb25zb2xlLmxvZygnR0hPU1QgQmFsYW5jZTogJywgYmFsYW5jZSk7CiAgICBjb25zb2xlLmxvZygnR0hPU1QgdW5jb25maXJtZWRCYWxhbmNlIEJhbGFuY2U6ICcsIHVuY29uZmlybWVkQmFsYW5jZSk7CiAgICByZWR1Y2Vycy51c2VyLnNldEJhbGFuY2UoewogICAgICBuYW1lOiAnZ2hvc3REYXRhJywKICAgICAgYW1vdW50OiBiYWxhbmNlLAogICAgICB1bmNvbmZpcm1lZEJhbGFuY2U6IHVuY29uZmlybWVkQmFsYW5jZQogICAgfSk7CiAgICByZXR1cm4gYmFsYW5jZTsKICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZSkgewogICAgcmVkdWNlcnMudXNlci5zZXRCYWxhbmNlRXJyb3IoewogICAgICBuYW1lOiAnZ2hvc3REYXRhJwogICAgfSk7CiAgfSk7Cn07Cgp2YXIgZmV0Y2hCYWxhbmNlID0gZnVuY3Rpb24gZmV0Y2hCYWxhbmNlKGFkZHJlc3MpIHsKICByZXR1cm4gYXBpTG9vcGVyLmdldCgnZ2hvc3RzY2FuJywgIi9hZGRyLyIuY29uY2F0KGFkZHJlc3MpLCB7CiAgICBjaGVja1N0YXR1czogZnVuY3Rpb24gY2hlY2tTdGF0dXMoYW5zd2VyKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKGFuc3dlciAmJiBhbnN3ZXIuYmFsYW5jZSAhPT0gdW5kZWZpbmVkKSByZXR1cm4gdHJ1ZTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIC8qICovCiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9KS50aGVuKGZ1bmN0aW9uIChfcmVmNCkgewogICAgdmFyIGJhbGFuY2UgPSBfcmVmNC5iYWxhbmNlOwogICAgcmV0dXJuIGJhbGFuY2U7CiAgfSk7Cn07Cgp2YXIgZmV0Y2hUeCA9IGZ1bmN0aW9uIGZldGNoVHgoaGFzaCwgY2FjaGVSZXNwb25zZSkgewogIHJldHVybiBhcGlMb29wZXIuZ2V0KCdnaG9zdHNjYW4nLCAiL3R4LyIuY29uY2F0KGhhc2gpLCB7CiAgICBjYWNoZVJlc3BvbnNlOiBjYWNoZVJlc3BvbnNlLAogICAgY2hlY2tTdGF0dXM6IGZ1bmN0aW9uIGNoZWNrU3RhdHVzKGFuc3dlcikgewogICAgICB0cnkgewogICAgICAgIGlmIChhbnN3ZXIgJiYgYW5zd2VyLmZlZXMgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWU7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSkudGhlbihmdW5jdGlvbiAoX3JlZjUpIHsKICAgIHZhciBmZWVzID0gX3JlZjUuZmVlcywKICAgICAgICByZXN0ID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKF9yZWY1LCBbImZlZXMiXSk7CgogICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoewogICAgICBmZWVzOiBuZXcgQmlnTnVtYmVyKGZlZXMpLm11bHRpcGxpZWRCeSgxZTgpCiAgICB9LCByZXN0KTsKICB9KTsKfTsKCnZhciBmZXRjaFR4UmF3ID0gZnVuY3Rpb24gZmV0Y2hUeFJhdyh0eElkLCBjYWNoZVJlc3BvbnNlKSB7CiAgcmV0dXJuIGFwaUxvb3Blci5nZXQoJ2dob3N0c2NhbicsICIvcmF3dHgvIi5jb25jYXQodHhJZCksIHsKICAgIGNhY2hlUmVzcG9uc2U6IGNhY2hlUmVzcG9uc2UsCiAgICBjaGVja1N0YXR1czogZnVuY3Rpb24gY2hlY2tTdGF0dXMoYW5zd2VyKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKGFuc3dlciAmJiBhbnN3ZXIucmF3dHggIT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWU7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSkudGhlbihmdW5jdGlvbiAoX3JlZjYpIHsKICAgIHZhciByYXd0eCA9IF9yZWY2LnJhd3R4OwogICAgcmV0dXJuIHJhd3R4OwogIH0pOwp9OwoKdmFyIGZldGNoVHhJbmZvID0gZnVuY3Rpb24gZmV0Y2hUeEluZm8oaGFzaCwgY2FjaGVSZXNwb25zZSkgewogIHJldHVybiBmZXRjaFR4KGhhc2gsIGNhY2hlUmVzcG9uc2UpLnRoZW4oZnVuY3Rpb24gKF9yZWY3KSB7CiAgICB2YXIgdmluID0gX3JlZjcudmluLAogICAgICAgIHZvdXQgPSBfcmVmNy52b3V0LAogICAgICAgIHJlc3QgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoX3JlZjcsIFsidmluIiwgInZvdXQiXSk7CgogICAgdmFyIHNlbmRlckFkZHJlc3MgPSB2aW4gPyB2aW5bMF0uYWRkciA6IG51bGw7CiAgICB2YXIgYW1vdW50ID0gdm91dCA/IG5ldyBCaWdOdW1iZXIodm91dFswXS52YWx1ZSkudG9OdW1iZXIoKSA6IG51bGw7CiAgICB2YXIgYWZ0ZXJCYWxhbmNlID0gdm91dCAmJiB2b3V0WzFdID8gbmV3IEJpZ051bWJlcih2b3V0WzFdLnZhbHVlKS50b051bWJlcigpIDogbnVsbDsKICAgIHZhciBhZG1pbkZlZSA9IGZhbHNlOwoKICAgIGlmIChoYXNBZG1pbkZlZSkgewogICAgICB2YXIgYWRtaW5PdXRwdXQgPSB2b3V0LmZpbHRlcihmdW5jdGlvbiAob3V0KSB7CiAgICAgICAgcmV0dXJuIG91dC5zY3JpcHRQdWJLZXkuYWRkcmVzc2VzICYmIG91dC5zY3JpcHRQdWJLZXkuYWRkcmVzc2VzWzBdID09PSBoYXNBZG1pbkZlZS5hZGRyZXNzICYmICFuZXcgQmlnTnVtYmVyKG91dC52YWx1ZSkuZXEoYW1vdW50KTsKICAgICAgfSk7CiAgICAgIHZhciBhZnRlck91dHB1dCA9IHZvdXQuZmlsdGVyKGZ1bmN0aW9uIChvdXQpIHsKICAgICAgICByZXR1cm4gb3V0LmFkZHJlc3NlcyAmJiBvdXQuYWRkcmVzc2VzWzBdICE9PSBoYXNBZG1pbkZlZS5hZGRyZXNzICYmIG91dC5hZGRyZXNzZXNbMF0gIT09IHNlbmRlckFkZHJlc3M7CiAgICAgIH0pOwoKICAgICAgaWYgKGFmdGVyT3V0cHV0Lmxlbmd0aCkgewogICAgICAgIGFmdGVyQmFsYW5jZSA9IG5ldyBCaWdOdW1iZXIoYWZ0ZXJPdXRwdXRbMF0udmFsdWUpLnRvTnVtYmVyKCk7CiAgICAgIH0KCiAgICAgIGlmIChhZG1pbk91dHB1dC5sZW5ndGgpIHsKICAgICAgICBhZG1pbkZlZSA9IG5ldyBCaWdOdW1iZXIoYWRtaW5PdXRwdXRbMF0udmFsdWUpLnRvTnVtYmVyKCk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgdHhJbmZvID0gX29iamVjdFNwcmVhZCh7CiAgICAgIGFtb3VudDogYW1vdW50LAogICAgICBhZnRlckJhbGFuY2U6IGFmdGVyQmFsYW5jZSwKICAgICAgc2VuZGVyQWRkcmVzczogc2VuZGVyQWRkcmVzcywKICAgICAgcmVjZWl2ZXJBZGRyZXNzOiB2b3V0ID8gdm91dFswXS5zY3JpcHRQdWJLZXkuYWRkcmVzc2VzIDogbnVsbCwKICAgICAgY29uZmlybWVkOiAhIXJlc3QuY29uZmlybWF0aW9ucywKICAgICAgbWluZXJGZWU6IHJlc3QuZmVlcy5kaXZpZGVkQnkoMWU4KS50b051bWJlcigpLAogICAgICBhZG1pbkZlZTogYWRtaW5GZWUsCiAgICAgIG1pbmVyRmVlQ3VycmVuY3k6ICdHSE9TVCcsCiAgICAgIG91dHB1dHM6IHZvdXQubWFwKGZ1bmN0aW9uIChvdXQpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgYW1vdW50OiBuZXcgQmlnTnVtYmVyKG91dC52YWx1ZSkudG9OdW1iZXIoKSwKICAgICAgICAgIGFkZHJlc3M6IG91dC5zY3JpcHRQdWJLZXkuYWRkcmVzc2VzIHx8IG51bGwKICAgICAgICB9OwogICAgICB9KQogICAgfSwgcmVzdCk7CgogICAgcmV0dXJuIHR4SW5mbzsKICB9KTsKfTsKCnZhciBnZXRJbnZvaWNlcyA9IGZ1bmN0aW9uIGdldEludm9pY2VzKGFkZHJlc3MpIHsKICB2YXIgX2dldFN0YXRlNiA9IGdldFN0YXRlKCksCiAgICAgIHVzZXJBZGRyZXNzID0gX2dldFN0YXRlNi51c2VyLmdob3N0RGF0YS51c2VyQWRkcmVzczsKCiAgYWRkcmVzcyA9IGFkZHJlc3MgfHwgdXNlckFkZHJlc3M7CiAgcmV0dXJuIGFjdGlvbnMuaW52b2ljZXMuZ2V0SW52b2ljZXMoewogICAgY3VycmVuY3k6ICdHSE9TVCcsCiAgICBhZGRyZXNzOiBhZGRyZXNzCiAgfSk7Cn07Cgp2YXIgZ2V0QWxsTXlBZGRyZXNzZXMgPSBmdW5jdGlvbiBnZXRBbGxNeUFkZHJlc3NlcygpIHsKICB2YXIgX2dldFN0YXRlNyA9IGdldFN0YXRlKCksCiAgICAgIF9nZXRTdGF0ZTckdXNlciA9IF9nZXRTdGF0ZTcudXNlciwKICAgICAgZ2hvc3REYXRhID0gX2dldFN0YXRlNyR1c2VyLmdob3N0RGF0YSwKICAgICAgZ2hvc3RNbmVtb25pY0RhdGEgPSBfZ2V0U3RhdGU3JHVzZXIuZ2hvc3RNbmVtb25pY0RhdGEsCiAgICAgIGdob3N0TXVsdGlzaWdTTVNEYXRhID0gX2dldFN0YXRlNyR1c2VyLmdob3N0TXVsdGlzaWdTTVNEYXRhLAogICAgICBnaG9zdE11bHRpc2lnVXNlckRhdGEgPSBfZ2V0U3RhdGU3JHVzZXIuZ2hvc3RNdWx0aXNpZ1VzZXJEYXRhLAogICAgICBnaG9zdE11bHRpc2lnRzJGQURhdGEgPSBfZ2V0U3RhdGU3JHVzZXIuZ2hvc3RNdWx0aXNpZ0cyRkFEYXRhLAogICAgICBnaG9zdE11bHRpc2lnUGluRGF0YSA9IF9nZXRTdGF0ZTckdXNlci5naG9zdE11bHRpc2lnUGluRGF0YTsKCiAgdmFyIHJldERhdGEgPSBbXTsgLy8g0J/RgNC+0LLQtdGA0Y/QtdC8LCDQsdGL0Lsg0LvQuCBzd2VlcAoKICBpZiAoZ2hvc3RNbmVtb25pY0RhdGEgJiYgZ2hvc3RNbmVtb25pY0RhdGEuYWRkcmVzcyAmJiBnaG9zdERhdGEgJiYgZ2hvc3REYXRhLmFkZHJlc3MgJiYgZ2hvc3RNbmVtb25pY0RhdGEuYWRkcmVzcyAhPT0gZ2hvc3REYXRhLmFkZHJlc3MpIHsKICAgIHJldERhdGEucHVzaChnaG9zdE1uZW1vbmljRGF0YS5hZGRyZXNzLnRvTG93ZXJDYXNlKCkpOwogIH0KCiAgcmV0RGF0YS5wdXNoKGdob3N0RGF0YS5hZGRyZXNzLnRvTG93ZXJDYXNlKCkpOwogIGlmIChnaG9zdE11bHRpc2lnU01TRGF0YSAmJiBnaG9zdE11bHRpc2lnU01TRGF0YS5hZGRyZXNzKSByZXREYXRhLnB1c2goZ2hvc3RNdWx0aXNpZ1NNU0RhdGEuYWRkcmVzcy50b0xvd2VyQ2FzZSgpKTsgLy8gQFRvRG8gLSBTTVMgTXVsdGlXYWxsZXQKCiAgaWYgKGdob3N0TXVsdGlzaWdVc2VyRGF0YSAmJiBnaG9zdE11bHRpc2lnVXNlckRhdGEuYWRkcmVzcykgcmV0RGF0YS5wdXNoKGdob3N0TXVsdGlzaWdVc2VyRGF0YS5hZGRyZXNzLnRvTG93ZXJDYXNlKCkpOwoKICBpZiAoZ2hvc3RNdWx0aXNpZ1VzZXJEYXRhICYmIGdob3N0TXVsdGlzaWdVc2VyRGF0YS53YWxsZXRzICYmIGdob3N0TXVsdGlzaWdVc2VyRGF0YS53YWxsZXRzLmxlbmd0aCkgewogICAgZ2hvc3RNdWx0aXNpZ1VzZXJEYXRhLndhbGxldHMubWFwKGZ1bmN0aW9uICh3YWxsZXQpIHsKICAgICAgcmV0RGF0YS5wdXNoKHdhbGxldC5hZGRyZXNzLnRvTG93ZXJDYXNlKCkpOwogICAgfSk7CiAgfQoKICBpZiAoZ2hvc3RNdWx0aXNpZ1BpbkRhdGEgJiYgZ2hvc3RNdWx0aXNpZ1BpbkRhdGEuYWRkcmVzcykgcmV0RGF0YS5wdXNoKGdob3N0TXVsdGlzaWdQaW5EYXRhLmFkZHJlc3MudG9Mb3dlckNhc2UoKSk7CiAgcmV0dXJuIHJldERhdGE7Cn07Cgp2YXIgZ2V0RGF0YUJ5QWRkcmVzcyA9IGZ1bmN0aW9uIGdldERhdGFCeUFkZHJlc3MoYWRkcmVzcykgewogIHZhciBfZ2V0U3RhdGU4ID0gZ2V0U3RhdGUoKSwKICAgICAgX2dldFN0YXRlOCR1c2VyID0gX2dldFN0YXRlOC51c2VyLAogICAgICBnaG9zdERhdGEgPSBfZ2V0U3RhdGU4JHVzZXIuZ2hvc3REYXRhLAogICAgICBnaG9zdE1uZW1vbmljRGF0YSA9IF9nZXRTdGF0ZTgkdXNlci5naG9zdE1uZW1vbmljRGF0YSwKICAgICAgZ2hvc3RNdWx0aXNpZ1NNU0RhdGEgPSBfZ2V0U3RhdGU4JHVzZXIuZ2hvc3RNdWx0aXNpZ1NNU0RhdGEsCiAgICAgIGdob3N0TXVsdGlzaWdVc2VyRGF0YSA9IF9nZXRTdGF0ZTgkdXNlci5naG9zdE11bHRpc2lnVXNlckRhdGEsCiAgICAgIGdob3N0TXVsdGlzaWdHMkZBRGF0YSA9IF9nZXRTdGF0ZTgkdXNlci5naG9zdE11bHRpc2lnRzJGQURhdGE7CgogIHZhciBmb3VuZGVkID0gW2dob3N0RGF0YSwgZ2hvc3RNbmVtb25pY0RhdGEsIGdob3N0TXVsdGlzaWdTTVNEYXRhLCBnaG9zdE11bHRpc2lnVXNlckRhdGFdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoZ2hvc3RNdWx0aXNpZ1VzZXJEYXRhICYmIGdob3N0TXVsdGlzaWdVc2VyRGF0YS53YWxsZXRzICYmIGdob3N0TXVsdGlzaWdVc2VyRGF0YS53YWxsZXRzLmxlbmd0aCA/IGdob3N0TXVsdGlzaWdVc2VyRGF0YS53YWxsZXRzIDogW10pLCBbZ2hvc3RNdWx0aXNpZ0cyRkFEYXRhXSkuZmlsdGVyKGZ1bmN0aW9uIChkYXRhKSB7CiAgICByZXR1cm4gZGF0YSAmJiBkYXRhLmFkZHJlc3MgJiYgZGF0YS5hZGRyZXNzLnRvTG93ZXJDYXNlKCkgPT09IGFkZHJlc3MudG9Mb3dlckNhc2UoKTsKICB9KTsKICByZXR1cm4gZm91bmRlZC5sZW5ndGggPyBmb3VuZGVkWzBdIDogZmFsc2U7Cn07Cgp2YXIgZ2V0VHJhbnNhY3Rpb24gPSBmdW5jdGlvbiBnZXRUcmFuc2FjdGlvbigpIHsKICB2YXIgYWRkcmVzcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogIiI7CiAgdmFyIG93blR5cGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6ICIiOwogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgdmFyIG15QWxsV2FsbGV0cyA9IGdldEFsbE15QWRkcmVzc2VzKCk7CgogICAgdmFyIF9nZXRTdGF0ZTkgPSBnZXRTdGF0ZSgpLAogICAgICAgIHVzZXJBZGRyZXNzID0gX2dldFN0YXRlOS51c2VyLmdob3N0RGF0YS5hZGRyZXNzOwoKICAgIGFkZHJlc3MgPSBhZGRyZXNzIHx8IHVzZXJBZGRyZXNzOwogICAgdmFyIHR5cGUgPSBvd25UeXBlIHx8ICdnaG9zdCc7CgogICAgaWYgKCF0eXBlZm9yY2UuaXNDb2luQWRkcmVzcy5HSE9TVChhZGRyZXNzKSkgewogICAgICByZXNvbHZlKFtdKTsKICAgIH0KCiAgICB2YXIgdXJsID0gIi90eHMvP2FkZHJlc3M9Ii5jb25jYXQoYWRkcmVzcyk7CiAgICByZXR1cm4gYXBpTG9vcGVyLmdldCgnZ2hvc3RzY2FuJywgdXJsLCB7CiAgICAgIGNoZWNrU3RhdHVzOiBmdW5jdGlvbiBjaGVja1N0YXR1cyhhbnN3ZXIpIHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKGFuc3dlciAmJiBhbnN3ZXIudHhzICE9PSB1bmRlZmluZWQpIHJldHVybiB0cnVlOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIC8qICovCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0sCiAgICAgIHF1ZXJ5OiAnZ2hvc3RfYmFsYW5jZScKICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICB2YXIgdHJhbnNhY3Rpb25zID0gcmVzLnR4cy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICB2YXIgZGlyZWN0aW9uID0gaXRlbS52aW5bMF0uYWRkciAhPT0gYWRkcmVzcyA/ICdpbicgOiAnb3V0JzsKICAgICAgICB2YXIgaXNTZWxmID0gZGlyZWN0aW9uID09PSAnb3V0JyAmJiBpdGVtLnZvdXQuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gaXRlbS5zY3JpcHRQdWJLZXkuYWRkcmVzc2VzWzBdID09PSBhZGRyZXNzOwogICAgICAgIH0pLmxlbmd0aCA9PT0gaXRlbS52b3V0Lmxlbmd0aDsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdHlwZTogdHlwZSwKICAgICAgICAgIGhhc2g6IGl0ZW0udHhpZCwKICAgICAgICAgIGNhbkVkaXQ6IG15QWxsV2FsbGV0cy5pbmRleE9mKGFkZHJlc3MpICE9PSAtMSwKICAgICAgICAgIGNvbmZpcm1hdGlvbnM6IGl0ZW0uY29uZmlybWF0aW9ucywKICAgICAgICAgIHZhbHVlOiBpc1NlbGYgPyBpdGVtLmZlZXMgOiBpdGVtLnZvdXQuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIGlmICghaXRlbS5zY3JpcHRQdWJLZXkuYWRkcmVzc2VzKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIHZhciBjdXJyZW50QWRkcmVzcyA9IGl0ZW0uc2NyaXB0UHViS2V5LmFkZHJlc3Nlc1swXTsKICAgICAgICAgICAgcmV0dXJuIGRpcmVjdGlvbiA9PT0gJ2luJyA/IGN1cnJlbnRBZGRyZXNzID09PSBhZGRyZXNzIDogY3VycmVudEFkZHJlc3MgIT09IGFkZHJlc3M7CiAgICAgICAgICB9KVswXS52YWx1ZSwKICAgICAgICAgIGRhdGU6IGl0ZW0udGltZSAqIDEwMDAsCiAgICAgICAgICBkaXJlY3Rpb246IGlzU2VsZiA/ICdzZWxmJyA6IGRpcmVjdGlvbgogICAgICAgIH07CiAgICAgIH0pOwogICAgICByZXNvbHZlKHRyYW5zYWN0aW9ucyk7CiAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoKSB7CiAgICAgIHJlc29sdmUoW10pOwogICAgfSk7CiAgfSk7Cn07Cgp2YXIgc2VuZCA9IGZ1bmN0aW9uIHNlbmQoZGF0YSkgewogIHJldHVybiBzZW5kQml0Y29yZShkYXRhKTsKfTsgLy9ACgoKdmFyIHNlbmRCaXRjb3JlID0gZnVuY3Rpb24gc2VuZEJpdGNvcmUoKSB7CiAgdmFyIF9yZWY4ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fSwKICAgICAgZnJvbSA9IF9yZWY4LmZyb20sCiAgICAgIHRvID0gX3JlZjgudG8sCiAgICAgIGFtb3VudCA9IF9yZWY4LmFtb3VudCwKICAgICAgZmVlVmFsdWUgPSBfcmVmOC5mZWVWYWx1ZSwKICAgICAgc3BlZWQgPSBfcmVmOC5zcGVlZDsKCiAgcmV0dXJuIG5ldyBQcm9taXNlKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgdmFyIF9yZWY5ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIocmVhZHkpIHsKICAgICAgdmFyIHByaXZLZXksIHVuc3BlbnRzLCBmdW5kVmFsdWUsIHRyYW5zYWN0aW9uLCBicm9hZGNhc3RBbnN3ZXIsIHR4aWQ7CiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHByaXZLZXkgPSBnZXRQcml2YXRlS2V5QnlBZGRyZXNzKGZyb20pOwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICByZXR1cm4gZmV0Y2hVbnNwZW50cyhmcm9tKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICB1bnNwZW50cyA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgIGZ1bmRWYWx1ZSA9IG5ldyBCaWdOdW1iZXIoU3RyaW5nKGFtb3VudCkpLm11bHRpcGxpZWRCeSgxZTgpLmludGVnZXJWYWx1ZSgpLnRvTnVtYmVyKCk7CiAgICAgICAgICAgICAgdHJhbnNhY3Rpb24gPSBuZXcgYml0Y29yZS5UcmFuc2FjdGlvbigpLmZyb20odW5zcGVudHMpIC8vIEZlZWQgaW5mb3JtYXRpb24gYWJvdXQgd2hhdCB1bnNwZW50IG91dHB1dHMgb25lIGNhbiB1c2UKICAgICAgICAgICAgICAudG8odG8sIGZ1bmRWYWx1ZSkgLy8gQWRkIGFuIG91dHB1dCB3aXRoIHRoZSBnaXZlbiBhbW91bnQgb2Ygc2F0b3NoaXMKICAgICAgICAgICAgICAuY2hhbmdlKGZyb20pIC8vIFNldHMgdXAgYSBjaGFuZ2UgYWRkcmVzcyB3aGVyZSB0aGUgcmVzdCBvZiB0aGUgZnVuZHMgd2lsbCBnbwogICAgICAgICAgICAgIC5zaWduKHByaXZLZXkpOyAvLyBTaWducyBhbGwgdGhlIGlucHV0cyBpdCBjYW4qLwoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDg7CiAgICAgICAgICAgICAgcmV0dXJuIGJyb2FkY2FzdFR4KFN0cmluZyh0cmFuc2FjdGlvbi5zZXJpYWxpemUoKSkpOwoKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGJyb2FkY2FzdEFuc3dlciA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgIHR4aWQgPSBicm9hZGNhc3RBbnN3ZXIudHhpZDsKICAgICAgICAgICAgICByZWFkeSh0eGlkKTsKCiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlMik7CiAgICB9KSk7CgogICAgcmV0dXJuIGZ1bmN0aW9uIChfeDIpIHsKICAgICAgcmV0dXJuIF9yZWY5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0oKSk7Cn07Cgp2YXIgZmV0Y2hVbnNwZW50cyA9IGZ1bmN0aW9uIGZldGNoVW5zcGVudHMoYWRkcmVzcykgewogIHZhciByZXN1bHQgPSBhcGlMb29wZXIuZ2V0KCdnaG9zdHNjYW4nLCAiL2FkZHIvIi5jb25jYXQoYWRkcmVzcywgIi91dHhvIiksIHsKICAgIGNhY2hlUmVzcG9uc2U6IDUwMDAKICB9KTsKICByZXR1cm4gcmVzdWx0Owp9OwoKdmFyIGJyb2FkY2FzdFR4ID0gZnVuY3Rpb24gYnJvYWRjYXN0VHgodHhSYXcpIHsKICB2YXIgcmVzdWx0ID0gYXBpTG9vcGVyLnBvc3QoJ2dob3N0c2NhbicsICIvdHgvc2VuZCIsIHsKICAgIGJvZHk6IHsKICAgICAgcmF3dHg6IHR4UmF3CiAgICB9CiAgfSk7CiAgcmV0dXJuIHJlc3VsdDsKfTsKCnZhciBzaWduTWVzc2FnZSA9IGZ1bmN0aW9uIHNpZ25NZXNzYWdlKG1lc3NhZ2UsIGVuY29kZWRQcml2YXRlS2V5KSB7CiAgdmFyIGtleVBhaXIgPSBiaXRjb2luLkVDUGFpci5mcm9tV0lGKGVuY29kZWRQcml2YXRlS2V5LCBbZ2hvc3QubmV0d29ya3MubWFpbm5ldCwgZ2hvc3QubmV0d29ya3MudGVzdG5ldF0pOwogIHZhciBwcml2YXRlS2V5QnVmZiA9IEJ1ZmZlci5mcm9tKGtleVBhaXIucHJpdmF0ZUtleSk7CiAgdmFyIHNpZ25hdHVyZSA9IGJpdGNvaW5NZXNzYWdlLnNpZ24obWVzc2FnZSwgcHJpdmF0ZUtleUJ1ZmYsIGtleVBhaXIuY29tcHJlc3NlZCk7CiAgcmV0dXJuIHNpZ25hdHVyZS50b1N0cmluZygnYmFzZTY0Jyk7Cn07Cgp2YXIgZ2V0UmVwdXRhdGlvbiA9IGZ1bmN0aW9uIGdldFJlcHV0YXRpb24oKSB7CiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgwKTsKfTsKCndpbmRvdy5nZXRNYWluUHVibGljS2V5ID0gZ2V0TWFpblB1YmxpY0tleTsKLyoNCiAg0J/RgNC+0LLQtdGA0Y/QtdGCINGB0L/QuNGB0LDQvdC40LUg0YHQviDRgdC60YDQuNC/0YLQsCAtINC/0L7RgdC70LXQtNC90Y/RjyDRgtGA0LDQvdC30LDQutGG0LjRjyDQstGL0YXQvtC00LANCiAg0JLQvtC30LLRgNCw0YnQsNC10YIgdHhJZCwg0LDQtNGA0LXRgdGBINC4INGB0YPQvNC80YMNCiovCgp2YXIgY2hlY2tXaXRoZHJhdyA9IGZ1bmN0aW9uIGNoZWNrV2l0aGRyYXcoc2NyaXB0QWRkcmVzcykgewogIHZhciB1cmwgPSAiL3R4cy8/YWRkcmVzcz0iLmNvbmNhdChzY3JpcHRBZGRyZXNzKTsKICByZXR1cm4gYXBpTG9vcGVyLmdldCgnZ2hvc3RzY2FuJywgdXJsLCB7CiAgICBjaGVja1N0YXR1czogZnVuY3Rpb24gY2hlY2tTdGF0dXMoYW5zd2VyKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKGFuc3dlciAmJiBhbnN3ZXIudHhzICE9PSB1bmRlZmluZWQpIHJldHVybiB0cnVlOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgLyogKi8KICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHF1ZXJ5OiAnZ2hvc3RfYmFsYW5jZScKICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgIGlmIChyZXMudHhzLmxlbmd0aCA+IDEgJiYgcmVzLnR4c1swXS52b3V0Lmxlbmd0aCkgewogICAgICB2YXIgYWRkcmVzcyA9IHJlcy50eHNbMF0udm91dFswXS5zY3JpcHRQdWJLZXkuYWRkcmVzc2VzWzBdOwogICAgICB2YXIgX3JlcyR0eHMkID0gcmVzLnR4c1swXSwKICAgICAgICAgIHR4aWQgPSBfcmVzJHR4cyQudHhpZCwKICAgICAgICAgIGFtb3VudCA9IF9yZXMkdHhzJC52YWx1ZU91dDsKICAgICAgcmV0dXJuIHsKICAgICAgICBhZGRyZXNzOiBhZGRyZXNzLAogICAgICAgIHR4aWQ6IHR4aWQsCiAgICAgICAgYW1vdW50OiBhbW91bnQKICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfSk7Cn07Cgp3aW5kb3cuZ2hvc3RDaGVja1dpdGhkcmF3ID0gY2hlY2tXaXRoZHJhdzsKZXhwb3J0IGRlZmF1bHQgewogIGxvZ2luOiBsb2dpbiwKICBjaGVja1dpdGhkcmF3OiBjaGVja1dpdGhkcmF3LAogIGdldEJhbGFuY2U6IGdldEJhbGFuY2UsCiAgZ2V0VHJhbnNhY3Rpb246IGdldFRyYW5zYWN0aW9uLAogIHNlbmQ6IHNlbmQsCiAgZmV0Y2hVbnNwZW50czogZmV0Y2hVbnNwZW50cywKICBicm9hZGNhc3RUeDogYnJvYWRjYXN0VHgsCiAgZmV0Y2hUeDogZmV0Y2hUeCwKICBmZXRjaFR4SW5mbzogZmV0Y2hUeEluZm8sCiAgZmV0Y2hCYWxhbmNlOiBmZXRjaEJhbGFuY2UsCiAgc2lnbk1lc3NhZ2U6IHNpZ25NZXNzYWdlLAogIGdldFJlcHV0YXRpb246IGdldFJlcHV0YXRpb24sCiAgZ2V0VHg6IGdldFR4LAogIGdldExpbmtUb0luZm86IGdldExpbmtUb0luZm8sCiAgZ2V0SW52b2ljZXM6IGdldEludm9pY2VzLAogIGdldFdhbGxldEJ5V29yZHM6IGdldFdhbGxldEJ5V29yZHMsCiAgZ2V0UmFuZG9tTW5lbW9uaWNXb3JkczogZ2V0UmFuZG9tTW5lbW9uaWNXb3JkcywKICB2YWxpZGF0ZU1uZW1vbmljV29yZHM6IHZhbGlkYXRlTW5lbW9uaWNXb3JkcywKICBzd2VlcFRvTW5lbW9uaWM6IHN3ZWVwVG9NbmVtb25pYywKICBpc1N3ZWVwZWQ6IGlzU3dlZXBlZCwKICBnZXRTd2VlcEFkZHJlc3M6IGdldFN3ZWVwQWRkcmVzcywKICBnZXRBbGxNeUFkZHJlc3NlczogZ2V0QWxsTXlBZGRyZXNzZXMsCiAgZ2V0RGF0YUJ5QWRkcmVzczogZ2V0RGF0YUJ5QWRkcmVzcywKICBnZXRNYWluUHVibGljS2V5OiBnZXRNYWluUHVibGljS2V5LAogIGdldFR4Um91dGVyOiBnZXRUeFJvdXRlciwKICBmZXRjaFR4UmF3OiBmZXRjaFR4UmF3Cn07"},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/redux/actions/ghost.ts"],"names":["BigInteger","BigNumber","bitcoin","bip39","bitcoinMessage","getState","reducers","ghost","apiLooper","constants","actions","typeforce","config","bitcore","require","mnemonicUtils","hasAdminFee","opts","fee","address","min","getRandomMnemonicWords","generateMnemonic","validateMnemonicWords","mnemonic","validateMnemonic","convertMnemonicToValid","sweepToMnemonic","path","wallet","getWalletByWords","localStorage","setItem","privateKeyNames","ghostMnemonic","WIF","getMainPublicKey","ghostData","user","publicKey","toString","isSweeped","ghostMnemonicData","toLowerCase","getSweepAddress","walletNumber","getGhostWallet","network","auth","privateKey","hash","crypto","sha256","d","fromBuffer","keyPair","ECPair","fromWIF","account","payments","p2pkh","pubkey","getPrivateKeyByAddress","oldAddress","mnemonicAddress","mnemonicKey","login","mnemonicKeys","sweepToMnemonicReady","console","info","accData","log","data","isMnemonic","currency","fullName","window","getGhostAddress","getGhostData","setAuthData","name","error","mnemonicData","addWallet","balance","isBalanceFetched","balanceError","infoAboutCurrency","Promise","resolve","fetchBalanceStatus","balanceData","setBalanceError","getTx","txRaw","getId","getTxRouter","txId","getLinkToInfo","tx","link","ghostscan","get","checkStatus","answer","undefined","e","then","unconfirmedBalance","getBalance","inQuery","delay","setBalance","amount","fetchBalance","fetchTx","cacheResponse","fees","rest","multipliedBy","fetchTxRaw","rawtx","fetchTxInfo","vin","vout","senderAddress","addr","value","toNumber","afterBalance","adminFee","adminOutput","filter","out","scriptPubKey","addresses","eq","afterOutput","length","txInfo","receiverAddress","confirmed","confirmations","minerFee","dividedBy","minerFeeCurrency","outputs","map","getInvoices","userAddress","invoices","getAllMyAddresses","ghostMultisigSMSData","ghostMultisigUserData","ghostMultisigG2FAData","ghostMultisigPinData","retData","push","wallets","getDataByAddress","founded","getTransaction","ownType","myAllWallets","type","isCoinAddress","GHOST","url","txs","query","res","transactions","item","direction","isSelf","txid","canEdit","indexOf","currentAddress","date","time","send","sendBitcore","from","to","feeValue","speed","ready","privKey","fetchUnspents","unspents","fundValue","String","integerValue","transaction","Transaction","change","sign","broadcastTx","serialize","broadcastAnswer","result","post","body","signMessage","message","encodedPrivateKey","networks","mainnet","testnet","privateKeyBuff","Buffer","signature","compressed","getReputation","checkWithdraw","scriptAddress","valueOut","ghostCheckWithdraw"],"mappings":"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","sourcesContent":["// @ts-nocheck\r\nimport BigInteger from 'bigi'\r\n\r\nimport { BigNumber } from 'bignumber.js'\r\nimport * as bitcoin from 'bitcoinjs-lib'\r\nimport * as bip32 from 'bip32'\r\nimport * as bip39 from 'bip39'\r\n\r\nimport bitcoinMessage from 'bitcoinjs-message'\r\nimport { getState } from 'redux/core'\r\nimport reducers from 'redux/core/reducers'\r\nimport { ghost, apiLooper, constants, api } from 'helpers'\r\nimport actions from 'redux/actions'\r\nimport typeforce from 'swap.app/util/typeforce'\r\nimport config from 'app-config'\r\nconst bitcore = require('ghost-bitcore-lib');\r\nimport { localisePrefix } from 'helpers/locale'\r\n\r\nimport * as mnemonicUtils from '../../../../common/utils/mnemonic'\r\n\r\n\r\n\r\nconst hasAdminFee = (config\r\n  && config.opts\r\n  && config.opts.fee\r\n  && config.opts.fee.ghost\r\n  && config.opts.fee.ghost.fee\r\n  && config.opts.fee.ghost.address\r\n  && config.opts.fee.ghost.min\r\n) ? config.opts.fee.ghost : false\r\n\r\nconst getRandomMnemonicWords = () => bip39.generateMnemonic()\r\nconst validateMnemonicWords = (mnemonic) => bip39.validateMnemonic(mnemonicUtils.convertMnemonicToValid(mnemonic))\r\n\r\n\r\nconst sweepToMnemonic = (mnemonic, path) => {\r\n  const wallet = getWalletByWords(mnemonic, path)\r\n  localStorage.setItem(constants.privateKeyNames.ghostMnemonic, wallet.WIF)\r\n  return wallet.WIF\r\n}\r\n\r\nconst getMainPublicKey = () => {\r\n  const {\r\n    user: {\r\n      ghostData,\r\n    },\r\n  } = getState()\r\n\r\n  return ghostData.publicKey.toString('Hex')\r\n}\r\n\r\nconst isSweeped = () => {\r\n  const {\r\n    user: {\r\n      ghostData,\r\n      ghostMnemonicData,\r\n    },\r\n  } = getState()\r\n\r\n  if (ghostMnemonicData\r\n    && ghostMnemonicData.address\r\n    && ghostData\r\n    && ghostData.address\r\n    && ghostData.address.toLowerCase() !== ghostMnemonicData.address.toLowerCase()\r\n  ) return false\r\n\r\n  return true\r\n}\r\n\r\nconst getSweepAddress = () => {\r\n  const {\r\n    user: {\r\n      ghostMnemonicData,\r\n    },\r\n  } = getState()\r\n\r\n  if (ghostMnemonicData && ghostMnemonicData.address) return ghostMnemonicData.address\r\n  return false\r\n}\r\n\r\nconst getWalletByWords = (mnemonic: string, walletNumber: number = 0, path: string = '') => {\r\n  return mnemonicUtils.getGhostWallet(ghost.network, mnemonic, walletNumber, path)\r\n}\r\n\r\n\r\nconst auth = (privateKey) => {\r\n  if (privateKey) {\r\n    const hash = bitcoin.crypto.sha256(privateKey)\r\n    const d = BigInteger.fromBuffer(hash)\r\n\r\n    const keyPair = bitcoin.ECPair.fromWIF(privateKey, ghost.network)\r\n\r\n    const account = bitcoin.ECPair.fromWIF(privateKey, ghost.network) // eslint-disable-line\r\n    const { address } = bitcoin.payments.p2pkh({ pubkey: account.publicKey, network: ghost.network })\r\n    const { publicKey } = account\r\n\r\n    return {\r\n      account,\r\n      keyPair,\r\n      address,\r\n      privateKey,\r\n      publicKey,\r\n    }\r\n  }\r\n}\r\n\r\nconst getPrivateKeyByAddress = (address) => {\r\n  const {\r\n    user: {\r\n      ghostData: {\r\n        address: oldAddress,\r\n        privateKey,\r\n      }\r\n    },\r\n  } = getState()\r\n  /*\r\n  const ghostMnemonicData\r\n      ghostMnemonicData: {\r\n        address: mnemonicAddress,\r\n        privateKey: mnemonicKey,\r\n      },\r\n    },\r\n  } = getState()\r\n  */\r\n  if (oldAddress === address) return privateKey\r\n    //@\r\n  if (mnemonicAddress === address) return mnemonicKey\r\n}\r\n\r\nconst login = (privateKey, mnemonic = null, mnemonicKeys = null) => {\r\n  let sweepToMnemonicReady = false\r\n\r\n  if (privateKey\r\n    && mnemonic\r\n    && mnemonicKeys\r\n    && mnemonicKeys.ghost === privateKey\r\n  ) sweepToMnemonicReady = true\r\n\r\n  if (!privateKey && mnemonic) sweepToMnemonicReady = true\r\n\r\n  if (privateKey) {\r\n    const hash = bitcoin.crypto.sha256(privateKey)\r\n    const d = BigInteger.fromBuffer(hash)\r\n\r\n    // keyPair     = bitcoin.ECPair.fromWIF(privateKey, ghost.network)\r\n  }\r\n  else {\r\n    console.info('Created account Ghost ...')\r\n    // keyPair     = bitcoin.ECPair.makeRandom({ network: ghost.network })\r\n    // privateKey  = keyPair.toWIF()\r\n    // use random 12 words\r\n    if (!mnemonic) mnemonic = bip39.generateMnemonic()\r\n\r\n    const accData = getWalletByWords(mnemonic)\r\n    console.log('Ghost. Generated wallet from random 12 words')\r\n    console.log(accData)\r\n    privateKey = accData.WIF\r\n    localStorage.setItem(constants.privateKeyNames.ghostMnemonic, privateKey)\r\n  }\r\n\r\n  localStorage.setItem(constants.privateKeyNames.ghost, privateKey)\r\n\r\n  const data = {\r\n    ...auth(privateKey),\r\n    isMnemonic: sweepToMnemonicReady,\r\n    currency: 'GHOST',\r\n    fullName: 'ghost',\r\n  }\r\n\r\n  window.getGhostAddress = () => data.address\r\n  window.getGhostData = () => data\r\n\r\n  console.info('Logged in with Ghost', data)\r\n  reducers.user.setAuthData({ name: 'ghostData', data })\r\n  if (!sweepToMnemonicReady) {\r\n    // Auth with our mnemonic account\r\n    if (mnemonic === `-`) {\r\n      console.error('Sweep. Cant auth. Need new mnemonic or enter own for re-login')\r\n      return\r\n    }\r\n\r\n    if (!mnemonicKeys\r\n      || !mnemonicKeys.ghost\r\n    ) {\r\n      console.error('Sweep. Cant auth. Login key undefined')\r\n      return\r\n    }\r\n\r\n    const mnemonicData = {\r\n      ...auth(mnemonicKeys.ghost),\r\n      isMnemonic: true,\r\n    }\r\n    console.info('Logged in with Ghost Mnemonic', mnemonicData)\r\n    reducers.user.addWallet({\r\n      name: 'ghostMnemonicData',\r\n      data: {\r\n        currency: 'GHOST',\r\n        fullName: 'Ghost (New)',\r\n        balance: 0,\r\n        isBalanceFetched: false,\r\n        balanceError: null,\r\n        infoAboutCurrency: null,\r\n        ...mnemonicData,\r\n      },\r\n    })\r\n    new Promise(async (resolve) => {\r\n      const balanceData = await fetchBalanceStatus(mnemonicData.address)\r\n      if (balanceData) {\r\n        reducers.user.setAuthData({\r\n          name: 'ghostMnemonicData',\r\n          data: {\r\n            //@\r\n            ...balanceData,\r\n            isBalanceFetched: true,\r\n          },\r\n        })\r\n      } else {\r\n        reducers.user.setBalanceError({ name: 'ghostMnemonicData' })\r\n      }\r\n      resolve(true)\r\n    })\r\n  }\r\n\r\n  return privateKey\r\n}\r\n\r\n\r\nconst getTx = (txRaw) => {\r\n  if (txRaw\r\n    && txRaw.getId\r\n    //@\r\n    && txRaw.getId instanceof 'function'\r\n  ) {\r\n    return txRaw.getId()\r\n  } else {\r\n    return txRaw\r\n  }\r\n}\r\n\r\nconst getTxRouter = (txId) => `/ghost/tx/${txId}`\r\n\r\nconst getLinkToInfo = (tx) => {\r\n\r\n  if (!tx) {\r\n    return\r\n  }\r\n\r\n  return `${config.link.ghostscan}/tx/${tx}`\r\n}\r\n\r\nconst fetchBalanceStatus = (address) => apiLooper.get('ghostscan', `/addr/${address}`, {\r\n  checkStatus: (answer) => {\r\n    try {\r\n      if (answer && answer.balance !== undefined) return true\r\n    } catch (e) { /* */console.log(e) }\r\n    return false\r\n  },\r\n}).then(({ balance, unconfirmedBalance }) => ({\r\n  address,\r\n  balance,\r\n  unconfirmedBalance,\r\n}))\r\n  .catch((e) => false)\r\nconst getBalance = () => {\r\n  const { user: { ghostData: { address } } } = getState()\r\n\r\n  return apiLooper.get('ghostscan', `/addr/${address}`, {\r\n    inQuery: {\r\n      delay: 500,\r\n      name: `balance`,\r\n    },\r\n    checkStatus: (answer) => {\r\n      try {\r\n        if (answer && answer.balance !== undefined) return true\r\n      } catch (e) { /* */ }\r\n      return false\r\n    },\r\n  }).then(({ balance, unconfirmedBalance }) => {\r\n    console.log('GHOST Balance: ', balance)\r\n    console.log('GHOST unconfirmedBalance Balance: ', unconfirmedBalance)\r\n    reducers.user.setBalance({ name: 'ghostData', amount: balance, unconfirmedBalance })\r\n    return balance\r\n  })\r\n    .catch((e) => {\r\n      reducers.user.setBalanceError({ name: 'ghostData' })\r\n    })\r\n}\r\n\r\nconst fetchBalance = (address) =>\r\n  apiLooper.get('ghostscan', `/addr/${address}`, {\r\n    checkStatus: (answer) => {\r\n      try {\r\n        if (answer && answer.balance !== undefined) return true\r\n      } catch (e) { /* */ }\r\n      return false\r\n    },\r\n  }).then(({ balance }) => balance)\r\n\r\nconst fetchTx = (hash, cacheResponse) =>\r\n  apiLooper.get('ghostscan', `/tx/${hash}`, {\r\n    cacheResponse,\r\n    checkStatus: (answer) => {\r\n      try {\r\n        if (answer && answer.fees !== undefined) return true\r\n      } catch (e) {\r\n        console.error(e)\r\n      }\r\n      return false\r\n    },\r\n  }).then(({ fees, ...rest }): IUniversalObj => ({\r\n    fees: new BigNumber(fees).multipliedBy(1e8),\r\n    ...rest,\r\n  }))\r\n\r\nconst fetchTxRaw = (txId, cacheResponse) =>\r\n  apiLooper.get('ghostscan', `/rawtx/${txId}`, {\r\n    cacheResponse,\r\n    checkStatus: (answer) => {\r\n      try {\r\n        if (answer && answer.rawtx !== undefined) return true\r\n      } catch (e) {\r\n        console.error(e)\r\n      }\r\n      return false\r\n    },\r\n  }).then(({ rawtx }) => rawtx)\r\n\r\nconst fetchTxInfo = (hash, cacheResponse?) =>\r\n  fetchTx(hash, cacheResponse)\r\n    .then(({ vin, vout, ...rest }) => {\r\n      const senderAddress = vin ? vin[0].addr : null\r\n      const amount = vout ? new BigNumber(vout[0].value).toNumber() : null\r\n\r\n      let afterBalance = vout && vout[1] ? new BigNumber(vout[1].value).toNumber() : null\r\n      let adminFee: any = false\r\n\r\n      if (hasAdminFee) {\r\n        const adminOutput = vout.filter((out) => (\r\n          out.scriptPubKey.addresses\r\n          && out.scriptPubKey.addresses[0] === hasAdminFee.address\r\n          && !(new BigNumber(out.value).eq(amount))\r\n        ))\r\n\r\n        const afterOutput = vout.filter((out) => (\r\n          out.addresses\r\n          && out.addresses[0] !== hasAdminFee.address\r\n          && out.addresses[0] !== senderAddress\r\n        ))\r\n\r\n        if (afterOutput.length) {\r\n          afterBalance = new BigNumber(afterOutput[0].value).toNumber()\r\n        }\r\n\r\n        if (adminOutput.length) {\r\n          adminFee = new BigNumber(adminOutput[0].value).toNumber()\r\n        }\r\n      }\r\n\r\n      const txInfo = {\r\n        amount,\r\n        afterBalance,\r\n        senderAddress,\r\n        receiverAddress: vout ? vout[0].scriptPubKey.addresses : null,\r\n        confirmed: !!(rest.confirmations),\r\n        minerFee: rest.fees.dividedBy(1e8).toNumber(),\r\n        adminFee,\r\n        minerFeeCurrency: 'GHOST',\r\n        outputs: vout.map((out) => ({\r\n          amount: new BigNumber(out.value).toNumber(),\r\n          address: out.scriptPubKey.addresses || null,\r\n        })),\r\n        ...rest,\r\n      }\r\n\r\n      return txInfo\r\n    })\r\n\r\nconst getInvoices = (address) => {\r\n  const { user: { ghostData: { userAddress } } } = getState()\r\n\r\n  address = address || userAddress\r\n\r\n  return actions.invoices.getInvoices({\r\n    currency: 'GHOST',\r\n    address,\r\n  })\r\n}\r\n\r\nconst getAllMyAddresses = () => {\r\n  const {\r\n    user: {\r\n      ghostData,\r\n      ghostMnemonicData,\r\n      ghostMultisigSMSData,\r\n      ghostMultisigUserData,\r\n      ghostMultisigG2FAData,\r\n      ghostMultisigPinData,\r\n    },\r\n  } = getState()\r\n\r\n  const retData = []\r\n  // Проверяем, был ли sweep\r\n  if (ghostMnemonicData\r\n    && ghostMnemonicData.address\r\n    && ghostData\r\n    && ghostData.address\r\n    && ghostMnemonicData.address !== ghostData.address\r\n  ) {\r\n    retData.push(ghostMnemonicData.address.toLowerCase())\r\n  }\r\n\r\n  retData.push(ghostData.address.toLowerCase())\r\n\r\n  if (ghostMultisigSMSData && ghostMultisigSMSData.address) retData.push(ghostMultisigSMSData.address.toLowerCase())\r\n  // @ToDo - SMS MultiWallet\r\n\r\n  if (ghostMultisigUserData && ghostMultisigUserData.address) retData.push(ghostMultisigUserData.address.toLowerCase())\r\n  if (ghostMultisigUserData && ghostMultisigUserData.wallets && ghostMultisigUserData.wallets.length) {\r\n    ghostMultisigUserData.wallets.map((wallet) => {\r\n      retData.push(wallet.address.toLowerCase())\r\n    })\r\n  }\r\n\r\n  if (ghostMultisigPinData && ghostMultisigPinData.address) retData.push(ghostMultisigPinData.address.toLowerCase())\r\n\r\n  return retData\r\n}\r\n\r\nconst getDataByAddress = (address) => {\r\n  const {\r\n    user: {\r\n      ghostData,\r\n      ghostMnemonicData,\r\n      ghostMultisigSMSData,\r\n      ghostMultisigUserData,\r\n      ghostMultisigG2FAData,\r\n    },\r\n  } = getState()\r\n\r\n  const founded = [\r\n    ghostData,\r\n    ghostMnemonicData,\r\n    ghostMultisigSMSData,\r\n    ghostMultisigUserData,\r\n    ...(\r\n      ghostMultisigUserData\r\n      && ghostMultisigUserData.wallets\r\n      && ghostMultisigUserData.wallets.length\r\n    )\r\n      ? ghostMultisigUserData.wallets\r\n      : [],\r\n    ghostMultisigG2FAData,\r\n  ].filter(data => data && data.address && data.address.toLowerCase() === address.toLowerCase())\r\n\r\n  return (founded.length) ? founded[0] : false\r\n}\r\n\r\nconst getTransaction = (address: string = ``, ownType: string = ``) =>\r\n  new Promise((resolve) => {\r\n    const myAllWallets = getAllMyAddresses()\r\n\r\n    let { user: { ghostData: { address: userAddress } } } = getState()\r\n    address = address || userAddress\r\n\r\n    const type = (ownType) || 'ghost'\r\n\r\n    if (!typeforce.isCoinAddress.GHOST(address)) {\r\n      resolve([])\r\n    }\r\n\r\n    const url = `/txs/?address=${address}`\r\n\r\n    return apiLooper.get('ghostscan', url, {\r\n      checkStatus: (answer) => {\r\n        try {\r\n          if (answer && answer.txs !== undefined) return true\r\n        } catch (e) { /* */ }\r\n        return false\r\n      },\r\n      query: 'ghost_balance',\r\n    }).then((res: any) => {\r\n      const transactions = res.txs.map((item) => {\r\n        const direction = item.vin[0].addr !== address ? 'in' : 'out'\r\n\r\n        const isSelf = direction === 'out'\r\n          && item.vout.filter((item) =>\r\n            item.scriptPubKey.addresses[0] === address\r\n          ).length === item.vout.length\r\n\r\n        return ({\r\n          type,\r\n          hash: item.txid,\r\n          canEdit: (myAllWallets.indexOf(address) !== -1),\r\n          confirmations: item.confirmations,\r\n          value: isSelf\r\n            ? item.fees\r\n            : item.vout.filter((item) => {\r\n              if (!item.scriptPubKey.addresses) return false\r\n              const currentAddress = item.scriptPubKey.addresses[0]\r\n\r\n              return direction === 'in'\r\n                ? (currentAddress === address)\r\n                : (currentAddress !== address)\r\n            })[0].value,\r\n          date: item.time * 1000,\r\n          direction: isSelf ? 'self' : direction,\r\n        })\r\n      })\r\n      resolve(transactions)\r\n    })\r\n      .catch(() => {\r\n        resolve([])\r\n      })\r\n  })\r\n\r\nconst send = (data) => {\r\n  return sendBitcore(data)\r\n}\r\n\r\n//@\r\nconst sendBitcore = ({ from, to, amount, feeValue, speed } = {}) => {\r\n  return new Promise(async (ready) => {\r\n    const privKey = getPrivateKeyByAddress(from)\r\n    const unspents = await fetchUnspents(from)\r\n    const fundValue = new BigNumber(String(amount)).multipliedBy(1e8).integerValue().toNumber()\r\n\r\n    const transaction = new bitcore.Transaction()\r\n          .from(unspents)          // Feed information about what unspent outputs one can use\r\n          .to(to, fundValue)  // Add an output with the given amount of satoshis\r\n          .change(from)      // Sets up a change address where the rest of the funds will go\r\n          .sign(privKey)     // Signs all the inputs it can*/\r\n\r\n\r\n    const broadcastAnswer = await broadcastTx(String(transaction.serialize()))\r\n\r\n    const { txid } = broadcastAnswer\r\n    ready(txid)\r\n  })\r\n}\r\n\r\nconst fetchUnspents = (address) => {\r\n  const result: any = apiLooper.get('ghostscan', `/addr/${address}/utxo`, { cacheResponse: 5000 })\r\n  return result\r\n}\r\n\r\nconst broadcastTx = (txRaw) => {\r\n  const result: any = apiLooper.post('ghostscan', `/tx/send`, {\r\n    body: {\r\n      rawtx: txRaw,\r\n    },\r\n  })\r\n  return result\r\n}\r\n\r\nconst signMessage = (message, encodedPrivateKey) => {\r\n  const keyPair = bitcoin.ECPair.fromWIF(encodedPrivateKey, [ghost.networks.mainnet, ghost.networks.testnet])\r\n  const privateKeyBuff = Buffer.from(keyPair.privateKey)\r\n\r\n  const signature = bitcoinMessage.sign(message, privateKeyBuff, keyPair.compressed)\r\n\r\n  return signature.toString('base64')\r\n}\r\n\r\nconst getReputation = () => Promise.resolve(0)\r\n\r\nwindow.getMainPublicKey = getMainPublicKey\r\n\r\n/*\r\n  Проверяет списание со скрипта - последняя транзакция выхода\r\n  Возвращает txId, адресс и сумму\r\n*/\r\nconst checkWithdraw = (scriptAddress) => {\r\n  const url = `/txs/?address=${scriptAddress}`\r\n\r\n  return apiLooper.get('ghostscan', url, {\r\n    checkStatus: (answer) => {\r\n      try {\r\n        if (answer && answer.txs !== undefined) return true\r\n      } catch (e) { /* */ }\r\n      return false\r\n    },\r\n    query: 'ghost_balance',\r\n  }).then((res: any) => {\r\n    if (res.txs.length > 1\r\n      && res.txs[0].vout.length\r\n    ) {\r\n      const address = res.txs[0].vout[0].scriptPubKey.addresses[0]\r\n      const {\r\n        txid,\r\n        valueOut: amount,\r\n      } = res.txs[0]\r\n      return {\r\n        address,\r\n        txid,\r\n        amount,\r\n      }\r\n    }\r\n    return false\r\n  })\r\n}\r\n\r\nwindow.ghostCheckWithdraw = checkWithdraw\r\n\r\nexport default {\r\n  login,\r\n  checkWithdraw,\r\n  getBalance,\r\n  getTransaction,\r\n  send,\r\n  fetchUnspents,\r\n  broadcastTx,\r\n  fetchTx,\r\n  fetchTxInfo,\r\n  fetchBalance,\r\n  signMessage,\r\n  getReputation,\r\n  getTx,\r\n  getLinkToInfo,\r\n  getInvoices,\r\n  getWalletByWords,\r\n  getRandomMnemonicWords,\r\n  validateMnemonicWords,\r\n  sweepToMnemonic,\r\n  isSweeped,\r\n  getSweepAddress,\r\n  getAllMyAddresses,\r\n  getDataByAddress,\r\n  getMainPublicKey,\r\n  getTxRouter,\r\n  fetchTxRaw,\r\n}\r\n"]}]}