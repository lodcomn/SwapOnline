{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\helpers\\adminFee.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\helpers\\adminFee.ts","mtime":1614842914092},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGdldEN1cnJlbmN5S2V5IGZyb20gJy4vZ2V0Q3VycmVuY3lLZXknOwppbXBvcnQgY29uZmlnIGZyb20gJy4vZXh0ZXJuYWxDb25maWcnOwppbXBvcnQgeyBCaWdOdW1iZXIgfSBmcm9tICdiaWdudW1iZXIuanMnOwoKdmFyIGlzRW5hYmxlZCA9IGZ1bmN0aW9uIGlzRW5hYmxlZChjdXJyZW5jeSkgewogIGN1cnJlbmN5ID0gZ2V0Q3VycmVuY3lLZXkoY3VycmVuY3ksIGZhbHNlKS50b0xvd2VyQ2FzZSgpOwoKICBpZiAoY29uZmlnICYmIGNvbmZpZy5vcHRzICYmIGNvbmZpZy5vcHRzLmZlZSkgewogICAgaWYgKGN1cnJlbmN5ID09PSAidG9rZW4iICYmIGNvbmZpZy5vcHRzLmZlZS5lcmMyMCkgewogICAgICByZXR1cm4gY29uZmlnLm9wdHMuZmVlLmVyYzIwOwogICAgfSBlbHNlIHsKICAgICAgaWYgKGNvbmZpZy5vcHRzLmZlZVtjdXJyZW5jeV0pIHsKICAgICAgICByZXR1cm4gY29uZmlnLm9wdHMuZmVlW2N1cnJlbmN5XTsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIGZhbHNlOwp9OwoKdmFyIGNhbGMgPSBmdW5jdGlvbiBjYWxjKGN1cnJlbmN5LCBhbW91bnQpIHsKICB2YXIgdXNlZEFkbWluRmVlID0gaXNFbmFibGVkKGN1cnJlbmN5KTsKCiAgaWYgKHVzZWRBZG1pbkZlZSkgewogICAgdmFyIGZlZSA9IHVzZWRBZG1pbkZlZS5taW4gPyBuZXcgQmlnTnVtYmVyKHVzZWRBZG1pbkZlZS5taW4pLnRvTnVtYmVyKCkgOiAwOwoKICAgIGlmIChhbW91bnQgJiYgbmV3IEJpZ051bWJlcihhbW91bnQpLmlzR3JlYXRlclRoYW4oMCkpIHsKICAgICAgdmFyIGZlZUZyb21BbW91bnQgPSBuZXcgQmlnTnVtYmVyKHVzZWRBZG1pbkZlZS5mZWUpLmRpdmlkZWRCeSgxMDApLm11bHRpcGxpZWRCeShhbW91bnQpOwogICAgICBpZiAobmV3IEJpZ051bWJlcih1c2VkQWRtaW5GZWUubWluKS5pc0dyZWF0ZXJUaGFuKGZlZUZyb21BbW91bnQpKSBmZWVGcm9tQW1vdW50ID0gbmV3IEJpZ051bWJlcih1c2VkQWRtaW5GZWUubWluKTsKICAgICAgZmVlID0gZmVlRnJvbUFtb3VudC50b051bWJlcigpOyAvLyBBZG1pbiBmZWUgaW4gc2F0b3NoaQogICAgfQoKICAgIHJldHVybiBmZWU7CiAgfQoKICByZXR1cm4gMDsKfTsKCmV4cG9ydCBkZWZhdWx0IHsKICBpc0VuYWJsZWQ6IGlzRW5hYmxlZCwKICBjYWxjOiBjYWxjCn07"},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/helpers/adminFee.ts"],"names":["getCurrencyKey","config","BigNumber","isEnabled","currency","toLowerCase","opts","fee","erc20","calc","amount","usedAdminFee","min","toNumber","isGreaterThan","feeFromAmount","dividedBy","multipliedBy"],"mappings":"AAAA,OAAOA,cAAP,MAA2B,kBAA3B;AACA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,SAASC,SAAT,QAA0B,cAA1B;;AAGA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,QAAD,EAAc;AAC9BA,EAAAA,QAAQ,GAAGJ,cAAc,CAACI,QAAD,EAAW,KAAX,CAAd,CAAgCC,WAAhC,EAAX;;AACA,MAAIJ,MAAM,IAAIA,MAAM,CAACK,IAAjB,IAAyBL,MAAM,CAACK,IAAP,CAAYC,GAAzC,EAA8C;AAC5C,QAAKH,QAAQ,YAAT,IAA0BH,MAAM,CAACK,IAAP,CAAYC,GAAZ,CAAgBC,KAA9C,EAAqD;AACnD,aAAOP,MAAM,CAACK,IAAP,CAAYC,GAAZ,CAAgBC,KAAvB;AACD,KAFD,MAEO;AACL,UAAIP,MAAM,CAACK,IAAP,CAAYC,GAAZ,CAAgBH,QAAhB,CAAJ,EAA+B;AAC7B,eAAOH,MAAM,CAACK,IAAP,CAAYC,GAAZ,CAAgBH,QAAhB,CAAP;AACD;AACF;AACF;;AAED,SAAO,KAAP;AACD,CAbD;;AAeA,IAAMK,IAAI,GAAG,SAAPA,IAAO,CAACL,QAAD,EAAWM,MAAX,EAAsB;AACjC,MAAMC,YAAY,GAAGR,SAAS,CAACC,QAAD,CAA9B;;AAEA,MAAIO,YAAJ,EAAkB;AAChB,QAAIJ,GAAG,GAAII,YAAY,CAACC,GAAd,GAAqB,IAAIV,SAAJ,CAAcS,YAAY,CAACC,GAA3B,EAAgCC,QAAhC,EAArB,GAAkE,CAA5E;;AAEA,QAAIH,MAAM,IAAI,IAAIR,SAAJ,CAAcQ,MAAd,EAAsBI,aAAtB,CAAoC,CAApC,CAAd,EAAsD;AACpD,UAAIC,aAAa,GAAG,IAAIb,SAAJ,CAAcS,YAAY,CAACJ,GAA3B,EAAgCS,SAAhC,CAA0C,GAA1C,EAA+CC,YAA/C,CAA4DP,MAA5D,CAApB;AAEA,UAAI,IAAIR,SAAJ,CAAcS,YAAY,CAACC,GAA3B,EAAgCE,aAAhC,CAA8CC,aAA9C,CAAJ,EAAkEA,aAAa,GAAG,IAAIb,SAAJ,CAAcS,YAAY,CAACC,GAA3B,CAAhB;AAElEL,MAAAA,GAAG,GAAGQ,aAAa,CAACF,QAAd,EAAN,CALoD,CAKrB;AAChC;;AAED,WAAON,GAAP;AACD;;AAED,SAAO,CAAP;AACD,CAlBD;;AAoBA,eAAe;AACbJ,EAAAA,SAAS,EAATA,SADa;AAEbM,EAAAA,IAAI,EAAJA;AAFa,CAAf","sourcesContent":["import getCurrencyKey from './getCurrencyKey'\r\nimport config from './externalConfig'\r\nimport { BigNumber } from 'bignumber.js'\r\n\r\n\r\nconst isEnabled = (currency) => {\r\n  currency = getCurrencyKey(currency, false).toLowerCase()\r\n  if (config && config.opts && config.opts.fee) {\r\n    if ((currency === `token`) && config.opts.fee.erc20) {\r\n      return config.opts.fee.erc20\r\n    } else {\r\n      if (config.opts.fee[currency]) {\r\n        return config.opts.fee[currency]\r\n      }\r\n    }\r\n  }\r\n\r\n  return false\r\n}\r\n\r\nconst calc = (currency, amount) => {\r\n  const usedAdminFee = isEnabled(currency)\r\n\r\n  if (usedAdminFee) {\r\n    let fee = (usedAdminFee.min) ? new BigNumber(usedAdminFee.min).toNumber() : 0\r\n\r\n    if (amount && new BigNumber(amount).isGreaterThan(0)) {\r\n      let feeFromAmount = new BigNumber(usedAdminFee.fee).dividedBy(100).multipliedBy(amount)\r\n\r\n      if (new BigNumber(usedAdminFee.min).isGreaterThan(feeFromAmount)) feeFromAmount = new BigNumber(usedAdminFee.min)\r\n\r\n      fee = feeFromAmount.toNumber() // Admin fee in satoshi\r\n    }\r\n\r\n    return fee\r\n  }\r\n\r\n  return 0\r\n}\r\n\r\nexport default {\r\n  isEnabled,\r\n  calc,\r\n}\r\n"]}]}