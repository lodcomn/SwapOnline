{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\helpers\\lsDataCache.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\helpers\\lsDataCache.ts","mtime":1614852181580},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8gQHRzLW5vY2hlY2sKaW1wb3J0IGdldFVuaXhUaW1lU3RhbXAgZnJvbSAnLi9nZXRVbml4VGltZVN0YW1wJzsKdmFyIGxvY2FsU3RvcmFnZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2U7Cgp2YXIgcHVzaCA9IGZ1bmN0aW9uIHB1c2goX3JlZikgewogIHZhciBrZXkgPSBfcmVmLmtleSwKICAgICAgZGF0YSA9IF9yZWYuZGF0YSwKICAgICAgdGltZSA9IF9yZWYudGltZTsKICB2YXIgY2FjaGVEYXRhID0gewogICAgZGF0YTogZGF0YSwKICAgIHRpbWU6IHRpbWUsCiAgICBjcmVhdGV0aW1lOiBnZXRVbml4VGltZVN0YW1wKCkKICB9OwogIHZhciBjYWNoZUtleXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiIi5jb25jYXQocHJvY2Vzcy5lbnYuRU5UUlksICI6Y2FjaGVLZXlzIikpOwoKICB0cnkgewogICAgY2FjaGVLZXlzID0gSlNPTi5wYXJzZShjYWNoZUtleXMpOwogIH0gY2F0Y2ggKGUpIHt9IC8vQAoKCiAgaWYgKCFjYWNoZUtleXMpIGNhY2hlS2V5cyA9IHt9OyAvL0AKCiAgY2FjaGVLZXlzW2tleV0gPSBjYWNoZURhdGEuY3JlYXRldGltZSArIGNhY2hlRGF0YS50aW1lOwogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCIiLmNvbmNhdChwcm9jZXNzLmVudi5FTlRSWSwgIjpjYWNoZToiKS5jb25jYXQoa2V5KSwgSlNPTi5zdHJpbmdpZnkoY2FjaGVEYXRhKSk7CiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oIiIuY29uY2F0KHByb2Nlc3MuZW52LkVOVFJZLCAiOmNhY2hlS2V5cyIpLCBKU09OLnN0cmluZ2lmeShjYWNoZUtleXMpKTsKfTsKCnZhciBnZXQgPSBmdW5jdGlvbiBnZXQoa2V5KSB7CiAgdmFyIGRhdGEgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiIi5jb25jYXQocHJvY2Vzcy5lbnYuRU5UUlksICI6Y2FjaGU6IikuY29uY2F0KGtleSkpOwoKICB0cnkgewogICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7IC8vQAoKICAgIGlmIChkYXRhICYmIGRhdGEuZGF0YSkgewogICAgICAvL0AKICAgICAgcmV0dXJuIGRhdGEuZGF0YTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfSBjYXRjaCAoZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfTsKCnZhciByZW1vdmUgPSBmdW5jdGlvbiByZW1vdmUoa2V5KSB7CiAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oIiIuY29uY2F0KHByb2Nlc3MuZW52LkVOVFJZLCAiOmNhY2hlOiIpLmNvbmNhdChrZXkpKTsKfTsKCnZhciBjbGVhbnVwID0gZnVuY3Rpb24gY2xlYW51cCgpIHsKICB2YXIgY2FjaGVLZXlzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oIiIuY29uY2F0KHByb2Nlc3MuZW52LkVOVFJZLCAiOmNhY2hlS2V5cyIpKTsKICB2YXIgbmV3S2V5cyA9IHt9OwoKICB0cnkgewogICAgY2FjaGVLZXlzID0gSlNPTi5wYXJzZShjYWNoZUtleXMpOwogIH0gY2F0Y2ggKGUpIHt9IC8vQAoKCiAgaWYgKCFjYWNoZUtleXMpIGNhY2hlS2V5cyA9IHt9OwogIHZhciBjdXJUaW1lID0gZ2V0VW5peFRpbWVTdGFtcCgpOwogIE9iamVjdC5rZXlzKGNhY2hlS2V5cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICBpZiAoIWNhY2hlS2V5c1trZXldIHx8IGN1clRpbWUgPiBjYWNoZUtleXNba2V5XSkgewogICAgICByZW1vdmUoa2V5KTsKICAgIH0gZWxzZSB7CiAgICAgIG5ld0tleXNba2V5XSA9IGNhY2hlS2V5c1trZXldOwogICAgfQogIH0pOwogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCIiLmNvbmNhdChwcm9jZXNzLmVudi5FTlRSWSwgIjpjYWNoZUtleXMiKSwgSlNPTi5zdHJpbmdpZnkobmV3S2V5cykpOwp9OwoKY2xlYW51cCgpOwpleHBvcnQgZGVmYXVsdCB7CiAgcHVzaDogcHVzaCwKICBnZXQ6IGdldCwKICByZW1vdmU6IHJlbW92ZSwKICBjbGVhbnVwOiBjbGVhbnVwCn07"},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/helpers/lsDataCache.ts"],"names":["getUnixTimeStamp","localStorage","window","push","key","data","time","cacheData","createtime","cacheKeys","getItem","process","env","ENTRY","JSON","parse","e","setItem","stringify","get","remove","removeItem","cleanup","newKeys","curTime","Object","keys","forEach"],"mappings":"AAAA;AACA,OAAOA,gBAAP,MAA6B,oBAA7B;AAGA,IAAMC,YAAY,GAAGC,MAAM,CAACD,YAA5B;;AAEA,IAAME,IAAI,GAAG,SAAPA,IAAO,OAAyB;AAAA,MAAtBC,GAAsB,QAAtBA,GAAsB;AAAA,MAAjBC,IAAiB,QAAjBA,IAAiB;AAAA,MAAXC,IAAW,QAAXA,IAAW;AACpC,MAAMC,SAAS,GAAG;AAChBF,IAAAA,IAAI,EAAJA,IADgB;AAEhBC,IAAAA,IAAI,EAAJA,IAFgB;AAGhBE,IAAAA,UAAU,EAAER,gBAAgB;AAHZ,GAAlB;AAMA,MAAIS,SAAS,GAAGR,YAAY,CAACS,OAAb,WAAwBC,OAAO,CAACC,GAAR,CAAYC,KAApC,gBAAhB;;AACA,MAAI;AACFJ,IAAAA,SAAS,GAAGK,IAAI,CAACC,KAAL,CAAWN,SAAX,CAAZ;AACD,GAFD,CAEE,OAAOO,CAAP,EAAU,CAAE,CAVsB,CAWpC;;;AACA,MAAI,CAACP,SAAL,EAAgBA,SAAS,GAAG,EAAZ,CAZoB,CAapC;;AACAA,EAAAA,SAAS,CAACL,GAAD,CAAT,GAAiBG,SAAS,CAACC,UAAV,GAAuBD,SAAS,CAACD,IAAlD;AACAL,EAAAA,YAAY,CAACgB,OAAb,WAAwBN,OAAO,CAACC,GAAR,CAAYC,KAApC,oBAAmDT,GAAnD,GAA0DU,IAAI,CAACI,SAAL,CAAeX,SAAf,CAA1D;AACAN,EAAAA,YAAY,CAACgB,OAAb,WAAwBN,OAAO,CAACC,GAAR,CAAYC,KAApC,iBAAuDC,IAAI,CAACI,SAAL,CAAeT,SAAf,CAAvD;AACD,CAjBD;;AAmBA,IAAMU,GAAG,GAAG,SAANA,GAAM,CAACf,GAAD,EAAS;AACnB,MAAIC,IAAI,GAAGJ,YAAY,CAACS,OAAb,WAAwBC,OAAO,CAACC,GAAR,CAAYC,KAApC,oBAAmDT,GAAnD,EAAX;;AACA,MAAI;AACFC,IAAAA,IAAI,GAAGS,IAAI,CAACC,KAAL,CAAWV,IAAX,CAAP,CADE,CAEF;;AACA,QAAIA,IAAI,IAAIA,IAAI,CAACA,IAAjB,EAAuB;AACrB;AACA,aAAOA,IAAI,CAACA,IAAZ;AACD;;AACD,WAAO,KAAP;AACD,GARD,CAQE,OAAOW,CAAP,EAAU;AACV,WAAO,KAAP;AACD;AACF,CAbD;;AAeA,IAAMI,MAAM,GAAG,SAATA,MAAS,CAAChB,GAAD,EAAS;AACtBH,EAAAA,YAAY,CAACoB,UAAb,WAA2BV,OAAO,CAACC,GAAR,CAAYC,KAAvC,oBAAsDT,GAAtD;AACD,CAFD;;AAIA,IAAMkB,OAAO,GAAG,SAAVA,OAAU,GAAM;AACpB,MAAIb,SAAS,GAAGR,YAAY,CAACS,OAAb,WAAwBC,OAAO,CAACC,GAAR,CAAYC,KAApC,gBAAhB;AACA,MAAMU,OAAO,GAAG,EAAhB;;AACA,MAAI;AACFd,IAAAA,SAAS,GAAGK,IAAI,CAACC,KAAL,CAAWN,SAAX,CAAZ;AACD,GAFD,CAEE,OAAOO,CAAP,EAAU,CAAE,CALM,CAMpB;;;AACA,MAAI,CAACP,SAAL,EAAgBA,SAAS,GAAG,EAAZ;AAEhB,MAAMe,OAAO,GAAGxB,gBAAgB,EAAhC;AAEAyB,EAAAA,MAAM,CAACC,IAAP,CAAYjB,SAAZ,EAAuBkB,OAAvB,CAA+B,UAACvB,GAAD,EAAS;AACtC,QAAI,CAACK,SAAS,CAACL,GAAD,CAAV,IAAoBoB,OAAO,GAAGf,SAAS,CAACL,GAAD,CAA3C,EAAmD;AACjDgB,MAAAA,MAAM,CAAChB,GAAD,CAAN;AACD,KAFD,MAEO;AACLmB,MAAAA,OAAO,CAACnB,GAAD,CAAP,GAAeK,SAAS,CAACL,GAAD,CAAxB;AACD;AACF,GAND;AAQAH,EAAAA,YAAY,CAACgB,OAAb,WAAwBN,OAAO,CAACC,GAAR,CAAYC,KAApC,iBAAuDC,IAAI,CAACI,SAAL,CAAeK,OAAf,CAAvD;AACD,CApBD;;AAsBAD,OAAO;AAEP,eAAe;AACbnB,EAAAA,IAAI,EAAJA,IADa;AAEbgB,EAAAA,GAAG,EAAHA,GAFa;AAGbC,EAAAA,MAAM,EAANA,MAHa;AAIbE,EAAAA,OAAO,EAAPA;AAJa,CAAf","sourcesContent":["// @ts-nocheck\r\nimport getUnixTimeStamp from './getUnixTimeStamp'\r\n\r\n\r\nconst localStorage = window.localStorage\r\n\r\nconst push = ({ key, data, time }) => {\r\n  const cacheData = {\r\n    data,\r\n    time,\r\n    createtime: getUnixTimeStamp(),\r\n  }\r\n\r\n  let cacheKeys = localStorage.getItem(`${process.env.ENTRY}:cacheKeys`)\r\n  try {\r\n    cacheKeys = JSON.parse(cacheKeys)\r\n  } catch (e) {}\r\n  //@\r\n  if (!cacheKeys) cacheKeys = {}\r\n  //@\r\n  cacheKeys[key] = cacheData.createtime + cacheData.time\r\n  localStorage.setItem(`${process.env.ENTRY}:cache:${key}`, JSON.stringify(cacheData))\r\n  localStorage.setItem(`${process.env.ENTRY}:cacheKeys`, JSON.stringify(cacheKeys))\r\n}\r\n\r\nconst get = (key) => {\r\n  let data = localStorage.getItem(`${process.env.ENTRY}:cache:${key}`)\r\n  try {\r\n    data = JSON.parse(data)\r\n    //@\r\n    if (data && data.data) {\r\n      //@\r\n      return data.data\r\n    }\r\n    return false\r\n  } catch (e) {\r\n    return false\r\n  }\r\n}\r\n\r\nconst remove = (key) => {\r\n  localStorage.removeItem(`${process.env.ENTRY}:cache:${key}`)\r\n}\r\n\r\nconst cleanup = () => {\r\n  let cacheKeys = localStorage.getItem(`${process.env.ENTRY}:cacheKeys`)\r\n  const newKeys = {}\r\n  try {\r\n    cacheKeys = JSON.parse(cacheKeys)\r\n  } catch (e) {}\r\n  //@\r\n  if (!cacheKeys) cacheKeys = {}\r\n\r\n  const curTime = getUnixTimeStamp()\r\n\r\n  Object.keys(cacheKeys).forEach((key) => {\r\n    if (!cacheKeys[key] || (curTime > cacheKeys[key])) {\r\n      remove(key)\r\n    } else {\r\n      newKeys[key] = cacheKeys[key]\r\n    }\r\n  })\r\n\r\n  localStorage.setItem(`${process.env.ENTRY}:cacheKeys`, JSON.stringify(newKeys))\r\n}\r\n\r\ncleanup()\r\n\r\nexport default {\r\n  push,\r\n  get,\r\n  remove,\r\n  cleanup,\r\n}\r\n"]}]}