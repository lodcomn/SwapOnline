{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\common\\utils\\request.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\common\\utils\\request.ts","mtime":1614851540078},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2RlZmluZVByb3BlcnR5IjsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCi8vIEB0cy1ub2NoZWNrCmltcG9ydCByZXF1ZXN0IGZyb20gJ3N1cGVyYWdlbnQnOwp2YXIgcmVzcG9uc2VDYWNoZVN0b3JhZ2UgPSB7fTsKCnZhciByZXNwb25zZUNhY2hlR2V0S2V5ID0gZnVuY3Rpb24gcmVzcG9uc2VDYWNoZUdldEtleShyZXEsIG9wdHMpIHsKICByZXR1cm4gIiIuY29uY2F0KG9wdHMubWV0aG9kLCAiLSIpLmNvbmNhdChvcHRzLmVuZHBvaW50KTsKfTsKCnZhciByZXNwb25zZUNhY2hlR2V0ID0gZnVuY3Rpb24gcmVzcG9uc2VDYWNoZUdldChyZXEsIG9wdHMpIHsKICB2YXIgY2FjaGVLZXkgPSByZXNwb25zZUNhY2hlR2V0S2V5KHJlcSwgb3B0cyk7CgogIGlmIChvcHRzICYmIG9wdHMuY2FjaGVSZXNwb25zZSAmJiByZXNwb25zZUNhY2hlU3RvcmFnZVtjYWNoZUtleV0gJiYgcmVzcG9uc2VDYWNoZVN0b3JhZ2VbY2FjaGVLZXldLmNhY2hlUmVzcG9uc2VDcmVhdGVUaW1lICsgcmVzcG9uc2VDYWNoZVN0b3JhZ2VbY2FjaGVLZXldLmNhY2hlUmVzcG9uc2UgPj0gbmV3IERhdGUoKS5nZXRUaW1lKCkpIHsKICAgIHJldHVybiByZXNwb25zZUNhY2hlU3RvcmFnZVtjYWNoZUtleV07CiAgfQoKICByZXR1cm4gZmFsc2U7Cn07Cgp2YXIgcmVzcG9uc2VDYWNoZUFkZCA9IGZ1bmN0aW9uIHJlc3BvbnNlQ2FjaGVBZGQocmVxLCBvcHRzLCByZXNEYXRhLCByZXMpIHsKICB2YXIgY2FjaGVLZXkgPSByZXNwb25zZUNhY2hlR2V0S2V5KHJlcSwgb3B0cyk7CiAgdmFyIGNhY2hlUmVzcG9uc2UgPSBvcHRzLmNhY2hlUmVzcG9uc2U7CiAgdmFyIGNhY2hlUmVzcG9uc2VDcmVhdGVUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgcmVzcG9uc2VDYWNoZVN0b3JhZ2VbY2FjaGVLZXldID0gewogICAgY2FjaGVSZXNwb25zZTogY2FjaGVSZXNwb25zZSwKICAgIGNhY2hlUmVzcG9uc2VDcmVhdGVUaW1lOiBjYWNoZVJlc3BvbnNlQ3JlYXRlVGltZSwKICAgIHJlc0RhdGE6IHJlc0RhdGEsCiAgICByZXM6IHJlcwogIH07Cn07Cgp2YXIgY3JlYXRlUmVzcG9uc2VIYW5kbGVyID0gZnVuY3Rpb24gY3JlYXRlUmVzcG9uc2VIYW5kbGVyKHJlcSwgb3B0cykgewogIHZhciBkZWJ1ZyA9ICIiLmNvbmNhdChvcHRzLm1ldGhvZC50b1VwcGVyQ2FzZSgpLCAiICIpLmNvbmNhdChvcHRzLmVuZHBvaW50KTsgLy8gY2FjaGVkIGFuc3dlcgoKICB2YXIgY2FjaGVkQW5zd2VyID0gcmVzcG9uc2VDYWNoZUdldChyZXEsIG9wdHMpOwoKICBpZiAoY2FjaGVkQW5zd2VyKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGZ1bGZpbGwsIHJlamVjdCkgewogICAgICAvL0AKICAgICAgZnVsZmlsbChjYWNoZWRBbnN3ZXIucmVzRGF0YSwgY2FjaGVkQW5zd2VyLnJlcyk7CiAgICAgIG9wdHMub25Db21wbGV0ZSgpOwogICAgfSk7CiAgfSAvLyBubyBjYWNoZSAtIGRvIHJlcXVlc3QKCgogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoZnVsZmlsbCwgcmVqZWN0KSB7CiAgICByZXR1cm4gcmVxLmVuZChmdW5jdGlvbiAoZXJyLCByZXMpIHsKICAgICAgdmFyIHNlcnZlckVycm9yOyAvLyBFcnJvcnMKCiAgICAgIGlmICghcmVzICYmICFlcnIpIHsKICAgICAgICBzZXJ2ZXJFcnJvciA9ICJDb25uZWN0aW9uIGZhaWxlZDogIi5jb25jYXQoZGVidWcpOwogICAgICB9IGVsc2UgaWYgKCFyZXMgfHwgcmVzLnN0YXR1c0NvZGUgPj0gNTAwKSB7CiAgICAgICAgc2VydmVyRXJyb3IgPSAnV2VgcmUgaGF2aW5nIHRlY2huaWNhbCBpc3N1ZXMgYXQgdGhhdCBtb21lbnQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXInOwogICAgICB9CgogICAgICBpZiAoc2VydmVyRXJyb3IpIHsKICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcigiQ29ubmVjdGlvbiBmYWlsZWQ6ICIuY29uY2F0KGRlYnVnLCAiLCBzZXJ2ZXIgZXJyb3I6IikuY29uY2F0KHNlcnZlckVycm9yKSkpOwogICAgICB9CgogICAgICBpZiAoZXJyKSB7CiAgICAgICAgLy8gVE9ETyB3cml0ZSBFcnJvciBub3RpZmllcgogICAgICAgIG9wdHMub25Db21wbGV0ZSgpOwogICAgICAgIHJldHVybiByZWplY3QoewogICAgICAgICAgcmVzRGF0YTogZXJyLAogICAgICAgICAgcmVzOiByZXMKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIGJvZHkgPSByZXMuYm9keTsKCiAgICAgIGlmICghYm9keSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBib2R5ID0gSlNPTi5wYXJzZShyZXMudGV4dCk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgcmVzRGF0YSA9IG9wdHMubW9kaWZ5UmVzdWx0KGJvZHkpOyAvLyBDYWNoZSByZXN1bHQgaWYgbmVlZHMKCiAgICAgIGlmIChvcHRzLmNhY2hlUmVzcG9uc2UpIHsKICAgICAgICByZXNwb25zZUNhY2hlQWRkKHJlcSwgb3B0cywgcmVzRGF0YSwgcmVzKTsKICAgICAgfSAvLyBSZXNvbHZlCiAgICAgIC8vQAoKCiAgICAgIGZ1bGZpbGwocmVzRGF0YSwgcmVzKTsKICAgICAgb3B0cy5vbkNvbXBsZXRlKCk7CiAgICB9KTsKICB9KTsKfTsKCnZhciBkZWZhdWx0T3B0aW9ucyA9IHsKICBzYW1lT3JpZ2luOiBmYWxzZSwKICBtb2RpZnlSZXN1bHQ6IGZ1bmN0aW9uIG1vZGlmeVJlc3VsdChyZXNEYXRhKSB7CiAgICByZXR1cm4gcmVzRGF0YTsKICB9LAogIG9uQ29tcGxldGU6IGZ1bmN0aW9uIG9uQ29tcGxldGUoKSB7fQp9OwovKioNCiAqDQogKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucw0KICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMuZW5kcG9pbnQNCiAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLm1ldGhvZA0KICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMuaGVhZGVycw0KICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMucXVlcnkNCiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLmJvZHkNCiAqIEBwYXJhbSB7bnVtYmVyfSBvcHRpb25zLmRlbGF5DQogKi8KCnZhciBzZW5kUmVxdWVzdCA9IGZ1bmN0aW9uIHNlbmRSZXF1ZXN0KG9wdGlvbnMpIHsKICB2YXIgb3B0cyA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgZGVmYXVsdE9wdGlvbnMpLCBvcHRpb25zKTsKCiAgdmFyIHJlcSA9IHJlcXVlc3Rbb3B0cy5tZXRob2RdKG9wdHMuZW5kcG9pbnQpOyAvLyByZXEuc2V0KHsKICAvLyAgICdDb250ZW50LVR5cGUnOiBvcHRzLmZvcm1EYXRhID8gJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCcgOiAnYXBwbGljYXRpb24vanNvbicsCiAgLy8gICAuLi4ob3B0cy5oZWFkZXJzIHx8IHt9KSwKICAvLyB9KQoKICBpZiAob3B0cy50aW1lb3V0KSB7CiAgICByZXEudGltZW91dChfb2JqZWN0U3ByZWFkKHsKICAgICAgcmVzcG9uc2U6IDUwMDAsCiAgICAgIC8vIFdhaXQgNSBzZWNvbmRzIGZvciB0aGUgc2VydmVyIHRvIHN0YXJ0IHNlbmRpbmcsCiAgICAgIGRlYWRsaW5lOiA2MDAwMAogICAgfSwgb3B0cy50aW1lb3V0KSk7CiAgfQoKICBpZiAob3B0cy5xdWVyeSkgewogICAgcmVxLnF1ZXJ5KG9wdHMucXVlcnkpOwogIH0KCiAgaWYgKG9wdHMuYm9keSkgewogICAgcmVxLnNlbmQob3B0cy5ib2R5KTsKICB9CgogIGlmIChvcHRzLnNhbWVPcmlnaW4pIHsKICAgIHJlcS53aXRoQ3JlZGVudGlhbHMoKTsKICB9CgogIHZhciByZXNwb25zZUhhbmRsZXIgPSBjcmVhdGVSZXNwb25zZUhhbmRsZXIocmVxLCBvcHRzKTsgLy9ACgogIHJlc3BvbnNlSGFuZGxlci5hYm9ydCA9IHJlcS5hYm9ydC5iaW5kKHJlcSk7CiAgcmV0dXJuIHJlc3BvbnNlSGFuZGxlcjsKfTsKCnZhciByZXF1ZXN0QnlNZXRob2QgPSBmdW5jdGlvbiByZXF1ZXN0QnlNZXRob2QobWV0aG9kKSB7CiAgcmV0dXJuIGZ1bmN0aW9uIChlbmRwb2ludCkgewogICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9OwogICAgcmV0dXJuIHNlbmRSZXF1ZXN0KF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgb3B0cyksIHt9LCB7CiAgICAgIGVuZHBvaW50OiBlbmRwb2ludCwKICAgICAgbWV0aG9kOiBtZXRob2QKICAgIH0pKTsKICB9Owp9OwoKZXhwb3J0IGRlZmF1bHQgewogIGdldDogcmVxdWVzdEJ5TWV0aG9kKCdnZXQnKSwKICBwb3N0OiByZXF1ZXN0QnlNZXRob2QoJ3Bvc3QnKSwKICBwYXRjaDogcmVxdWVzdEJ5TWV0aG9kKCdwYXRjaCcpLAogIHB1dDogcmVxdWVzdEJ5TWV0aG9kKCdwdXQnKSwKICAiZGVsZXRlIjogcmVxdWVzdEJ5TWV0aG9kKCdkZWxldGUnKQp9Ow=="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/common/utils/request.ts"],"names":["request","responseCacheStorage","responseCacheGetKey","req","opts","method","endpoint","responseCacheGet","cacheKey","cacheResponse","cacheResponseCreateTime","Date","getTime","responseCacheAdd","resData","res","createResponseHandler","debug","toUpperCase","cachedAnswer","Promise","fulfill","reject","onComplete","end","err","serverError","statusCode","Error","body","JSON","parse","text","modifyResult","defaultOptions","sameOrigin","sendRequest","options","timeout","response","deadline","query","send","withCredentials","responseHandler","abort","bind","requestByMethod","get","post","patch","put"],"mappings":"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","sourcesContent":["// @ts-nocheck\r\nimport request from 'superagent'\r\n\r\n\r\nconst responseCacheStorage = {}\r\n\r\nconst responseCacheGetKey = (req, opts) => `${opts.method}-${opts.endpoint}`\r\n\r\nconst responseCacheGet = (req, opts) => {\r\n  const cacheKey =  responseCacheGetKey(req, opts)\r\n\r\n  if (opts\r\n    && opts.cacheResponse\r\n    && responseCacheStorage[cacheKey]\r\n    && ((responseCacheStorage[cacheKey].cacheResponseCreateTime + responseCacheStorage[cacheKey].cacheResponse) >= new Date().getTime())\r\n  ) {\r\n    return responseCacheStorage[cacheKey]\r\n  } return false\r\n}\r\n\r\nconst responseCacheAdd = (req, opts, resData, res) => {\r\n  const cacheKey = responseCacheGetKey(req, opts)\r\n  const { cacheResponse } = opts\r\n  const cacheResponseCreateTime = new Date().getTime()\r\n\r\n  responseCacheStorage[cacheKey] = {\r\n    cacheResponse,\r\n    cacheResponseCreateTime,\r\n    resData,\r\n    res,\r\n  }\r\n}\r\n\r\nconst createResponseHandler = (req, opts) => {\r\n  const debug = `${opts.method.toUpperCase()} ${opts.endpoint}`\r\n\r\n  // cached answer\r\n  const cachedAnswer = responseCacheGet(req, opts)\r\n\r\n  if (cachedAnswer) {\r\n    return new Promise((fulfill, reject) => {\r\n      //@\r\n      fulfill(cachedAnswer.resData, cachedAnswer.res)\r\n      opts.onComplete()\r\n    })\r\n  }\r\n\r\n  // no cache - do request\r\n  return new Promise((fulfill, reject) => req.end((err, res) => {\r\n    let serverError\r\n\r\n    // Errors\r\n\r\n    if (!res && !err) {\r\n      serverError = `Connection failed: ${debug}`\r\n    }\r\n    else if (!res || res.statusCode >= 500) {\r\n      serverError = 'We`re having technical issues at that moment. Please try again later'\r\n    }\r\n\r\n    if (serverError) {\r\n      return reject(new Error(`Connection failed: ${debug}, server error:${serverError}`))\r\n    }\r\n\r\n    if (err) {\r\n      // TODO write Error notifier\r\n      opts.onComplete()\r\n      return reject({ resData: err, res })\r\n    }\r\n\r\n    let { body } = res\r\n\r\n\r\n    if (!body) {\r\n      try {\r\n        body = JSON.parse(res.text)\r\n      }\r\n      catch (err) {\r\n        return reject(err)\r\n      }\r\n    }\r\n\r\n    const resData = opts.modifyResult(body)\r\n\r\n    // Cache result if needs\r\n    if (opts.cacheResponse) {\r\n      responseCacheAdd(req, opts, resData, res)\r\n    }\r\n\r\n    // Resolve\r\n    //@\r\n    fulfill(resData, res)\r\n    opts.onComplete()\r\n  }))\r\n}\r\n\r\n\r\nconst defaultOptions = {\r\n  sameOrigin: false,\r\n  modifyResult: (resData) => resData,\r\n  onComplete: () => {},\r\n}\r\n\r\n/**\r\n *\r\n * @param {Object} options\r\n * @param {String} options.endpoint\r\n * @param {String} options.method\r\n * @param {Object} options.headers\r\n * @param {Object} options.query\r\n * @param {Object} options.body\r\n * @param {number} options.delay\r\n */\r\nconst sendRequest = (options) => {\r\n  const opts = { ...defaultOptions, ...options }\r\n  const req = request[opts.method](opts.endpoint)\r\n\r\n  // req.set({\r\n  //   'Content-Type': opts.formData ? 'application/x-www-form-urlencoded; charset=UTF-8' : 'application/json',\r\n  //   ...(opts.headers || {}),\r\n  // })\r\n\r\n  if (opts.timeout) {\r\n    req.timeout({\r\n      response: 5000,  // Wait 5 seconds for the server to start sending,\r\n      deadline: 60000, // but allow 1 minute for the file to finish loading.\r\n      ...opts.timeout,\r\n    })\r\n  }\r\n\r\n  if (opts.query) {\r\n    req.query(opts.query)\r\n  }\r\n\r\n  if (opts.body) {\r\n    req.send(opts.body)\r\n  }\r\n\r\n  if (opts.sameOrigin) {\r\n    req.withCredentials()\r\n  }\r\n\r\n  const responseHandler = createResponseHandler(req, opts)\r\n  //@\r\n  responseHandler.abort = req.abort.bind(req)\r\n\r\n  return responseHandler\r\n}\r\n\r\nconst requestByMethod = (method) => (endpoint, opts = {}) => sendRequest({ ...opts, endpoint, method })\r\n\r\n\r\nexport default {\r\n  get: requestByMethod('get'),\r\n  post: requestByMethod('post'),\r\n  patch: requestByMethod('patch'),\r\n  put: requestByMethod('put'),\r\n  delete: requestByMethod('delete'),\r\n}\r\n"]}]}