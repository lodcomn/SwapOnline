{"remainingRequest":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js??ref--9-1!C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\plugins\\saveUserData.ts","dependencies":[{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\src\\front\\shared\\plugins\\saveUserData.ts","mtime":1614842914282},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Alexei\\MultiCurrencyWallet\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2RlZmluZVByb3BlcnR5IjsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCB7IGNvbnN0YW50cywgbG9jYWxTdG9yYWdlIH0gZnJvbSAnaGVscGVycyc7CmltcG9ydCBjb25maWcgZnJvbSAnaGVscGVycy9leHRlcm5hbENvbmZpZyc7Cgp2YXIgc2F2ZVVzZXJEYXRhID0gZnVuY3Rpb24gc2F2ZVVzZXJEYXRhKGRhdGEpIHsKICB2YXIga2V5ID0gZGF0YS5rZXksCiAgICAgIHZhbHVlID0gZGF0YS52YWx1ZTsKICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpOwogIHZhciBpbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICB2YXIgaXNXYWxsZXRDcmVhdGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShjb25zdGFudHMubG9jYWxTdG9yYWdlLmlzV2FsbGV0Q3JlYXRlKTsKCiAgICBpZiAoaXNXYWxsZXRDcmVhdGUgJiYgY29uZmlnICYmIGNvbmZpZy5vcHRzICYmIGNvbmZpZy5vcHRzLnBsdWdpbnMgJiYgY29uZmlnLm9wdHMucGx1Z2lucy51c2VyRGF0YVBsdWdpbkFwaSAmJiB3aW5kb3cuV1B1c2VyVWlkICYmIGNvbmZpZy5vcHRzLldQdXNlckhhc2gpIHsKICAgICAgdmFyIF9sb2NhbFN0b3JhZ2UkZ2V0SXRlbSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyZWR1eC1zdG9yZScpLAogICAgICAgICAgdXNlciA9IF9sb2NhbFN0b3JhZ2UkZ2V0SXRlbS51c2VyOwoKICAgICAgdmFyIGN1cktleXMgPSBPYmplY3Qua2V5cyh1c2VyKS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgaWYgKGVsICE9PSAndG9rZW5zRGF0YScpIHsKICAgICAgICAgIHJldHVybiBlbC5pbmNsdWRlcygnRGF0YScpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9KTsKICAgICAgdmFyIF9kYXRhID0ge307CiAgICAgIGN1cktleXMuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsKICAgICAgICB2YXIgX3VzZXIkZWwgPSB1c2VyW2VsXSwKICAgICAgICAgICAgYWRkcmVzcyA9IF91c2VyJGVsLmFkZHJlc3MsCiAgICAgICAgICAgIGJhbGFuY2UgPSBfdXNlciRlbC5iYWxhbmNlOwoKICAgICAgICBpZiAoYWRkcmVzcykgewogICAgICAgICAgX2RhdGFbZWxdID0gewogICAgICAgICAgICBhZGRyZXNzOiBhZGRyZXNzLAogICAgICAgICAgICBiYWxhbmNlOiBiYWxhbmNlCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIE9iamVjdC5rZXlzKHVzZXIudG9rZW5zRGF0YSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdmFyIF91c2VyJHRva2Vuc0RhdGEka2V5ID0gdXNlci50b2tlbnNEYXRhW2tleV0sCiAgICAgICAgICAgIGJhbGFuY2UgPSBfdXNlciR0b2tlbnNEYXRhJGtleS5iYWxhbmNlLAogICAgICAgICAgICBhZGRyZXNzID0gX3VzZXIkdG9rZW5zRGF0YSRrZXkuYWRkcmVzczsKCiAgICAgICAgaWYgKGFkZHJlc3MpIHsKICAgICAgICAgIF9kYXRhW2tleV0gPSB7CiAgICAgICAgICAgIGJhbGFuY2U6IGJhbGFuY2UsCiAgICAgICAgICAgIGFkZHJlc3M6IGFkZHJlc3MKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmIChfZGF0YSAmJiBPYmplY3QudmFsdWVzKF9kYXRhKS5sZW5ndGgpIHsKICAgICAgICBheGlvcy5wb3N0KGNvbmZpZy5vcHRzLnBsdWdpbnMudXNlckRhdGFQbHVnaW5BcGksIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgX2RhdGEpLCB7fSwgewogICAgICAgICAgV1B1c2VyVWlkOiB3aW5kb3cuV1B1c2VyVWlkLAogICAgICAgICAgV1B1c2VySGFzaDogY29uZmlnLm9wdHMuV1B1c2VySGFzaAogICAgICAgIH0pKTsKICAgICAgfQoKICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpOwogICAgfQogIH0sIDEwMDAwKTsKfTsKCmV4cG9ydCBkZWZhdWx0IHNhdmVVc2VyRGF0YTs="},{"version":3,"sources":["C:/Users/Alexei/MultiCurrencyWallet/src/front/shared/plugins/saveUserData.ts"],"names":["axios","constants","localStorage","config","saveUserData","data","key","value","window","setItem","JSON","stringify","interval","setInterval","isWalletCreate","getItem","opts","plugins","userDataPluginApi","WPuserUid","WPuserHash","user","curKeys","Object","keys","filter","el","includes","forEach","address","balance","tokensData","values","length","post","clearInterval"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,SAAT,EAAoBC,YAApB,QAAwC,SAAxC;AACA,OAAOC,MAAP,MAAmB,wBAAnB;;AAGA,IAAMC,YAAY,GAAG,SAASA,YAAT,CAAsBC,IAAtB,EAA4B;AAAA,MACvCC,GADuC,GACxBD,IADwB,CACvCC,GADuC;AAAA,MAClCC,KADkC,GACxBF,IADwB,CAClCE,KADkC;AAE/CC,EAAAA,MAAM,CAACN,YAAP,CAAoBO,OAApB,CAA4BH,GAA5B,EAAiCI,IAAI,CAACC,SAAL,CAAeJ,KAAf,CAAjC;AAEA,MAAMK,QAAQ,GAAGJ,MAAM,CAACK,WAAP,CAAmB,YAAM;AACxC,QAAMC,cAAc,GAAGZ,YAAY,CAACa,OAAb,CAAqBd,SAAS,CAACC,YAAV,CAAuBY,cAA5C,CAAvB;;AAEA,QAAIA,cAAc,IACbX,MADD,IAECA,MAAM,CAACa,IAFR,IAGCb,MAAM,CAACa,IAAP,CAAYC,OAHb,IAICd,MAAM,CAACa,IAAP,CAAYC,OAAZ,CAAoBC,iBAJrB,IAKCV,MAAM,CAACW,SALR,IAMChB,MAAM,CAACa,IAAP,CAAYI,UANjB,EAOE;AAAA,kCACiBlB,YAAY,CAACa,OAAb,CAAqB,aAArB,CADjB;AAAA,UACQM,IADR,yBACQA,IADR;;AAGA,UAAMC,OAAO,GAAGC,MAAM,CAACC,IAAP,CAAYH,IAAZ,EAAkBI,MAAlB,CAAyB,UAAAC,EAAE,EAAI;AAC7C,YAAIA,EAAE,KAAK,YAAX,EAAyB;AACvB,iBAAOA,EAAE,CAACC,QAAH,CAAY,MAAZ,CAAP;AACD;;AACD,eAAO,KAAP;AACD,OALe,CAAhB;AAOA,UAAMtB,KAAI,GAAG,EAAb;AACAiB,MAAAA,OAAO,CAACM,OAAR,CAAgB,UAAAF,EAAE,EAAI;AAAA,uBACSL,IAAI,CAACK,EAAD,CADb;AAAA,YACZG,OADY,YACZA,OADY;AAAA,YACHC,OADG,YACHA,OADG;;AAGpB,YAAID,OAAJ,EAAa;AACXxB,UAAAA,KAAI,CAACqB,EAAD,CAAJ,GAAW;AACTG,YAAAA,OAAO,EAAPA,OADS;AAETC,YAAAA,OAAO,EAAPA;AAFS,WAAX;AAID;AAEF,OAVD;AAYAP,MAAAA,MAAM,CAACC,IAAP,CAAYH,IAAI,CAACU,UAAjB,EAA6BH,OAA7B,CAAqC,UAACtB,GAAD,EAAS;AAAA,mCACfe,IAAI,CAACU,UAAL,CAAgBzB,GAAhB,CADe;AAAA,YACpCwB,OADoC,wBACpCA,OADoC;AAAA,YAC3BD,OAD2B,wBAC3BA,OAD2B;;AAE5C,YAAIA,OAAJ,EAAa;AACXxB,UAAAA,KAAI,CAACC,GAAD,CAAJ,GAAY;AACVwB,YAAAA,OAAO,EAAPA,OADU;AAEVD,YAAAA,OAAO,EAAPA;AAFU,WAAZ;AAID;AACF,OARD;;AAUA,UAAIxB,KAAI,IAAIkB,MAAM,CAACS,MAAP,CAAc3B,KAAd,EAAoB4B,MAAhC,EAAwC;AACtCjC,QAAAA,KAAK,CAACkC,IAAN,CAAW/B,MAAM,CAACa,IAAP,CAAYC,OAAZ,CAAoBC,iBAA/B,kCACKb,KADL;AAEEc,UAAAA,SAAS,EAAEX,MAAM,CAACW,SAFpB;AAGEC,UAAAA,UAAU,EAAEjB,MAAM,CAACa,IAAP,CAAYI;AAH1B;AAKD;;AACDZ,MAAAA,MAAM,CAAC2B,aAAP,CAAqBvB,QAArB;AACD;AACF,GApDgB,EAoDd,KApDc,CAAjB;AAqDD,CAzDD;;AA2DA,eAAeR,YAAf","sourcesContent":["import axios from 'axios'\r\nimport { constants, localStorage } from 'helpers'\r\nimport config from 'helpers/externalConfig'\r\n\r\n\r\nconst saveUserData = function saveUserData(data) {\r\n  const { key, value } = data\r\n  window.localStorage.setItem(key, JSON.stringify(value))\r\n\r\n  const interval = window.setInterval(() => {\r\n    const isWalletCreate = localStorage.getItem(constants.localStorage.isWalletCreate)\r\n\r\n    if (isWalletCreate\r\n      && config\r\n      && config.opts\r\n      && config.opts.plugins\r\n      && config.opts.plugins.userDataPluginApi\r\n      && window.WPuserUid\r\n      && config.opts.WPuserHash\r\n    ) {\r\n      const { user } = localStorage.getItem('redux-store')\r\n\r\n      const curKeys = Object.keys(user).filter(el => {\r\n        if (el !== 'tokensData') {\r\n          return el.includes('Data')\r\n        }\r\n        return false\r\n      })\r\n\r\n      const data = {}\r\n      curKeys.forEach(el => {\r\n        const { address, balance } = user[el]\r\n\r\n        if (address) {\r\n          data[el] = {\r\n            address,\r\n            balance,\r\n          }\r\n        }\r\n\r\n      })\r\n\r\n      Object.keys(user.tokensData).forEach((key) => {\r\n        const { balance, address } = user.tokensData[key]\r\n        if (address) {\r\n          data[key] = {\r\n            balance,\r\n            address,\r\n          }\r\n        }\r\n      })\r\n\r\n      if (data && Object.values(data).length) {\r\n        axios.post(config.opts.plugins.userDataPluginApi, {\r\n          ...data,\r\n          WPuserUid: window.WPuserUid,\r\n          WPuserHash: config.opts.WPuserHash,\r\n        })\r\n      }\r\n      window.clearInterval(interval)\r\n    }\r\n  }, 10000)\r\n}\r\n\r\nexport default saveUserData\r\n"]}]}